(window["webpackJsonppiu-spy-web-2"]=window["webpackJsonppiu-spy-web-2"]||[]).push([[0],{218:function(e,t,a){e.exports=a(439)},223:function(e,t){Number.isNaN=Number.isNaN||function(e){return e!==e},"undefined"===typeof Math.sign&&(Math.sign=function(e){return e>0?1:e<0?-1:e}),Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),a=t.length>>>0;if("function"!==typeof e)throw new TypeError("predicate must be a function");for(var r=arguments[1],n=0;n<a;){var c=t[n];if(e.call(r,c,n,t))return n;n++}return-1},configurable:!0,writable:!0})},236:function(e,t,a){},237:function(e,t,a){},238:function(e,t,a){},240:function(e,t,a){},241:function(e,t,a){},242:function(e,t,a){},243:function(e,t,a){},244:function(e,t,a){},260:function(e,t,a){},437:function(e,t,a){},438:function(e,t,a){},439:function(e,t,a){"use strict";a.r(t);var r=a(5),n=(a(219),a(222),a(223),a(2)),c=a.n(n),l=a(24),s=a.n(l),i=a(26),o=a(38),u=a(21),m=a.n(u),d=a(3),p=a.n(d),f=(a(236),a(12)),g=a(13),h=a(14),b=a(15),v=a(16),E=a(50),y=(a(237),{leaderboard:{path:"/leaderboard"},ranking:{path:"/ranking",faq:{path:"/ranking/faq"}},profile:{path:"/profiles/:id",getPath:function(e){return"/profiles/".concat(e.id)}}}),O=a(22),N=a(45),k=a(8),S=a.n(k),j=a(53),w=a.n(j),P=a(122),x=a.n(P),D=a(18),C=(a(90),a(238),a(4)),R=a(195),A=a(181),I=(a(240),{preventOverflow:{enabled:!0,padding:10,boundariesElement:"viewport"}}),L={right:"left",left:"right",top:"bottom",bottom:"top"},M=function(e){return e&&L[e.split("-")[0]]},F=function(e){function t(){var e;return Object(f.a)(this,t),(e=Object(h.a)(this,Object(b.a)(t).call(this))).state={isVisible:!1},e.containerItemRef=c.a.createRef(),e.renderPopper=e.renderPopper.bind(Object(C.a)(e)),e.toggleOverlayVisibility=e.toggleOverlayVisibility.bind(Object(C.a)(e)),e}return Object(v.a)(t,e),Object(g.a)(t,[{key:"hideOverlay",value:function(){this.setState({isVisible:!1})}},{key:"toggleOverlayVisibility",value:function(){this.setState({isVisible:!this.state.isVisible})}},{key:"handleClickOutside",value:function(e){e&&e.target.closest(".inner-popper-overlay")||this.hideOverlay()}},{key:"renderPopper",value:function(e){var t=e.ref,a=e.style,r=e.placement,n=e.arrowProps,l=(e.scheduleUpdate,e.outOfBoundaries),s=this.props,i=s.children,o=s.hideWhenOutOfBounds;return c.a.createElement("div",{ref:t,style:a,"data-placement":r,className:S()("inner-popper-overlay","arrow-".concat(M(r)),this.props.overlayClassName,{"out-of-bounds":l&&o})},c.a.createElement("div",{className:"arrow-hider"},c.a.createElement("div",{className:"arrow",ref:n.ref,style:n.style})),c.a.createElement("div",{className:"inner-popper-content"},i))}},{key:"render",value:function(){var e=this.props,t=e.placement,a=e.overlayItem,r=this.state.isVisible;return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"overlay-item",ref:this.containerItemRef,onClick:this.toggleOverlayVisibility},a),r&&s.a.createPortal(c.a.createElement(R.a,{container:document.body,modifiers:I,placement:t,referenceElement:this.containerItemRef.current},this.renderPopper),document.body))}}]),t}(c.a.PureComponent);F.defaultTypes={placement:"bottom"};var _=Object(A.a)(F),T=(a(241),function(e){function t(){return Object(f.a)(this,t),Object(h.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){var e=this.props,t=e.active,a=e.onToggle,r=e.text;return c.a.createElement("div",{className:S()("toggle-button",{active:t}),onClick:function(){return a(!t)}},r)}}]),t}(c.a.PureComponent));a(242);function B(){return c.a.createElement("div",{className:"loader"},c.a.createElement("svg",{width:"40",height:"12",viewBox:"0 0 120 30",xmlns:"http://www.w3.org/2000/svg",fill:"#eee"},c.a.createElement("circle",{cx:"15",cy:"15",r:"15"},c.a.createElement("animate",{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}),c.a.createElement("animate",{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"})),c.a.createElement("circle",{cx:"60",cy:"15",r:"9",fillOpacity:"0.3"},c.a.createElement("animate",{attributeName:"r",from:"9",to:"9",begin:"0s",dur:"0.8s",values:"9;15;9",calcMode:"linear",repeatCount:"indefinite"}),c.a.createElement("animate",{attributeName:"fill-opacity",from:"0.5",to:"0.5",begin:"0s",dur:"0.8s",values:".5;1;.5",calcMode:"linear",repeatCount:"indefinite"})),c.a.createElement("circle",{cx:"105",cy:"15",r:"15"},c.a.createElement("animate",{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}),c.a.createElement("animate",{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"}))))}var K=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(h.a)(this,Object(b.a)(t).call(this,e))).state={value:(p.a.isNil(e.value)?e.defaultValue:e.value)||""},p.a.bindAll(["handleChange","handleBlur"],Object(C.a)(a)),a}return Object(v.a)(t,e),Object(g.a)(t,[{key:"componentDidUpdate",value:function(e){e.value!==this.props.value&&this.setState({value:this.props.value})}},{key:"handleChange",value:function(e){var t=this,a=e.target.value;this.setState({value:a},function(){return t.props.onChange(a)})}},{key:"handleBlur",value:function(e){var t=this.props.type,a=this.state.value;if("number"===t){var r=Number(a);r>=Number(e.target.min)&&r<=Number(e.target.max)?this.props.onBlur(r,e):(this.setState({value:this.props.value}),this.props.onBlur(this.props.value,e))}}},{key:"render",value:function(){var e=this.props.className;return c.a.createElement("input",Object.assign({},p.a.omit(["defaultValue","onChange"],this.props),{className:S()(e,"text-input"),value:this.state.value,onBlur:this.handleBlur,onInput:this.handleChange}))}}]),t}(c.a.Component);K.defaultProps={value:null,type:"text",onChange:p.a.noop,onBlur:p.a.noop};a(243);var G=function(e){function t(){var e;return Object(f.a)(this,t),(e=Object(h.a)(this,Object(b.a)(t).call(this))).onChange=function(t){e.props.onChange(t.target.checked)},e.id=p.a.uniqueId(),e}return Object(v.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){return c.a.createElement("div",{className:"toggle-checkbox"},c.a.createElement("input",{type:"checkbox",className:"toggle-checkbox-cb",id:this.id,onChange:this.onChange,checked:this.props.checked}),c.a.createElement("label",{htmlFor:this.id,className:"toggle"},c.a.createElement("span",null)),c.a.createElement("label",{htmlFor:this.id,className:"text-label"},this.props.children))}}]),t}(c.a.Component),q=(a(244),function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(h.a)(this,Object(b.a)(t).call(this))).state={open:e.defaultOpen||!1},a}return Object(v.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.children,r=t.title,n=t.className,l=this.state.open;return c.a.createElement("div",{className:S()("collapsible-bar",n,{open:l})},c.a.createElement("div",{className:"header",onClick:function(){return e.setState(function(e){return{open:!e.open}})}},c.a.createElement("div",{className:"collapse-button"},c.a.createElement(D.e,null)),c.a.createElement("div",{className:"title"},r)),a&&c.a.createElement("div",{className:"collapsible-children"},a))}}]),t}(n.PureComponent)),H=a(120);function V(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}function W(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?V(a,!0).forEach(function(t){Object(r.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):V(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function U(e){var t=e.range,a=e.min,r=e.max,n=e.onChange;return c.a.createElement(H.Range,{values:t,step:1,min:a,max:r,onChange:n,renderTrack:function(e){var n=e.props,l=e.children;return c.a.createElement("div",{onMouseDown:n.onMouseDown,onTouchStart:n.onTouchStart,style:W({},n.style,{position:"relative",height:"10px",display:"flex",width:"100%"})},c.a.createElement("div",{ref:n.ref,style:{height:"6px",width:"100%",borderRadius:"3px",background:Object(H.getTrackBackground)({values:t,colors:["#ccc","#337ab7","#ccc"],min:a,max:r}),alignSelf:"center"}},l))},renderThumb:function(e){var t=e.props,a=e.isDragged;return c.a.createElement("div",Object.assign({},t,{style:W({},t.style,{height:"12px",width:"12px",borderRadius:"6px",backgroundColor:"#FFF",display:"flex",justifyContent:"center",alignItems:"center",boxShadow:"0px 2px 3px #AAA"})}),c.a.createElement("div",{style:{height:"6px",width:"6px",borderRadius:"3px",backgroundColor:a?"#337ab7":"#CCC"}}))}})}var J={DEFAULT:"default",PROTAGONIST:"protagonist",RANK_ASC:"rankAsc",RANK_DESC:"rankDesc",NEW_SCORES_PLAYER:"newScoresPlayer"},Q=[1,28];function z(e){var t=e.filterValue,a=e.onChange,r=p.a.getOr(Q,"range",t),n=p.a.getOr(null,"type",t),l="\u0444\u0438\u043b\u044c\u0442\u0440 \u0447\u0430\u0440\u0442\u043e\u0432";if(t){var s=n||"";l="\u0447\u0430\u0440\u0442\u044b: "+(l=r[0]===r[1]?"".concat(s).concat(r[0]):"".concat(s).concat(r[0]," - ").concat(s).concat(r[1]))}return c.a.createElement("div",null,c.a.createElement(_,{overlayClassName:"chart-range-overlay-outer",overlayItem:c.a.createElement("button",{className:"filter-charts-button btn btn-sm btn-dark"},l)},c.a.createElement("div",{className:"chart-range-overlay"},c.a.createElement("div",{className:"buttons"},c.a.createElement(T,{text:"S",active:!n||"S"===n,onToggle:function(e){a({range:r,type:e?null:"D"})}}),c.a.createElement(T,{text:"D",active:!n||"D"===n,onToggle:function(e){a({range:r,type:e?null:"S"})}})),c.a.createElement(U,{range:r,min:Q[0],max:Q[1],onChange:function(e){return a({type:n,range:e})}}),c.a.createElement("div",{className:"inputs"},c.a.createElement("button",{className:"btn btn-sm btn-dark",onClick:function(){return a({type:n,range:[Math.max(r[0]-1,Q[0]),r[1]]})}},c.a.createElement(D.c,null)),c.a.createElement(K,{type:"number",className:"form-control",min:Q[0],max:Math.min(Q[1],r[1]),value:r[0],onBlur:function(e){a({type:n,range:[e,r[1]]})}}),c.a.createElement("button",{className:"btn btn-sm btn-dark",onClick:function(){var e=Math.min(r[0]+1,Q[1]);a({type:n,range:[e,r[1]<e?e:r[1]]})}},c.a.createElement(D.d,null)),c.a.createElement("div",{className:"_flex-fill"}),c.a.createElement("button",{className:"btn btn-sm btn-dark",onClick:function(){var e=Math.max(r[1]-1,Q[0]);a({type:n,range:[r[0]>e?e:r[0],e]})}},c.a.createElement(D.c,null)),c.a.createElement(K,{type:"number",className:"form-control",min:Math.max(Q[0],r[0]),max:Q[1],value:r[1],onBlur:function(e){return a({type:n,range:[r[0],e]})}}),c.a.createElement("button",{className:"btn btn-sm btn-dark",onClick:function(){return a({type:n,range:[r[0],Math.min(r[1]+1,Q[1])]})}},c.a.createElement(D.d,null))))))}var Y=a(31),X=a.n(Y),Z=a(28),$=a(49),ee=function(){var e=Object($.a)(X.a.mark(function e(t){var a,r,n;return X.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.url,e.prev=1,e.next=4,fetch(a);case 4:if(!((r=e.sent).status>=200&&r.status<300)){e.next=12;break}return e.next=8,r.json();case 8:return n=e.sent,e.abrupt("return",n);case 12:throw Error("HTTP Status "+r.status);case 13:e.next=19;break;case 15:return e.prev=15,e.t0=e.catch(1),console.error(e.t0),e.abrupt("return",Promise.reject(e.t0));case 19:case"end":return e.stop()}},e,null,[[1,15]])}));return function(t){return e.apply(this,arguments)}}();localStorage&&(window.debugOn=function(){localStorage.setItem("debug",1)},window.debugOff=function(){localStorage.removeItem("debug")});var te=localStorage&&localStorage.getItem("debug");function ae(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}function re(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ae(a,!0).forEach(function(t){Object(r.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ae(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var ne="RANKINGS/SET_RANKINGS",ce="RANKINGS/RANKING_CHANGE_SET";var le=function(e,t,a){var r=t.players,n={count:0,battleCount:0,countAcc:0,grades:{F:0,D:0,C:0,B:0,A:0,S:0,SS:0,SSS:0},totalScore:{S:0,D:0,calories:0},sumAccuracy:0,history:[],ratingHistory:[],lastPlace:null,lastBattleDate:0},c=function(e){return re({},p.a.cloneDeep(n),{rating:850+a[e].progress.bonus})},l={},s=[];return e.forEach(function(e){var t=[];p.a.orderBy(["score"],["desc"],e.results).forEach(function(a){if(!a.nickname.includes("???")){t.push(a),l[a.playerId]||(l[a.playerId]=c(a.playerId));var r=l[a.playerId];r.count++,a.accuracy&&(r.countAcc++,r.sumAccuracy+=a.accuracy),r.totalScore[e.chartType]+=a.score,a.calories&&(r.totalScore.calories+=a.calories),r.grades[a.grade.replace("+","")]++}!e.maxScore&&function(e){return p.a.isInteger(e.perfect)&&p.a.isInteger(e.great)&&p.a.isInteger(e.good)&&p.a.isInteger(e.bad)&&p.a.isInteger(e.miss)&&p.a.isInteger(e.score)}(a)&&(e.maxScore=function(e){return e.score/e.accuracyRaw*100/(e.isRank?1.2:1)}(a))}),t.forEach(function(a,r){(t.length>1?t.slice(r+1):[]).forEach(function(t){a.isRank===t.isRank&&a.playerId!==t.playerId&&s.push([a,t,e])})})}),p.a.flow([p.a.sortBy(function(e){var t=Object(Z.a)(e,2),a=t[0],r=t[1];return Math.max(a.dateObject.getTime(),r.dateObject.getTime())}),p.a.forEach(function(e){var t=Object(Z.a)(e,3),a=t[0],r=t[1],n=t[2];l[r.playerId]||(l[r.playerId]=c(r.playerId));var s=l[a.playerId],i=l[r.playerId],o=a.isRank?1.2:1,u=null;n.maxScore&&(u=n.maxScore*o,Math.max(u,a.score,r.score)===u||a.isRank||a.isExactDate&&r.isExactDate||(u*=1.2),Math.max(u,a.score,r.score)!==u&&(u=Math.max.apply(Math,Object(O.a)(p.a.map("score",n.results))))),a.startingRating=s.rating,r.startingRating=i.rating,s.battleCount++,i.battleCount++;var m,d,f=s.rating,g=i.rating,h=Math.pow(10,f/400),b=Math.pow(10,g/400),v=h/(h+b),E=b/(h+b),y=a.score,N=r.score;y===N?m=d=.5:u&&0!==y&&0!==N?(m=5*((N=u/N-1)/((y=u/y-1)+N)-.5)+.5,d=5*(y/(y+N)-.5)+.5):d=1-(m=y>N?1:N<y?0:.5),m=Math.max(0,Math.min(1,m)),d=Math.max(0,Math.min(1,d));var k=Math.max(0,Math.min(1,(f-700)/800)),S=Math.max(0,Math.min(1,(g-700)/800)),j=30+20*k,w=30+20*S,P=Math.max(1,Math.min(j,Math.pow(n.chartLevel/25,5*(k-.5)+2.5)*j)),x=Math.max(1,Math.min(w,Math.pow(n.chartLevel/25,5*(S-.5)+2.5)*w)),D=Math.min(P,x),C=D,R=D,A=C*(m-v),I=R*(d-E);A=A<0&&"SSS"===a.grade?0:A,I=I<0&&"SSS"===r.grade?0:I,a.ratingDiff=(a.ratingDiff||0)+A,r.ratingDiff=(r.ratingDiff||0)+I,a.ratingDiffLast=A,r.ratingDiffLast=I,te&&(console.log("".concat(n.chartLabel," - ").concat(a.nickname," / ").concat(r.nickname," - ").concat(n.song)),console.log("- ".concat(a.score," / ").concat(r.score," (").concat(u,") - R ").concat(m.toFixed(2),"/").concat(d.toFixed(2)," E ").concat(v.toFixed(2)," / ").concat(E.toFixed(2))),console.log("- Rating ".concat(f.toFixed(2)," / ").concat(g.toFixed(2)," - ").concat(A.toFixed(2)," / ").concat(I.toFixed(2)," - K ").concat(C.toFixed(2)," ").concat(R.toFixed(2)))),s.rating=f+A,i.rating=g+I,s.rating=Math.max(100,s.rating),i.rating=Math.max(100,i.rating);var L=p.a.flow(p.a.keys,p.a.map(function(e){return{id:e,rating:l[e].rating}}),p.a.orderBy(["rating"],["desc"]))(l),M=a.dateObject>r.dateObject?a.dateObject:r.dateObject;L.forEach(function(e,t){l[e.id].lastPlace!==t+1&&(l[e.id].history.push({place:t+1,date:M.getTime()}),l[e.id].lastPlace=t+1)});var F=p.a.last(s.ratingHistory),_=p.a.last(i.ratingHistory);F!==s.rating&&s.ratingHistory.push({rating:s.rating,date:M.getTime()}),_!==i.rating&&i.ratingHistory.push({rating:i.rating,date:M.getTime()})})])(s),p.a.flow(p.a.keys,p.a.map(function(e){return re({},p.a.omit(["countAcc","sumAccuracy"],l[e]),{id:p.a.toInteger(e),name:r[e].nickname,nameArcade:r[e].arcade_name,accuracy:l[e].countAcc>0?Math.round(l[e].sumAccuracy/l[e].countAcc*100)/100:null,rating:Math.round(l[e].rating),ratingRaw:l[e].rating})}),p.a.remove(function(e){return e.battleCount<20}),p.a.orderBy(["ratingRaw"],["desc"]))(l)},se=function(e){return{type:ne,ranking:e}},ie=p.a.map("name"),oe=p.a.flow(p.a.map(function(e){return[e.name,e.rating]}),p.a.fromPairs),ue=function(e){return function(){var t=Object($.a)(X.a.mark(function t(a,r){var n,c,l,s,i,o,u,d,f,g,h,b,v;return X.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a(se(e)),t.prev=1,t.next=4,Promise.all([m.a.getItem("lastChangedRanking_v2"),m.a.getItem("lastChangedRankingPoints_v2"),m.a.getItem("lastFetchedRanking_v2")]);case 4:n=t.sent,c=Object(Z.a)(n,3),l=c[0],s=c[1],i=c[2],o=ie(e),u=ie(i),d=ie(l),f=oe(e),g=oe(i),h=oe(s),b=h,p.a.isEqual(f,g)||(m.a.setItem("lastChangedRankingPoints_v2",i),b=g),v=d,p.a.isEqual(o,u)||(m.a.setItem("lastChangedRanking_v2",i),v=u),a({type:ce,listNow:o,listPrev:v,rankingsPointsMap:b}),m.a.setItem("lastFetchedRanking_v2",e),t.next=26;break;case 23:t.prev=23,t.t0=t.catch(1),console.warn("Cannot get ranking from local storage",t.t0);case 26:case"end":return t.stop()}},t,null,[[1,23]])}));return function(e,a){return t.apply(this,arguments)}}()},me=["F","F+","D","D+","C","C+","B","B+","A","A+","S","SS","SSS"];function de(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}function pe(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?de(a,!0).forEach(function(t){Object(r.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):de(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var fe="PROFILES/SET_PROFILES",ge="PROFILES/SET_FILTER",he="PROFILES/RESET_FILTER",be={},ve={isLoading:!1,data:[],filter:be};var Ee=function(e,t,a){return p.a.mapValues(function(e){var t=p.a.values(e.resultsByGrade)[0][0].result.playerId;return e.ratingHistory=p.a.flow(p.a.find({id:t}),p.a.get("ratingHistory"))(a)||[],e.rankingHistory=p.a.flow(p.a.find({id:t}),p.a.get("history"),function(e){return e&&[].concat(Object(O.a)(e),[{place:p.a.get("place",p.a.last(e)),date:Date.now()}])})(a)||[],e},e)},ye=function(e,t){var a={},r=function(e,t){a[t.playerId]||function(e){var t=p.a.fromPairs(Array.from({length:28}).map(function(e,t){return[t+1,[]]}));a[e]={resultsByGrade:{},resultsByLevel:t,lastResultDate:null}}(t.playerId);var r=a[t.playerId];r.resultsByGrade[t.grade]=[].concat(Object(O.a)(r.resultsByGrade[t.grade]||[]),[{result:t,chart:e}]);var n=p.a.filter({playerId:t.playerId},e.results);if(n[0]===t){var c=t;n.length>1&&(c=n.sort(function(e,t){return me.indexOf(t.grade)-me.indexOf(e.grade)})[0]),r.resultsByLevel[e.chartLevel]=[].concat(Object(O.a)(r.resultsByLevel[e.chartLevel]||[]),[{result:c,chart:e}])}t.isExactDate&&r.lastResultDate<t.dateObject&&(r.lastResultDate=t.dateObject)};e.forEach(function(e){e.results.forEach(function(t){r(e,t)})});return a=p.a.mapValues(function(e){var a=["A","A+","S","SS","SSS"];e.progress={double:{SS:{},S:{},"A+":{},A:{}},single:{SS:{},S:{},"A+":{},A:{}}};var r={SSS:["SS","S","A+","A"],SS:["SS","S","A+","A"],S:["S","A+","A"],"A+":["A+","A"],A:["A"]};return p.a.keys(e.resultsByLevel).forEach(function(t){e.resultsByLevel[t].forEach(function(n){var c=n.result.grade,l=n.result.playerId,s=n.chart.results.filter(function(e){return e.playerId===l});if(s.length>1&&s.sort(function(e,t){return a.indexOf(t.grade)-a.indexOf(e.grade)})[0].grade!==c)return;var i=r[c];i&&i.forEach(function(a){!function(t,a,r){var n=r?e.progress.single:e.progress.double;n[a][t]=n[a][t]?n[a][t]+1:1}(t,a,"S"===n.chart.chartType)})})}),["single","double"].forEach(function(a){e.progress["".concat(a,"-bonus")]=0,p.a.keys(e.progress[a]).forEach(function(r){e.progress[a]["".concat(r,"-bonus")]=0,p.a.keys(e.progress[a][r]).forEach(function(n){var c=e.progress[a][r][n],l=function(e){return Math.round(Math.min(e,1+e/20+.7*Math.sqrt(Math.max(e-1,0))))}(t.data["".concat(a,"sLevels")][n]),s=Math.min(1,c/l),i=function(e){return 30*(1+Math.pow(2,e/4))/11}(n)*s;e.progress[a][r]["".concat(n,"-bonus")]=i,e.progress[a][r]["".concat(n,"-bonus-coef")]=s,e.progress[a][r]["".concat(n,"-min-number")]=l,e.progress[a][r]["".concat(n,"-achieved-number")]=c,i>=e.progress[a]["".concat(r,"-bonus")]&&(e.progress[a]["".concat(r,"-bonus")]=i,e.progress[a]["".concat(r,"-bonus-level")]=n,e.progress[a]["".concat(r,"-bonus-level-coef")]=s,e.progress[a]["".concat(r,"-bonus-level-min-number")]=l,e.progress[a]["".concat(r,"-bonus-level-achieved-number")]=c)}),e.progress["".concat(a,"-bonus")]+=e.progress[a]["".concat(r,"-bonus")]})}),e.progress.bonus=e.progress["double-bonus"]+e.progress["single-bonus"],e},a)},Oe=function(e){return{type:fe,data:e}},Ne="https://vps720616.ovh.net:5000";function ke(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}function Se(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ke(a,!0).forEach(function(t){Object(r.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ke(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var je="TOP/LOADING",we="TOP/SUCCESS",Pe="TOP/ERROR",xe="TOP/SET_FILTER",De="TOP/RESET_FILTER",Ce={showRank:!0,showRankAndNorank:!0},Re={isLoading:!1,data:[],filter:Ce},Ae=function(e){return p.a.flow(p.a.get("top"),p.a.values,p.a.map(function(t){var a=p.a.find(function(e){return p.a.every(p.a.isNumber,[e.perfects,e.greats,e.goods,e.bads,e.misses])},t.results),r=a&&[a.perfects,a.greats,a.goods,a.bads,a.misses].reduce(function(e,t){return e+t},0);return{song:t.track,chartLabel:t.chart_label,chartLevel:t.chart_label.slice(1),chartType:t.chart_label.slice(0,1),mix:t.mix,results:t.results.map(function(t,a){var n={};if(r){var c=[t.perfects,t.greats,t.goods,t.bads,t.misses],l=-1,s=0;1===c.filter(function(e,t){return p.a.isNumber(e)?(s+=e,!1):(l=t,!0)}).length&&(n[["perfect","great","good","bad","miss"][l]]=r-s)}return Se({playerId:t.player,nickname:e.players[t.player].nickname,nicknameArcade:e.players[t.player].arcade_name,originalChartMix:t.originalChartMix,originalChartLabel:t.originalChartLabel,originalScore:t.originalScore,date:t.gained,dateObject:new Date(t.gained),grade:t.grade,isExactDate:!!t.exact_gain_date,score:t.score,scoreIncrease:t.score_increase,calories:t.calories&&t.calories/1e3,perfect:t.perfects,great:t.greats,good:t.goods,bad:t.bads,miss:t.misses,combo:t.max_combo,mods:t.mods_list,isRank:!!t.rank_mode,isHJ:(t.mods_list||"").split(" ").includes("HJ")},n)})}}),p.a.map(function(e){return Se({},e,{latestScoreDate:e.results.reduce(function(e,t){return t.date>e?t.date:e},e.results[0].date),results:e.results.map(function(t){var a=Math.sqrt(t.perfect)*p.a.toInteger(e.chartLevel)/2,r=a?Math.floor((100*a+60*t.great+30*t.good+-20*t.miss)/(a+t.great+t.good+t.bad+t.miss)*100)/100:null,n=t.perfect?Math.floor((100*t.perfect+60*t.great+30*t.good+-20*t.miss)/(t.perfect+t.great+t.good+t.bad+t.miss)*100)/100:null;return Se({},t,{accuracy:r<0?0:100===r?r:r&&+r.toFixed(2),accuracyRaw:n,hasRankScore:p.a.some({playerId:t.playerId,isRank:!0},e.results)})})})}),p.a.orderBy(["latestScoreDate","song","chartLevel"],["desc","asc","desc"]))(e)};var Ie=function(){return function(){var e=Object($.a)(X.a.mark(function e(t,a){var r,n,c,l,s;return X.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:je}),e.prev=1,e.next=4,ee({url:"".concat(Ne,"/top/v2")});case 4:return r=e.sent,n=Ae(r),c=ye(n,a().tracklist),l=le(n,r,c),t({type:we,data:n,players:p.a.flow(p.a.toPairs,p.a.map(function(e){var t=Object(Z.a)(e,2),a=t[0];return Se({},t[1],{id:p.a.toInteger(a)})}))(r.players)}),t(ue(l)),s=Ee(c,0,l),t(Oe(s)),e.abrupt("return",n);case 15:e.prev=15,e.t0=e.catch(1),console.log(e.t0),t({type:Pe,error:e.t0});case 19:case"end":return e.stop()}},e,null,[[1,15]])}));return function(t,a){return e.apply(this,arguments)}}()},Le=function(e){return{type:xe,filter:e}};function Me(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}function Fe(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Me(a,!0).forEach(function(t){Object(r.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Me(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var _e="PRESETS/SELECT_PRESET",Te="PRESETS/LOAD_PRESETS",Be="PRESETS/LOADING_START",Ke="PRESETS/LOADING_END",Ge={presets:[],currentPreset:null,isLoading:!1},qe=function(e){return e&&Fe({},e,{label:e.name,value:e.name})};var He=function(e){return{type:Te,presets:e||[]}},Ve=function(){return{type:Be}},We=function(){return{type:Ke}},Ue=function(e){return{type:_e,currentPreset:e}},Je=function(){return function(e,t){e(Ve());var a=t().presets.currentPreset,r=p.a.get("name",a);return m.a.getItem("filterPresets").then(function(t){r&&p.a.find({name:r},t)?(e(Ue(a)),e(Le(a.filter))):e(He(t)),e(We())})}};function Qe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}var ze=c.a.createElement("button",{className:"btn btn-sm btn-dark btn-icon _margin-right"},c.a.createElement(D.h,null),"\u043f\u0440\u0435\u0441\u0435\u0442\u044b"),Ye=function(){return"\u043f\u0443\u0441\u0442\u043e"},Xe={loadPresets:function(){return function(e,t){return e(Ve()),m.a.getItem("filterPresets").then(function(t){e(He(t)),e(We())})}},savePreset:function(e){return function(t,a){return t(Ve()),m.a.getItem("filterPresets").then(function(r){var n=a().top.filter,c={name:e,filter:n};if(p.a.some({name:e},r)){if(window.confirm("Preset with this name already exists, replace it?")){var l=p.a.remove({name:e},r),s=[].concat(Object(O.a)(l),[c]);t(He(s)),m.a.setItem("filterPresets",s)}}else{var i=[].concat(Object(O.a)(r||[]),[c]);t(He(i)),t(Ue(c)),m.a.setItem("filterPresets",i)}t(We())})}},openPreset:Je,deletePreset:function(){return function(e,t){e(Ve());var a=p.a.get("name",t().presets.currentPreset);return m.a.getItem("filterPresets").then(function(t){if(p.a.find({name:a},t)&&window.confirm("Are you sure you want to delete selected preset?")){var r=p.a.remove({name:a},t);e(He(r)),m.a.setItem("filterPresets",r)}else e(He(t));e(We())})}},selectPreset:Ue},Ze=function(e){function t(){var e,a;Object(f.a)(this,t);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];return(a=Object(h.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(n)))).state={},a.onChangeSelection=function(e){a.props.selectPreset(e.name)},a.onRewritePreset=function(){var e=a.props.currentPreset;a.props.savePreset(e.name)},a.onSavePreset=function(){var e=a.state.name;a.props.savePreset(e),a.setState({isAddingNew:!1})},a}return Object(v.a)(t,e),Object(g.a)(t,[{key:"componentDidMount",value:function(){this.props.loadPresets()}},{key:"render",value:function(){var e=this,t=this.props,a=t.presets,r=t.currentPreset,n=t.isLoading,l=this.state,s=l.name,i=l.isAddingNew;return c.a.createElement("div",null,c.a.createElement(_,{overlayItem:ze},c.a.createElement("div",{className:"presets-control-overlay"},c.a.createElement(N.a,{className:"select _margin-bottom",classNamePrefix:"select",placeholder:"\u043f\u0440\u0435\u0441\u0435\u0442\u044b...",options:a,value:r,onChange:this.props.selectPreset,noOptionsMessage:Ye}),r&&c.a.createElement("div",{className:"buttons-presets _margin-bottom"},c.a.createElement("div",{className:"_flex-fill"}),c.a.createElement("button",{className:"btn btn-sm btn-dark btn-icon _margin-right",onClick:this.props.openPreset,disabled:n},c.a.createElement(D.g,null)," \u043e\u0442\u043a\u0440\u044b\u0442\u044c"),c.a.createElement("button",{className:"btn btn-sm btn-dark btn-icon _margin-right",onClick:this.onRewritePreset,disabled:n},c.a.createElement(D.l,null)," \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0438\u0441\u0430\u0442\u044c"),c.a.createElement("button",{className:"btn btn-sm btn-dark btn-icon",onClick:this.props.deletePreset,disabled:n},c.a.createElement(D.n,null)," \u0443\u0434\u0430\u043b\u0438\u0442\u044c")),!i&&c.a.createElement("div",{className:"buttons-presets _margin-bottom"},c.a.createElement("div",{className:"_flex-fill"}),c.a.createElement("button",{className:"btn btn-sm btn-dark btn-icon _margin-left _self-align-end",onClick:function(){return e.setState({isAddingNew:!0})},disabled:n},c.a.createElement(D.i,null)," \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c")),i&&c.a.createElement("div",{className:"adding-new _margin-bottom"},c.a.createElement(K,{value:s,placeholder:"\u0438\u043c\u044f \u043f\u0440\u0435\u0441\u0435\u0442\u0430...",className:"form-control",onChange:function(t){return e.setState({name:t})}}),c.a.createElement("button",{className:"btn btn-sm btn-dark btn-icon _margin-left",onClick:this.onSavePreset,disabled:!s||n},c.a.createElement(D.l,null)," \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),c.a.createElement("button",{className:"btn btn-sm btn-dark btn-icon _margin-left",onClick:function(){return e.setState({isAddingNew:!1})},disabled:n},"\u043e\u0442\u043c\u0435\u043d\u0430")))))}}]),t}(c.a.Component),$e=Object(o.b)(function(e){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Qe(a,!0).forEach(function(t){Object(r.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Qe(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},e.presets)},Xe)(Ze),et=a(445),tt=a(182),at=a.n(tt),rt=a(444),nt=a(121),ct=a.n(nt);et.a.addLocale(at.a);var lt=new et.a("ru-RU"),st={flavour:"long",gradation:rt.a,units:["day","week","month"]},it=function(e){return c.a.createElement("div",{style:{display:"flex",alignItems:"center",flexDirection:"column"}},c.a.createElement("div",null,"\u0442\u043e\u0447\u043d\u0430\u044f \u0434\u0430\u0442\u0430 \u0432\u0437\u044f\u0442\u0438\u044f \u043d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u0430"),c.a.createElement("div",null,"\u0441\u043a\u043e\u0440 \u0431\u044b\u043b \u0437\u0430\u043f\u0438\u0441\u0430\u043d \u0441 my best \u0438\u043b\u0438 machine best"),c.a.createElement("div",null,"\u0434\u0430\u0442\u0430 \u0437\u0430\u043f\u0438\u0441\u0438: ",e.toLocaleDateString()))},ot=function(e){var t=ct()().startOf("day").diff(ct()(e).startOf("day"),"days");return 0===t?"\u0441\u0435\u0433\u043e\u0434\u043d\u044f":1===t?"\u0432\u0447\u0435\u0440\u0430":lt.format(e,st)},ut=["#4DB3FF","#80B300","#FF6655","#FF99E6","#33FFCC","#e633c8","#dbe812","#FF1A66","#991AFF","#E6B333","#1AB399","#4D8066","#CC9999","#00E680","#809980","#E6FF80","#1AFF33","#999933","#E6331A","#CCCC00","#66E64D","#4D80CC","#9900B3","#4DB380","#FF4D4D"],mt=a(68),dt=a(183);function pt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}function ft(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?pt(a,!0).forEach(function(t){Object(r.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):pt(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var gt=Object(mt.a)(function(e){return e.top.players},p.a.flow(p.a.toPairs,p.a.map(function(e){var t=Object(Z.a)(e,2),a=(t[0],t[1]),r=a.nickname,n=a.arcade_name;return{label:"".concat(r," (").concat(n,")"),value:r}}),p.a.sortBy(function(e){return p.a.toLower(e.label)}))),ht=Object(mt.a)(function(e){return e.top.data},function(e){return e.top.filter},function(e,t){var a,n=p.a.map("value",t.players),c=p.a.map("value",t.playersOr),l=p.a.map("value",t.playersNot),s=p.a.get("value",t.sortingType),i=p.a.get("value",t.protagonist),o=p.a.map("value",t.excludeAntagonists),u=[p.a.orderBy(["latestScoreDate"],["desc"])],m=i?[p.a.orderBy([function(e){return p.a.max(p.a.map(function(e){return e.nickname===i?e.dateObject.getTime():0},e.results))}],["desc"])]:u,d=[p.a.filter(function(e){return p.a.map("nickname",e.results).includes(i)}),p.a.map(function(e){var t=p.a.findIndex({nickname:i},e.results),a=e.results[t].score,r=p.a.flow([p.a.take(t),p.a.uniqBy("nickname"),p.a.remove(function(e){return o.includes(e.nickname)||e.score===a})])(e.results);return ft({},e,{distanceFromProtagonist:Math.sqrt(p.a.reduce(function(e,t){return e+Math.pow(t.score/a-.99,2)},0,r))})}),p.a.orderBy(["distanceFromProtagonist"],["desc"])],f=function(e){return[p.a.filter(function(e){return p.a.map("nickname",e.results).includes(i)}),p.a.orderBy([function(t){return p.a.getOr("asc"===e?1/0:-1/0,"ratingDiff",p.a.find({nickname:i},t.results))}],[e])]},g=(a={},Object(r.a)(a,J.DEFAULT,u),Object(r.a)(a,J.NEW_SCORES_PLAYER,m),Object(r.a)(a,J.PROTAGONIST,d),Object(r.a)(a,J.RANK_ASC,f("asc")),Object(r.a)(a,J.RANK_DESC,f("desc")),a)[s]||u;return p.a.flow(p.a.compact([t.chartRange&&function(e){return function(e,t){var a=p.a.getOr(Q,"range",e),r=p.a.getOr(null,"type",e);return p.a.flow(p.a.filter(function(e){return e.chartLevel>=a[0]&&e.chartLevel<=a[1]&&(!r||r===e.chartType)}))(t)}(t.chartRange,e)},!t.showRank&&p.a.map(function(e){return ft({},e,{results:p.a.filter(function(e){return!e.isRank},e.results)})}),t.showRank&&t.showOnlyRank&&p.a.map(function(e){return ft({},e,{results:p.a.filter(function(e){return e.isRank},e.results)})}),t.showRank&&!t.showOnlyRank&&!t.showRankAndNorank&&p.a.map(function(e){var t=[];return ft({},e,{results:p.a.filter(function(e){var a=t.includes(e.nickname);return t.push(e.nickname),!a},e.results)})}),(n.length||c.length||l.length)&&p.a.filter(function(e){var t=p.a.map("nickname",e.results);return(!n.length||p.a.every(function(e){return t.includes(e)},n))&&(!c.length||p.a.some(function(e){return t.includes(e)},c))&&(!l.length||!p.a.some(function(e){return t.includes(e)},l))}),p.a.filter(function(e){return p.a.size(e.results)})].concat(Object(O.a)(g),[t.song&&function(e){return Object(dt.a)(e,t.song,{keys:["song"]})}])))(e)});function bt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}function vt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?bt(a,!0).forEach(function(t){Object(r.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):bt(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var Et=[{label:"\u043e\u0442 \u043d\u043e\u0432\u044b\u0445 \u0441\u043a\u043e\u0440\u043e\u0432",value:J.DEFAULT},{label:"\u043e\u0442 \u043d\u043e\u0432\u044b\u0445 \u0441\u043a\u043e\u0440\u043e\u0432 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u0438\u0433\u0440\u043e\u043a\u0430",value:J.NEW_SCORES_PLAYER},{label:"\u043e\u0442 \u0445\u0443\u0434\u0448\u0438\u0445 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u0432",value:J.RANK_ASC},{label:"\u043e\u0442 \u043b\u0443\u0447\u0448\u0438\u0445 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u0432",value:J.RANK_DESC}],yt={fetchTopScores:Ie,setFilter:Le,resetFilter:function(){return{type:De}},selectPreset:Ue,openPreset:Je},Ot=function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,c=new Array(n),l=0;l<n;l++)c[l]=arguments[l];return(a=Object(h.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(c)))).state={showItemsCount:20},a.setFilter=p.a.curry(function(e,t){var n=vt({},a.props.filter,Object(r.a)({},e,t));a.props.setFilter(n),m.a.setItem("filter",n)}),a.resetFilter=function(){a.props.resetFilter(),m.a.setItem("filter",Ce)},a.onRefresh=function(){!a.props.isLoading&&a.props.fetchTopScores()},a}return Object(v.a)(t,e),Object(g.a)(t,[{key:"renderSimpleSearch",value:function(){var e=this.props,t=e.isLoading,a=e.filter;return c.a.createElement("div",{className:"simple-search"},c.a.createElement("div",{className:"song-name _margin-right _margin-bottom"},c.a.createElement(K,{value:a.song||"",placeholder:"\u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043f\u0435\u0441\u043d\u0438...",className:"form-control",onChange:this.setFilter("song")})),c.a.createElement("div",{className:"chart-range _margin-right _margin-bottom"},c.a.createElement(z,{filterValue:a.chartRange,onChange:this.setFilter("chartRange")})),c.a.createElement("div",{className:"_flex-fill"}),c.a.createElement("div",{className:"_flex-row _margin-bottom"},c.a.createElement($e,null),c.a.createElement("button",{className:"btn btn-sm btn-dark btn-icon _margin-right",onClick:this.resetFilter},c.a.createElement(D.k,null)," \u0441\u0431\u0440\u043e\u0441\u0438\u0442\u044c \u0444\u0438\u043b\u044c\u0442\u0440\u044b"),c.a.createElement("button",{disabled:t,className:"btn btn-sm btn-dark btn-icon",onClick:this.onRefresh},c.a.createElement(D.m,null)," \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c")))}},{key:"renderFilters",value:function(){var e=this,t=this.props,a=t.players,r=t.filter;return c.a.createElement("div",{className:"filters"},c.a.createElement("div",{className:"people-filters"},c.a.createElement("label",{className:"label"},"\u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c \u0447\u0430\u0440\u0442\u044b, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0441\u044b\u0433\u0440\u0430\u043b:"),c.a.createElement("div",{className:"players-block"},c.a.createElement("div",{className:"_margin-right"},c.a.createElement("label",{className:"label"},"\u043a\u0430\u0436\u0434\u044b\u0439 \u0438\u0437 \u044d\u0442\u0438\u0445"),c.a.createElement(N.a,{closeMenuOnSelect:!1,className:"select players",classNamePrefix:"select",placeholder:"\u0438\u0433\u0440\u043e\u043a\u0438...",isMulti:!0,options:a,value:p.a.getOr(null,"players",r),onChange:this.setFilter("players")})),c.a.createElement("div",{className:"_margin-right"},c.a.createElement("label",{className:"label"},"\u0438 \u0445\u043e\u0442\u044c \u043e\u0434\u0438\u043d \u0438\u0437 \u044d\u0442\u0438\u0445"),c.a.createElement(N.a,{closeMenuOnSelect:!1,className:"select players",classNamePrefix:"select",placeholder:"\u0438\u0433\u0440\u043e\u043a\u0438...",isMulti:!0,options:a,value:p.a.getOr(null,"playersOr",r),onChange:this.setFilter("playersOr")})),c.a.createElement("div",{className:"_margin-right"},c.a.createElement("label",{className:"label"},"\u0438 \u043d\u0438\u043a\u0442\u043e \u0438\u0437 \u044d\u0442\u0438\u0445"),c.a.createElement(N.a,{closeMenuOnSelect:!1,className:"select players",classNamePrefix:"select",placeholder:"\u0438\u0433\u0440\u043e\u043a\u0438...",isMulti:!0,options:a,value:p.a.getOr(null,"playersNot",r),onChange:this.setFilter("playersNot")})))),c.a.createElement("div",null,c.a.createElement(G,{checked:p.a.getOr(!1,"showRank",r),onChange:this.setFilter("showRank")},"\u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c \u0441\u043a\u043e\u0440\u044b \u043d\u0430 \u0440\u0430\u043d\u043a\u0435")),p.a.get("showRank",r)&&c.a.createElement(c.a.Fragment,null,c.a.createElement("div",null,c.a.createElement(G,{checked:p.a.getOr(!1,"showOnlyRank",r),onChange:function(t){e.setFilter("showOnlyRank",t),p.a.get("showRankAndNorank",r)&&e.setFilter("showRankAndNorank",!1)}},c.a.createElement("strong",null,"\u0442\u043e\u043b\u044c\u043a\u043e")," \u043d\u0430 \u0440\u0430\u043d\u043a\u0435")),c.a.createElement("div",null,c.a.createElement(G,{checked:p.a.getOr(!1,"showRankAndNorank",r),onChange:function(t){e.setFilter("showRankAndNorank",t),p.a.get("showOnlyRank",r)&&e.setFilter("showOnlyRank",!1)}},"\u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c \u043b\u0443\u0447\u0448\u0438\u0435 \u0441\u043a\u043e\u0440\u044b \u0441 \u0440\u0430\u043d\u043a\u043e\u043c \u0438 \u0431\u0435\u0437"))))}},{key:"renderSortings",value:function(){var e=this.props,t=e.players,a=e.filter;return c.a.createElement("div",{className:"sortings"},c.a.createElement("div",null,c.a.createElement("label",{className:"label"},"\u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0430:"),c.a.createElement(N.a,{placeholder:"\u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0443",className:"select",classNamePrefix:"select",isClearable:!1,options:Et,value:p.a.getOr(Et[0],"sortingType",a),onChange:this.setFilter("sortingType")})),[J.PROTAGONIST,J.RANK_ASC,J.RANK_DESC,J.NEW_SCORES_PLAYER].includes(p.a.get("sortingType.value",a))&&c.a.createElement("div",null,c.a.createElement("label",{className:"label"},"\u0438\u0433\u0440\u043e\u043a:"),c.a.createElement(N.a,{className:S()("select players",{"red-border":!p.a.get("protagonist",a)}),classNamePrefix:"select",placeholder:"\u0438\u0433\u0440\u043e\u043a\u0438...",options:t,value:p.a.getOr(null,"protagonist",a),onChange:this.setFilter("protagonist")})),[J.PROTAGONIST].includes(p.a.get("sortingType.value",a))&&c.a.createElement("div",null,c.a.createElement("label",{className:"label"},"\u043d\u0435 \u0443\u0447\u0438\u0442\u044b\u0432\u0430\u0442\u044c \u0432 \u0441\u0440\u0430\u0432\u043d\u0435\u043d\u0438\u0438:"),c.a.createElement(N.a,{closeMenuOnSelect:!1,className:"select players",classNamePrefix:"select",placeholder:"\u0438\u0433\u0440\u043e\u043a\u0438...",options:t,isMulti:!0,value:p.a.getOr([],"excludeAntagonists",a),onChange:this.setFilter("excludeAntagonists")})))}},{key:"render",value:function(){var e=this,t=this.props,a=t.isLoading,r=t.filteredData,n=t.error,l=t.filter,s=this.state.showItemsCount,o=r.length>s,u=p.a.slice(0,s,r),m=[J.PROTAGONIST,J.RANK_ASC,J.RANK_DESC].includes(p.a.get("sortingType.value",l)),d=[J.PROTAGONIST,J.RANK_ASC,J.RANK_DESC,J.NEW_SCORES_PLAYER].includes(p.a.get("sortingType.value",l)),f=p.a.get("protagonist.value",l),g=p.a.slice(0,ut.length,p.a.uniq(p.a.compact([d&&f].concat(Object(O.a)(p.a.map("value",l.players)),Object(O.a)(p.a.map("value",l.playersOr))))));return c.a.createElement("div",{className:"leaderboard-page"},c.a.createElement("div",{className:"content"},c.a.createElement("div",{className:"search-block"},this.renderSimpleSearch(),c.a.createElement(q,{title:"\u0444\u0438\u043b\u044c\u0442\u0440\u044b"},this.renderFilters()),c.a.createElement(q,{title:"\u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0430"},this.renderSortings())),a&&c.a.createElement(B,null),!!this.props.presets.length&&c.a.createElement("div",{className:"presets-buttons"},c.a.createElement("span",null,"\u043f\u0440\u0435\u0441\u0435\u0442\u044b:"),this.props.presets.map(function(t){return c.a.createElement(T,{text:t.name,className:"btn btn-sm btn-dark _margin-right",active:p.a.get("filter",t)===e.props.filter,onToggle:function(){e.props.selectPreset(t),e.props.openPreset()}})})),c.a.createElement("div",{className:"top-list"},p.a.isEmpty(r)&&!a&&(n?n.message:"\u043d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e"),!a&&u.map(function(e,t){var a=1,r=[],n=e.results.map(function(t,n){var c=r.includes(t.nickname);return r.push(t.nickname),0===n?a=1:c||t.score===p.a.get([n-1,"score"],e.results)||(a+=1),vt({},t,{topPlace:a,isSecondOccurenceInResults:c})});return c.a.createElement("div",{className:"song-block",key:e.song+e.chartLabel},c.a.createElement("div",{className:"song-name"},c.a.createElement("div",{className:S()("chart-name",{single:"S"===e.chartType})},c.a.createElement("span",{className:"chart-letter"},e.chartType),c.a.createElement("span",{className:"chart-number"},e.chartLevel)),c.a.createElement("div",null,e.song),c.a.createElement("div",{className:"youtube-link"},c.a.createElement("a",{href:"https://youtube.com/results?search_query=".concat(e.song.replace(/ /g,"+").replace(/-/g,""),"+").concat(e.chartLabel),target:"_blank",rel:"noopener noreferrer"},c.a.createElement(D.o,null)))),c.a.createElement("div",{className:"charts"},c.a.createElement("div",{className:"chart"},c.a.createElement("div",{className:"results"},c.a.createElement("table",null,0===t&&c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",{className:"place"}),c.a.createElement("th",{className:"nickname"}),c.a.createElement("th",{className:"rank"}),c.a.createElement("th",{className:"score"},"score"),c.a.createElement("th",{className:"grade"}),c.a.createElement("th",{className:"number"},"miss"),c.a.createElement("th",{className:"number"},"bad"),c.a.createElement("th",{className:"number"},"good"),c.a.createElement("th",{className:"number"},"great"),c.a.createElement("th",{className:"number"},"perfect"),c.a.createElement("th",{className:"combo"},"combo"),c.a.createElement("th",{className:"accuracy"},"accuracy"),c.a.createElement("th",{className:"date"}))),c.a.createElement("tbody",null,n.map(function(t,a){var r,s,o=g.indexOf(t.nickname);if(t.scoreIncrease&&t.date===e.latestScoreDate){var u=t.score-t.scoreIncrease;r=p.a.findLastIndex(function(e){return e.score>u},n)-a}return c.a.createElement("tr",{key:t.score+t.nickname,className:S()({empty:!t.isExactDate,latest:t.date===e.latestScoreDate})},c.a.createElement("td",{className:"place"},t.isSecondOccurenceInResults?"":"#".concat(t.topPlace)),c.a.createElement("td",{className:"nickname",style:o>-1?{fontWeight:"bold",color:ut[o]}:{}},t.nickname,!!r&&c.a.createElement("span",{className:"change-holder up"},c.a.createElement("span",null,r),c.a.createElement(D.b,null)),te&&c.a.createElement("span",null," ",t.startingRating&&Math.round(t.startingRating)," ",t.ratingDiff&&Math.round(t.ratingDiff)," ",t.ratingDiffLast&&Math.round(t.ratingDiffLast)),!te&&m&&t.nickname===f&&t.ratingDiff&&c.a.createElement("span",null," (".concat(t.ratingDiff>0?"+":"").concat(Math.round(t.ratingDiff),")")),p.a.get("sortingType.value",l)===J.PROTAGONIST&&t.nickname===f&&e.distanceFromProtagonist>0&&c.a.createElement("span",{className:"protagonist-diff"}," ","-",(100*e.distanceFromProtagonist).toFixed(1),"%")),c.a.createElement("td",{className:S()("judge",{vj:t.isRank,hj:t.isHJ})},t.isRank&&c.a.createElement("div",{className:"inner"},t.isExactDate?"VJ":c.a.createElement(x.a,{content:c.a.createElement("div",null,"\u043d\u0430\u043b\u0438\u0447\u0438\u0435 \u0440\u0430\u043d\u043a\u0430 \u043d\u0430 \u044d\u0442\u043e\u043c \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0435 \u0431\u044b\u043b\u043e \u0443\u0433\u0430\u0434\u0430\u043d\u043e, \u043e\u0441\u043d\u043e\u0432\u044b\u0432\u0430\u044f\u0441\u044c \u043d\u0430 \u0441\u043a\u043e\u0440\u0435"),tooltipClassName:"timeago-tooltip"},"VJ?")),t.isHJ&&c.a.createElement("div",{className:"inner"},"HJ")),c.a.createElement("td",{className:"score"},c.a.createElement(_,{overlayClassName:"score-overlay-outer",overlayItem:c.a.createElement("span",{className:"score-span"},t.scoreIncrease>.8*t.score&&"*",w()(t.score).format("0,0")),placement:"top"},c.a.createElement("div",{className:"score-overlay"},c.a.createElement("div",null,c.a.createElement("span",{className:"_grey"},"\u0438\u0433\u0440\u043e\u043a: "),c.a.createElement(i.c,{exact:!0,to:y.profile.getPath({id:t.playerId})},t.nickname," (",t.nicknameArcade,")")),!t.isExactDate&&c.a.createElement("div",{className:"warning"},c.a.createElement(D.f,null),"\u0440\u0435\u043a\u043e\u0440\u0434 \u0432\u0437\u044f\u0442 \u0441 my best. \u0447\u0430\u0441\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0445 \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u0430"),t.isExactDate&&c.a.createElement(c.a.Fragment,null,t.mods&&c.a.createElement("div",null,c.a.createElement("span",{className:"_grey"},"\u043c\u043e\u0434\u044b: "),t.mods),t.calories&&c.a.createElement("div",null,c.a.createElement("span",{className:"_grey"},"\u043a\u043a\u0430\u043b: "),t.calories),t.scoreIncrease&&c.a.createElement("div",null,c.a.createElement("span",{className:"_grey"},"\u043f\u0440\u0438\u0440\u043e\u0441\u0442: "),"+",w()(t.scoreIncrease).format("0,0")),t.originalChartMix&&c.a.createElement("div",null,c.a.createElement("div",{className:"warning"},c.a.createElement(D.f,null),"\u0431\u044b\u043b\u043e \u0441\u044b\u0433\u0440\u0430\u043d\u043e \u043d\u0430 ",t.originalChartMix),t.originalChartLabel&&c.a.createElement("div",null,c.a.createElement("span",{className:"_grey"},"\u043e\u0440\u0438\u0433\u0438\u043d\u0430\u043b\u044c\u043d\u044b\u0439 \u0447\u0430\u0440\u0442:"," "),t.originalChartLabel),t.originalScore&&c.a.createElement("div",null,c.a.createElement("span",{className:"_grey"},"\u043e\u0440\u0438\u0433\u0438\u043d\u0430\u043b\u044c\u043d\u044b\u0439 \u0441\u043a\u043e\u0440:"," "),t.originalScore)),t.scoreIncrease>.8*t.score&&"* \u0441\u0430\u0439\u0442\u0440\u0438\u0434")))),c.a.createElement("td",{className:"grade"},c.a.createElement("div",{className:"img-holder"},t.grade&&"?"!==t.grade&&c.a.createElement("img",{src:"".concat("/piu-spy-web","/grades/").concat(t.grade,".png"),alt:t.grade}),"?"===t.grade&&null)),c.a.createElement("td",{className:"number miss"},t.miss),c.a.createElement("td",{className:"number bad"},t.bad),c.a.createElement("td",{className:"number good"},t.good),c.a.createElement("td",{className:"number great"},t.great),c.a.createElement("td",{className:"number perfect"},t.perfect),c.a.createElement("td",{className:"combo"},t.combo,t.combo?"x":""),c.a.createElement("td",{className:"accuracy"},t.accuracy,t.accuracy?"%":""),c.a.createElement("td",{className:S()("date",{latest:t.date===e.latestScoreDate})},c.a.createElement(x.a,{content:t.isExactDate?(s=t.dateObject,s.toLocaleDateString()):it(t.dateObject),tooltipClassName:"timeago-tooltip"},ot(t.dateObject),t.isExactDate?"":"?")))})))))))}),!a&&o&&c.a.createElement("button",{className:"btn btn-sm btn-primary",onClick:function(){return e.setState(function(e){return{showItemsCount:e.showItemsCount+10}})}},"show more..."))))}}]),t}(n.Component),Nt=Object(o.b)(function(e){return{players:gt(e),filteredData:ht(e),data:e.top.data,filter:e.top.filter,error:e.top.error,isLoading:e.top.isLoading,presets:e.presets.presets,currentPreset:e.presets.currentPreset}},yt)(Ot),kt=(a(260),a(185)),St=function(e){return c.a.createElement("img",{src:"".concat("/piu-spy-web","/grades/").concat(e,".png"),alt:e})};function jt(e){var t=e.ranking,a=e.isLoading;return c.a.createElement("div",{className:"ranking-list"},p.a.isEmpty(t)&&!a&&"\u043d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e",a&&c.a.createElement(B,null),!a&&c.a.createElement("table",null,c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",{className:"place"}),c.a.createElement("th",{className:"change"}),c.a.createElement("th",{className:"name"},"name"),c.a.createElement("th",{className:"name2"},"piu name"),c.a.createElement("th",{className:"rating"},"elo"),c.a.createElement("th",{className:"total-score"},"total score"),c.a.createElement("th",{className:"grades sss"},St("SSS")),c.a.createElement("th",{className:"grades ss"},St("SS")),c.a.createElement("th",{className:"grades s"},St("S")),c.a.createElement("th",{className:"grades a"},St("A+")),c.a.createElement("th",{className:"grades b"},St("B")),c.a.createElement("th",{className:"grades c"},St("C")),c.a.createElement("th",{className:"grades d"},St("D")),c.a.createElement("th",{className:"grades f"},St("F")),c.a.createElement("th",{className:"playcount"},"scores"),c.a.createElement("th",{className:"calories"},"cal"),c.a.createElement("th",{className:"accuracy"},"accuracy"))),c.a.createElement("tbody",null,t.map(function(e,t){return c.a.createElement("tr",{className:"player",key:e.name},c.a.createElement("td",{className:"place"},0===t?c.a.createElement(kt.a,null):"#".concat(t+1)),c.a.createElement("td",{className:"change"},e.change>0&&c.a.createElement("div",{className:"change-holder up"},c.a.createElement("span",null,e.change),c.a.createElement(D.b,null)),e.change<0&&c.a.createElement("div",{className:"change-holder down"},c.a.createElement("span",null,-e.change),c.a.createElement(D.a,null)),!!e.change&&p.a.isString(e.change)&&c.a.createElement("div",{className:"change-holder text"},c.a.createElement("span",null,e.change))),c.a.createElement("td",{className:"name"},c.a.createElement(i.c,{exact:!0,to:y.profile.getPath({id:e.id})},e.name)),c.a.createElement("td",{className:"name"},c.a.createElement(i.c,{exact:!0,to:y.profile.getPath({id:e.id})},e.nameArcade)),c.a.createElement("td",{className:"rating"},e.rating," ",!!e.prevRating&&e.prevRating!==e.rating&&c.a.createElement("span",{className:S()("rating-change",{down:e.prevRating>e.rating,up:e.prevRating<e.rating})},e.prevRating<e.rating?"+":"",e.rating-e.prevRating)),c.a.createElement("td",{className:"total-score"},c.a.createElement("div",null,"S: ",w()(e.totalScore.S).format("0,0")),c.a.createElement("div",null,"D: ",w()(e.totalScore.D).format("0,0"))),c.a.createElement("td",{className:"grades sss"},e.grades.SSS),c.a.createElement("td",{className:"grades ss"},e.grades.SS),c.a.createElement("td",{className:"grades s"},e.grades.S),c.a.createElement("td",{className:"grades a"},e.grades.A),c.a.createElement("td",{className:"grades b"},e.grades.B),c.a.createElement("td",{className:"grades c"},e.grades.C),c.a.createElement("td",{className:"grades d"},e.grades.D),c.a.createElement("td",{className:"grades f"},e.grades.F),c.a.createElement("td",{className:"playcount"},e.count),c.a.createElement("td",{className:"calories"},w()(e.totalScore.calories).format("0,0")),c.a.createElement("td",{className:"accuracy"},e.accuracy?"".concat(e.accuracy,"%"):""))}))))}function wt(){return c.a.createElement("div",{className:"faq"},c.a.createElement("div",{className:"question-answer"},c.a.createElement("div",{className:"question"},"Q: \u041a\u0430\u043a \u0441\u0447\u0438\u0442\u0430\u0435\u0442\u0441\u044f \u0440\u0435\u0439\u0442\u0438\u043d\u0433?"),c.a.createElement("div",{className:"answer"},"A: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f ",c.a.createElement("a",{href:"https://en.wikipedia.org/wiki/Elo_rating_system"},"\u0440\u0435\u0439\u0442\u0438\u043d\u0433 \u042d\u043b\u043e"),", \u0448\u0438\u0440\u043e\u043a\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0439 \u0432 \u0448\u0430\u0445\u043c\u0430\u0442\u0430\u0445 \u0438 \u0434\u0440\u0443\u0433\u0438\u0445 \u0438\u0433\u0440\u0430\u0445, \u0441\u043b\u0435\u0433\u043a\u0430 \u043c\u043e\u0434\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0439 \u043f\u043e\u0434 \u0443\u0441\u043b\u043e\u0432\u0438\u044f \u0438\u0433\u0440\u044b \u043d\u0430 \u043f\u0430\u043c\u043f\u0435. \u0421\u0440\u0435\u0434\u043d\u0438\u0439 \u0440\u0435\u0439\u0442\u0438\u043d\u0433 - 1000. \u041a\u043e\u044d\u0444\u0444\u0438\u0446\u0438\u0435\u043d\u0442 \u041a \u0437\u0430\u0432\u0438\u0441\u0438\u0442 \u043e\u0442 \u0443\u0440\u043e\u0432\u043d\u044f \u0447\u0430\u0440\u0442\u0430 (\u0431\u043e\u043b\u0435\u0435 \u0441\u043b\u043e\u0436\u043d\u044b\u0435 \u0447\u0430\u0440\u0442\u044b \u0441\u0438\u043b\u044c\u043d\u0435\u0435 \u0432\u043b\u0438\u044f\u044e\u0442 \u043d\u0430 \u0440\u0435\u0439\u0442\u0438\u043d\u0433). \u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043e\u0447\u043a\u043e\u0432 \u0432\u043b\u0438\u044f\u0435\u0442 \u043d\u0430 \u0437\u0430\u0440\u0430\u0431\u043e\u0442\u0430\u043d\u043d\u044b\u0439 \u0440\u0435\u0439\u0442\u0438\u043d\u0433 (\u043c\u0430\u043b\u0435\u043d\u044c\u043a\u0438\u0439 \u043e\u0442\u0440\u044b\u0432 \u043e\u0442 \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u0438\u043a\u0430 \u043d\u0435 \u0434\u0430\u0441\u0442 \u0442\u0430\u043a \u043c\u043d\u043e\u0433\u043e \u043e\u0447\u043a\u043e\u0432 \u043a\u0430\u043a \u0431\u043e\u043b\u044c\u0448\u043e\u0439 \u043e\u0442\u0440\u044b\u0432).")),c.a.createElement("div",{className:"question-answer"},c.a.createElement("div",{className:"question"},"Q: \u0421\u0438\u0441\u0442\u0435\u043c\u0430 \u042d\u043b\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0438\u0433\u0440 1 \u043d\u0430 1, \u043a\u0430\u043a \u043e\u043d\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u043d\u0430 \u043f\u0430\u043c\u043f\u0435, \u0433\u0434\u0435 \u043d\u0430 \u043e\u0434\u043d\u043e\u043c \u0447\u0430\u0440\u0442\u0435 \u0438\u0433\u0440\u0430\u0435\u0442 \u043c\u043d\u043e\u0433\u043e \u0438\u0433\u0440\u043e\u043a\u043e\u0432?"),c.a.createElement("div",{className:"answer"},"A: \u0420\u0435\u043a\u043e\u0440\u0434\u044b \u043d\u0430 \u043e\u0434\u043d\u043e\u043c \u0447\u0430\u0440\u0442\u0435 \u0434\u0435\u043b\u044f\u0442\u0441\u044f \u043d\u0430 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0438\u0433\u0440 1 \u043d\u0430 1. \u0415\u0441\u043b\u0438 \u0435\u0441\u0442\u044c 3 \u0438\u0433\u0440\u043e\u043a\u0430: A, B, C; \u0442\u043e \u0441\u0447\u0438\u0442\u0430\u0435\u0442\u0441\u044f, \u0447\u0442\u043e \u0431\u044b\u043b\u043e 3 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u0435 \u0438\u0433\u0440\u044b: A vs B, A vs C, B vs C.")),c.a.createElement("div",{className:"question-answer"},c.a.createElement("div",{className:"question"},"Q: \u0423\u0447\u0438\u0442\u044b\u0432\u0430\u044e\u0442\u0441\u044f \u043b\u0438 \u0440\u0435\u043a\u043e\u0440\u0434\u044b \u043d\u0430 \u0440\u0430\u043d\u043a\u0435 \u0432 \u0440\u0435\u0439\u0442\u0438\u043d\u0433\u0435?"),c.a.createElement("div",{className:"answer"},"A: \u0414\u0430. \u041a\u0430\u043a \u043c\u0438\u043d\u0438\u043c\u0443\u043c \u043f\u043e\u0442\u043e\u043c\u0443 \u0447\u0442\u043e \u0443 \u043d\u0430\u0441 \u0435\u0441\u0442\u044c \u043c\u043d\u043e\u0433\u043e \u0440\u0435\u043a\u043e\u0440\u0434\u043e\u0432, \u0432\u0437\u044f\u0442\u044b\u0445 \u0441 \u043c\u0430\u0448\u0438\u043d \u0431\u0435\u0441\u0442\u043e\u0432, \u0438 \u043c\u044b \u043d\u0435 \u0437\u043d\u0430\u0435\u043c \u043d\u0430\u0432\u0435\u0440\u043d\u044f\u043a\u0430, \u043d\u0430 \u0440\u0430\u043d\u043a\u0435 \u043e\u043d\u0438 \u0438\u043b\u0438 \u043d\u0435\u0442. \u0415\u0441\u043b\u0438 \u0443 \u0438\u0433\u0440\u043e\u043a\u0430 \u0432 \u0442\u043e\u043f\u0435 \u0435\u0441\u0442\u044c \u0434\u0432\u0430 \u0441\u043a\u043e\u0440\u0430 - \u043d\u0430 \u0440\u0430\u043d\u043a\u0435 \u0438 \u0431\u0435\u0437 \u0440\u0430\u043d\u043a\u0430, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0442\u043e\u0442, \u0433\u0434\u0435 \u0431\u043e\u043b\u044c\u0448\u0435 \u043e\u0447\u043a\u043e\u0432.")),c.a.createElement("div",{className:"question-answer"},c.a.createElement("div",{className:"question"},"Q: \u041f\u043e\u0447\u0435\u043c\u0443 \u043c\u0435\u043d\u044f \u043d\u0435\u0442 \u0432 \u0440\u0435\u0439\u0442\u0438\u043d\u0433\u0435?"),c.a.createElement("div",{className:"answer"},"A: \u0412 \u0442\u0430\u0431\u043b\u0438\u0446\u0443 \u043f\u043e\u043f\u0430\u0434\u0430\u044e\u0442 \u0442\u043e\u043b\u044c\u043a\u043e \u0442\u0435, \u0443 \u043a\u043e\u0433\u043e \u0435\u0441\u0442\u044c \u0445\u043e\u0442\u044f \u0431\u044b 20 \u0438\u0433\u0440 1 \u043d\u0430 1. \u041f\u0435\u0440\u0432\u044b\u0435 20 \u0438\u0433\u0440 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442\u0441\u044f \u0434\u043b\u044f \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u044f \u0438\u0437\u043d\u0430\u0447\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u0440\u0435\u0439\u0442\u0438\u043d\u0433\u0430.")),c.a.createElement("div",{className:"question-answer"},c.a.createElement("div",{className:"question"},"Q: \u041f\u043e\u0447\u0435\u043c\u0443 \u0441\u0443\u043c\u043c\u0430\u0440\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043e\u0446\u0435\u043d\u043e\u043a S-A-B \u043d\u0435 \u0441\u043e\u0432\u043f\u0430\u0434\u0430\u0435\u0442 \u0441 \u043e\u0431\u0449\u0438\u043c \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e\u043c \u0441\u043a\u043e\u0440\u043e\u0432?"),c.a.createElement("div",{className:"answer"},"A: \u041d\u0435 \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430 \u0438\u0437\u0432\u0435\u0441\u0442\u043d\u0430 \u043e\u0446\u0435\u043d\u043a\u0430.")),c.a.createElement("div",{className:"question-answer"},c.a.createElement("div",{className:"question"},"Q: \u0415\u0441\u043b\u0438 \u0443 \u043c\u0435\u043d\u044f \u0435\u0441\u0442\u044c \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0440\u0435\u043a\u043e\u0440\u0434\u043e\u0432 \u043d\u0430 \u0410, \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u043d\u0430 \u0410+, \u043a\u0430\u043a \u0441\u0447\u0438\u0442\u0430\u0435\u0442\u0441\u044f \u0441\u0443\u043c\u043c\u0430\u0440\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0433\u0440\u0435\u0439\u0434\u043e\u0432 \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0435?"),c.a.createElement("div",{className:"answer"},"A: \u0412 \u043a\u0430\u0436\u0434\u043e\u0439 \u043a\u043e\u043b\u043e\u043d\u043a\u0435 \u0443\u0447\u0438\u0442\u044b\u0432\u0430\u044e\u0442\u0441\u044f \u043e\u0431\u0435 \u0431\u0443\u043a\u0432\u044b - \u0438 \u0442\u0440\u0435\u0441\u043d\u0443\u0442\u044b\u0435, \u0438 \u0441 \u0443\u0434\u0435\u0440\u0436\u0430\u043d\u043d\u044b\u043c \u043b\u0430\u0439\u0444\u043e\u043c. \u0422\u043e \u0435\u0441\u0442\u044c \u0438 \u0410, \u0438 \u0410+ \u0438\u0434\u0443\u0442 \u0432 \u043a\u043e\u043b\u043e\u043d\u043a\u0443 \u0410. \u0422\u043e\u0447\u043d\u043e \u0442\u0430\u043a \u0436\u0435 \u0434\u043b\u044f B, C, D.")),c.a.createElement("div",{className:"question-answer"},c.a.createElement("div",{className:"question"},"Q: \u0423\u0431\u0435\u0440\u0438 \u0430\u043a\u043a\u0443\u0440\u0430\u0441\u0438 \u0438\u0437 \u0442\u0430\u0431\u043b\u0438\u0446\u044b!"),c.a.createElement("div",{className:"answer"},"A: \u0413\u0440\u0435\u043c, \u044d\u0442\u043e \u0441\u0435\u043a\u0446\u0438\u044f \u0434\u043b\u044f \u0432\u043e\u043f\u0440\u043e\u0441\u043e\u0432.")))}var Pt={fetchTopScores:Ie},xt=function(e){function t(){var e,a;Object(f.a)(this,t);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];return(a=Object(h.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(n)))).onRefresh=function(){!a.props.isLoading&&a.props.fetchTopScores()},a}return Object(v.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.isLoading,r=t.ranking,n=t.error;return c.a.createElement("div",{className:"ranking-page"},c.a.createElement("div",{className:"content"},n&&n.message,c.a.createElement("div",{className:"top-controls"},c.a.createElement("div",{className:"_flex-fill"}),c.a.createElement(E.b,{exact:!0,path:y.ranking.path,render:function(){return c.a.createElement(c.a.Fragment,null,c.a.createElement(i.b,{to:y.ranking.faq.path},c.a.createElement("button",{className:"btn btn-sm btn-dark btn-icon _margin-right"},c.a.createElement(D.j,null)," faq")),c.a.createElement("button",{disabled:a,className:"btn btn-sm btn-dark btn-icon",onClick:e.onRefresh},c.a.createElement(D.m,null)," \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c"))}}),c.a.createElement(E.b,{exact:!0,path:y.ranking.faq.path,render:function(){return c.a.createElement(i.b,{to:y.ranking.path},c.a.createElement("button",{className:"btn btn-sm btn-dark btn-icon"},"\u043d\u0430\u0437\u0430\u0434"))}})),c.a.createElement(E.b,{exact:!0,path:y.ranking.path,render:function(){return c.a.createElement(jt,{ranking:r,isLoading:a})}}),c.a.createElement(E.b,{exact:!0,path:y.ranking.faq.path,component:wt})))}}]),t}(n.Component);xt.defaultProps={ranking:[]};var Dt=Object(o.b)(function(e){return{ranking:e.ranking.data,error:e.top.error,isLoading:e.top.isLoading}},Pt)(Object(E.f)(xt)),Ct=a(7);a(437);function Rt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}function At(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Rt(a,!0).forEach(function(t){Object(r.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Rt(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var It={SSS:0,SS:0,S:0,"A+":0,A:0,B:0,C:0,D:0,F:0},Lt=p.a.flow(p.a.flatMap(function(e){return p.a.flow(p.a.toPairs,p.a.map(function(t){var a=Object(Z.a)(t,2),r=a[0],n=a[1];return["".concat(e,"-").concat(r),n]}))(It)}),p.a.fromPairs)(["S","D"]),Mt=function(e,t){var a=p.a.findIndex(function(e){return e.date>t[0]},e),r=p.a.findLastIndex(function(e){return e.date<t[1]},e),n=a>0?e[a-1]:0===a?e[a]:p.a.last(e),c=r>-1?e[r]:p.a.first(e);n=At({},n,{date:t[0]}),c=At({},c,{date:t[1]});var l=a>-1&&r>-1?e.slice(a,r+1):[];return[n].concat(Object(O.a)(l),[c])},Ft=Object(mt.a)(function(e,t){return p.a.toInteger(t.match.params.id)},function(e){return e.profiles.data},function(e){return e.profiles.filter},function(e){return e.top.players},function(e){return e.ranking.data},function(e){return e.tracklist.data},function(e,t,a,r,n,c){var l=t[e];if(p.a.isEmpty(l))return null;var s=p.a.flow(p.a.get("resultsByLevel"),p.a.toPairs,p.a.map(function(e){var t=Object(Z.a)(e,2),a=t[0],r=t[1];return{x:p.a.toInteger(a),S:p.a.size(p.a.filter(function(e){return"S"===e.chart.chartType},r))/c.singlesLevels[a]*100,D:-p.a.size(p.a.filter(function(e){return"D"===e.chart.chartType},r))/c.doublesLevels[a]*100}}))(l),i=p.a.flow(p.a.get("resultsByLevel"),p.a.toPairs,p.a.map(p.a.update("[1].result.grade",function(e){return e&&e.includes("+")&&"A+"!==e?e.replace("+",""):e})))(l),o=p.a.flow(p.a.map(function(e){var t=Object(Z.a)(e,2),a=t[0],r=t[1];return At({x:p.a.toInteger(a)},It,{},p.a.omit("?",p.a.mapValues(p.a.size,p.a.groupBy("result.grade",r))))}),p.a.map(function(e){var t=p.a.pick(Object.keys(It),e),a=p.a.sum(p.a.values(t));return At({},e,{gradesValues:t},0===a?t:p.a.mapValues(function(e){return 100*e/a},t))}))(i),u=p.a.flow(p.a.map(function(e){var t=Object(Z.a)(e,2),a=t[0],r=t[1],n=p.a.groupBy("result.grade",r),l=p.a.omit("?",p.a.mapValues(p.a.countBy("chart.chartType"),n)),s=p.a.reduce(function(e,t){var r=Object(Z.a)(t,2),n=r[0],l=r[1];return At({},e,{},p.a.flow(p.a.toPairs,p.a.map(function(e){var t=Object(Z.a)(e,2),r=t[0],l=t[1];return["".concat(r,"-").concat(n),"S"===r?l/c.singlesLevels[a]*100:-l/c.doublesLevels[a]*100]}),p.a.fromPairs)(l))},{},p.a.toPairs(l));return At({x:p.a.toInteger(a)},Lt,{},s)}))(i),m=p.a.last(l.ratingHistory).date,d=p.a.last(l.rankingHistory).date,f=m>d?m:d,g=[p.a.first(l.ratingHistory).date/1e3/60/60/24,f/1e3/60/60/24],h=a.dayRange||g,b=[1e3*h[0]*60*60*24,1e3*h[1]*60*60*24],v=Mt(l.rankingHistory,b),E=Mt(l.ratingHistory,b),y=p.a.findIndex({id:e},n);return At({},l,{minMaxRange:g,levelsDistribution:s,gradesDistribution:o,gradesAndLevelsDistribution:u,placesChanges:v,ratingChanges:E,player:At({},p.a.find({id:e},r),{rank:y+1,ranking:n[y]})})}),_t={fetchTopScores:Ie,setProfilesFilter:function(e){return{type:ge,filter:e}},resetProfilesFilter:function(){return{type:he}}},Tt=function(e){function t(){var e,a;Object(f.a)(this,t);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];return(a=Object(h.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(n)))).state={isLevelGraphCombined:!1},a.onRefresh=function(){!a.props.isLoading&&a.props.fetchTopScores()},a.onChangeDayRange=function(e){var t=a.props.filter;a.props.setProfilesFilter(At({},t,{dayRange:e}))},a}return Object(v.a)(t,e),Object(g.a)(t,[{key:"componentWillUnmount",value:function(){this.props.resetProfilesFilter()}},{key:"renderRankingHistory",value:function(){var e=this.props.profile;return c.a.createElement(Ct.i,{minHeight:void 0,aspect:1.6},c.a.createElement(Ct.g,{data:e.ratingChanges,margin:{top:5,bottom:5,right:5,left:0}},c.a.createElement(Ct.c,{strokeDasharray:"3 3"}),c.a.createElement(Ct.k,{dataKey:"date",type:"number",domain:["dataMin","dataMax"],tickFormatter:function(e){return new Date(e).toLocaleDateString()}}),c.a.createElement(Ct.l,{allowDecimals:!1,domain:["dataMin - 100","dataMax + 100"],tickFormatter:Math.round,width:40}),c.a.createElement(Ct.h,{y:1e3,stroke:"white"}),c.a.createElement(Ct.j,{isAnimationActive:!1,content:function(e){e.active;var t=e.payload;e.label;return t&&t[0]?c.a.createElement("div",{className:"history-tooltip"},c.a.createElement("div",null,new Date(t[0].payload.date).toLocaleDateString()),t&&t[0]&&c.a.createElement("div",null,"Rating: ",Math.round(t[0].value))):null}}),c.a.createElement(Ct.f,{type:"monotone",isAnimationActive:!1,dataKey:"rating",stroke:"#8884d8",strokeWidth:3,dot:!1})))}},{key:"renderPlaceHistory",value:function(){var e=this.props.profile;return c.a.createElement(Ct.i,{minHeight:void 0,aspect:1.6},c.a.createElement(Ct.g,{data:e.placesChanges,margin:{top:5,bottom:5,right:5,left:0}},c.a.createElement(Ct.c,{strokeDasharray:"3 3"}),c.a.createElement(Ct.k,{dataKey:"date",type:"number",domain:["dataMin","dataMax"],tickFormatter:function(e){return new Date(e).toLocaleDateString()}}),c.a.createElement(Ct.l,{allowDecimals:!1,domain:[1,function(e){return e<3?e+2:e+1}],interval:0,reversed:!0,width:40}),c.a.createElement(Ct.j,{isAnimationActive:!1,content:function(e){e.active;var t=e.payload;e.label;return t&&t[0]?c.a.createElement("div",{className:"history-tooltip"},c.a.createElement("div",null,new Date(t[0].payload.date).toLocaleDateString()),t&&t[0]&&c.a.createElement("div",null,"Place: #",t[0].value)):null}}),c.a.createElement(Ct.f,{isAnimationActive:!1,type:"stepAfter",dataKey:"place",stroke:"#8884d8",strokeWidth:3,dot:!1})))}},{key:"renderGrades",value:function(){var e=this.props.profile;return c.a.createElement(Ct.i,{minHeight:void 0,aspect:1.6},c.a.createElement(Ct.b,{data:e.gradesDistribution,margin:{top:5,bottom:5,right:5,left:0}},c.a.createElement(Ct.j,{isAnimationActive:!1,content:function(e){e.active;var t=e.payload;e.label;return t&&t[0]?c.a.createElement("div",{className:"history-tooltip"},c.a.createElement("div",null,"Level: ",t[0].payload.x),p.a.filter(function(e){return e.value>0},t).map(function(e){return c.a.createElement("div",{key:e.name,style:{fontWeight:"bold",color:e.color}},e.name,": ",t[0].payload.gradesValues[e.name])})):null}}),c.a.createElement(Ct.k,{dataKey:"x"}),c.a.createElement(Ct.l,{domain:[0,100],ticks:[0,50,100],tickFormatter:function(e){return"".concat(Math.round(e),"%")},width:40}),c.a.createElement(Ct.e,null),c.a.createElement(Ct.a,{dataKey:"SSS",fill:"#ffd700",stackId:"stack"}),c.a.createElement(Ct.a,{dataKey:"SS",fill:"#dab800",stackId:"stack"}),c.a.createElement(Ct.a,{dataKey:"S",fill:"#b19500",stackId:"stack"}),c.a.createElement(Ct.a,{dataKey:"A+",fill:"#396eef",stackId:"stack"}),c.a.createElement(Ct.a,{dataKey:"A",fill:"#828fb7",stackId:"stack"}),c.a.createElement(Ct.a,{dataKey:"B",fill:"#7a6490",stackId:"stack"}),c.a.createElement(Ct.a,{dataKey:"C",fill:"#6d5684",stackId:"stack"}),c.a.createElement(Ct.a,{dataKey:"D",fill:"#5d4e6d",stackId:"stack"}),c.a.createElement(Ct.a,{dataKey:"F",fill:"#774949",stackId:"stack"})))}},{key:"renderGradesWithLevels",value:function(){var e=this.props,t=e.profile,a=e.tracklist;return c.a.createElement(Ct.i,{minHeight:void 0,aspect:.74},c.a.createElement(Ct.b,{data:t.gradesAndLevelsDistribution,margin:{top:5,bottom:5,right:5,left:0},stackOffset:"sign"},c.a.createElement(Ct.j,{isAnimationActive:!1,content:function(e){e.active;var t=e.payload;e.label;if(!t||!t[0])return null;var r=p.a.filter(function(e){return 0!==e.value&&e.dataKey.startsWith("D")},t),n=p.a.filter(function(e){return 0!==e.value&&e.dataKey.startsWith("S")},t);return c.a.createElement("div",{className:"history-tooltip"},c.a.createElement("div",null,"Level: ",t[0].payload.x),!!n.length&&c.a.createElement(c.a.Fragment,null,c.a.createElement("div",null,"Single:"),n.map(function(e){return c.a.createElement("div",{key:e.name,style:{fontWeight:"bold",color:e.color}},e.name.slice(2),": ",Math.round(Math.abs(e.value)),"% (",Math.round(a.singlesLevels[e.payload.x]*e.value/100),"/",a.singlesLevels[e.payload.x],")")})),!!r.length&&c.a.createElement(c.a.Fragment,null,c.a.createElement("div",null,"Double:"),r.map(function(e){return c.a.createElement("div",{key:e.name,style:{fontWeight:"bold",color:e.color}},e.name.slice(2),": ",Math.round(Math.abs(e.value)),"% (",Math.round(a.doublesLevels[e.payload.x]*-e.value/100),"/",a.doublesLevels[e.payload.x],")")})))}}),c.a.createElement(Ct.k,{dataKey:"x"}),c.a.createElement(Ct.l,{tickFormatter:function(e){return"".concat(Math.round(e),"%")},width:40}),c.a.createElement(Ct.a,{dataKey:"S-SSS",fill:"#ffd700",stackId:"stack"}),c.a.createElement(Ct.a,{dataKey:"S-SS",fill:"#dab800",stackId:"stack"}),c.a.createElement(Ct.a,{dataKey:"S-S",fill:"#b19500",stackId:"stack"}),c.a.createElement(Ct.a,{dataKey:"S-A+",fill:"#396eef",stackId:"stack"}),c.a.createElement(Ct.a,{dataKey:"S-A",fill:"#828fb7",stackId:"stack"}),c.a.createElement(Ct.a,{dataKey:"S-B",fill:"#7a6490",stackId:"stack"}),c.a.createElement(Ct.a,{dataKey:"S-C",fill:"#6d5684",stackId:"stack"}),c.a.createElement(Ct.a,{dataKey:"S-D",fill:"#5d4e6d",stackId:"stack"}),c.a.createElement(Ct.a,{dataKey:"S-F",fill:"#774949",stackId:"stack"}),c.a.createElement(Ct.a,{dataKey:"D-SSS",fill:"#ffd700",stackId:"stack"}),c.a.createElement(Ct.a,{dataKey:"D-SS",fill:"#dab800",stackId:"stack"}),c.a.createElement(Ct.a,{dataKey:"D-S",fill:"#b19500",stackId:"stack"}),c.a.createElement(Ct.a,{dataKey:"D-A+",fill:"#396eef",stackId:"stack"}),c.a.createElement(Ct.a,{dataKey:"D-A",fill:"#828fb7",stackId:"stack"}),c.a.createElement(Ct.a,{dataKey:"D-B",fill:"#7a6490",stackId:"stack"}),c.a.createElement(Ct.a,{dataKey:"D-C",fill:"#6d5684",stackId:"stack"}),c.a.createElement(Ct.a,{dataKey:"D-D",fill:"#5d4e6d",stackId:"stack"}),c.a.createElement(Ct.a,{dataKey:"D-F",fill:"#774949",stackId:"stack"}),c.a.createElement(Ct.d,{value:"Double",offset:0,position:"insideBottomLeft"}),c.a.createElement(Ct.d,{value:"Single",offset:0,position:"insideTopLeft"}),c.a.createElement(Ct.h,{y:0,stroke:"#bbb"})))}},{key:"renderLevels",value:function(){var e=this.props,t=e.profile,a=e.tracklist;return c.a.createElement(Ct.i,{minHeight:void 0,aspect:1.6},c.a.createElement(Ct.b,{data:t.levelsDistribution,stackOffset:"sign",margin:{top:5,bottom:5,right:5,left:0}},c.a.createElement(Ct.j,{isAnimationActive:!1,content:function(e){e.active;var t=e.payload;e.label;if(!t||!t[0])return null;var r=a.doublesLevels[t[0].payload.x],n=a.singlesLevels[t[0].payload.x];return c.a.createElement("div",{className:"history-tooltip"},c.a.createElement("div",null,"Level: ",t[0].payload.x),n>0&&c.a.createElement("div",{style:{fontWeight:"bold",color:t[1].color}},"Single: ",Math.abs(t[1].value).toFixed(1),"% (",Math.round(t[1].value*n/100),"/",n,")"),r>0&&c.a.createElement("div",{style:{fontWeight:"bold",color:t[0].color}},"Double: ",Math.abs(t[0].value).toFixed(1),"% (",Math.round(Math.abs(t[0].value)*r/100),"/",r,")"))}}),c.a.createElement(Ct.k,{dataKey:"x"}),c.a.createElement(Ct.l,{tickFormatter:function(e){return Math.abs(e)+"%"},width:40}),c.a.createElement(Ct.j,null),c.a.createElement(Ct.h,{y:0,stroke:"#555"}),c.a.createElement(Ct.e,null),c.a.createElement(Ct.a,{dataKey:"D",fill:"#169c16",stackId:"stack"}),c.a.createElement(Ct.a,{dataKey:"S",fill:"#af2928",stackId:"stack"})))}},{key:"renderGradeBlock",value:function(e,t){var a=this.props.profile.progress[e],r="double"===e?"D":"S",n=Math.floor(100*(a["".concat(t,"-bonus-level-coef")]||0)),l=a["".concat(t,"-bonus-level-min-number")],s=a["".concat(t,"-bonus-level-achieved-number")],i=a["".concat(t,"-bonus-level")]?"".concat(r).concat(a["".concat(t,"-bonus-level")]):"?";return c.a.createElement("div",{className:"grade-block"},c.a.createElement("div",{className:"grade-letter"},c.a.createElement("img",{src:"".concat("/piu-spy-web","/grades/").concat(t,".png"),alt:t})),c.a.createElement("div",{className:"grade-level"},i),c.a.createElement("div",{className:"grade-progress"},n,"% (",s,"/",l,")"),c.a.createElement("div",{className:"grade-progress"},"\u0431\u043e\u043d\u0443\u0441: +",Math.floor(a["".concat(t,"-bonus")])),c.a.createElement("div",{className:S()("progress-background",{complete:100===n,zero:0===n}),style:{height:"".concat(n,"%")}}))}},{key:"render",value:function(){var e=this,t=this.props,a=t.isLoading,r=t.profile,n=t.error,l=t.filter,s=this.state.isLevelGraphCombined;return p.a.isEmpty(r)?null:c.a.createElement("div",{className:"profile-page"},c.a.createElement("div",{className:"content"},n&&n.message,c.a.createElement("div",{className:"top-controls"},c.a.createElement("div",{className:"_flex-fill"}),c.a.createElement("button",{disabled:a,className:"btn btn-sm btn-dark btn-icon",onClick:this.onRefresh},c.a.createElement(D.m,null)," \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c")),a&&c.a.createElement(B,null),!a&&c.a.createElement("div",{className:"profile"},c.a.createElement("div",{className:"profile-header"},c.a.createElement("div",{className:"profile-name text-with-header"},c.a.createElement("div",{className:"text-header"},"\u0438\u0433\u0440\u043e\u043a"),c.a.createElement("div",null,r.player.nickname)),c.a.createElement("div",{className:"text-with-header"},c.a.createElement("div",{className:"text-header"},"\u0440\u0430\u043d\u043a"),c.a.createElement("div",null,"#",r.player.rank)),c.a.createElement("div",{className:"text-with-header"},c.a.createElement("div",{className:"text-header"},"\u044d\u043b\u043e"),c.a.createElement("div",null,r.player.ranking.rating)),c.a.createElement("div",{className:"text-with-header"},c.a.createElement("div",{className:"text-header"},"\u043f\u043e\u0441\u043b\u0435\u0434\u043d\u044f\u044f \u0438\u0433\u0440\u0430"),c.a.createElement("div",null,r.lastResultDate?ot(r.lastResultDate):"\u043d\u0438\u043a\u043e\u0433\u0434\u0430"))),c.a.createElement("div",{className:"profile-section-horizontal-container"},c.a.createElement("div",{className:"profile-section"},c.a.createElement("div",{className:"profile-section-content"},s?c.a.createElement("div",{className:"profile-section-2"},c.a.createElement("div",{className:"profile-sm-section-header flex"},c.a.createElement("span",null,"\u043e\u0446\u0435\u043d\u043a\u0438"),c.a.createElement("div",{className:"toggle-holder"},c.a.createElement(G,{className:"combine-toggle",checked:s,onChange:function(){return e.setState(function(e){return{isLevelGraphCombined:!e.isLevelGraphCombined}})}},"\u043e\u0431\u044a\u0435\u0434\u0438\u043d\u0438\u0442\u044c \u0433\u0440\u0430\u0444\u0438\u043a\u0438"))),c.a.createElement("div",{className:"chart-container single-double-labels"},this.renderGradesWithLevels())):c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"profile-section-2"},c.a.createElement("div",{className:"profile-sm-section-header flex"},c.a.createElement("span",null,"\u0443\u0440\u043e\u0432\u043d\u0438"),c.a.createElement("div",{className:"toggle-holder"},c.a.createElement(G,{className:"combine-toggle",checked:s,onChange:function(){return e.setState(function(e){return{isLevelGraphCombined:!e.isLevelGraphCombined}})}},"\u043e\u0431\u044a\u0435\u0434\u0438\u043d\u0438\u0442\u044c \u0433\u0440\u0430\u0444\u0438\u043a\u0438"))),c.a.createElement("div",{className:"chart-container"},this.renderLevels())),c.a.createElement("div",{className:"profile-section-2"},c.a.createElement("div",{className:"profile-sm-section-header"},c.a.createElement("span",null,"\u043e\u0446\u0435\u043d\u043a\u0438")),c.a.createElement("div",{className:"chart-container"},this.renderGrades()))))),c.a.createElement("div",{className:"profile-section"},c.a.createElement("div",{className:"profile-section-content"},c.a.createElement("div",{className:"profile-section-2"},c.a.createElement("div",{className:"profile-sm-section-header"},c.a.createElement("span",null,"\u044d\u043b\u043e")),c.a.createElement("div",{className:"chart-container"},this.renderRankingHistory())),c.a.createElement("div",{className:"profile-section-2"},c.a.createElement("div",{className:"profile-sm-section-header"},c.a.createElement("span",null,"\u043c\u0435\u0441\u0442\u043e \u0432 \u0442\u043e\u043f\u0435")),c.a.createElement("div",{className:"chart-container"},this.renderPlaceHistory()))),c.a.createElement("div",{className:"range-container"},c.a.createElement(U,{range:l.dayRange||r.minMaxRange,min:r.minMaxRange[0],max:r.minMaxRange[1],onChange:this.onChangeDayRange})))),c.a.createElement("div",{className:"profile-section progress-section"},c.a.createElement("div",{className:"profile-sm-section-header"},c.a.createElement("span",null,"\u0430\u0447\u0438\u0432\u043a\u0438 \u043f\u043e \u0443\u0440\u043e\u0432\u043d\u044f\u043c")),c.a.createElement("div",{className:"progress-blocks-single-double"},c.a.createElement("div",{className:"progress-block"},c.a.createElement("div",{className:"achievements-grades single"},this.renderGradeBlock("single","A"),this.renderGradeBlock("single","A+"),this.renderGradeBlock("single","S"),this.renderGradeBlock("single","SS"))),c.a.createElement("div",{className:"progress-block"},c.a.createElement("div",{className:"achievements-grades double"},this.renderGradeBlock("double","A"),this.renderGradeBlock("double","A+"),this.renderGradeBlock("double","S"),this.renderGradeBlock("double","SS")))),c.a.createElement("div",{className:"bonus-faq"},"* \u0441\u0443\u043c\u043c\u0430\u0440\u043d\u044b\u0439 \u0431\u043e\u043d\u0443\u0441 (+",Math.round(r.progress.bonus),") \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043a \u0441\u0442\u0430\u0440\u0442\u043e\u0432\u043e\u043c\u0443 \u042d\u043b\u043e",c.a.createElement("br",null),"* \u0434\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0430\u0447\u0438\u0432\u043a\u0438 \u043d\u0443\u0436\u043d\u043e \u0441\u044b\u0433\u0440\u0430\u0442\u044c \u043e\u043a\u043e\u043b\u043e 10% \u0432\u0441\u0435\u0445 \u0447\u0430\u0440\u0442\u043e\u0432 \u0434\u0430\u043d\u043d\u043e\u0433\u043e \u043b\u0435\u0432\u0435\u043b\u0430 \u043d\u0430 \u043d\u0443\u0436\u043d\u044b\u0439 \u0433\u0440\u0435\u0439\u0434")))))}}]),t}(n.Component);Tt.defaultProps={profile:{}};var Bt=Object(o.b)(function(e,t){return{profile:Ft(e,t),tracklist:e.tracklist.data,filter:e.profiles.filter,error:e.top.error,isLoading:e.top.isLoading}},_t)(Object(E.f)(Tt)),Kt=(a(438),function(e){function t(){return Object(f.a)(this,t),Object(h.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){return c.a.createElement("header",{className:"top-bar"},c.a.createElement("nav",null,c.a.createElement("ul",null,c.a.createElement("li",null,c.a.createElement(i.c,{exact:!0,to:y.leaderboard.path},"leaderboard")),c.a.createElement("li",null,c.a.createElement(i.c,{exact:!0,to:y.ranking.path},"ranking")))))}}]),t}(n.Component)),Gt=function(e){function t(){return Object(f.a)(this,t),Object(h.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){return c.a.createElement("div",{className:"container"},c.a.createElement(Kt,null),c.a.createElement(E.b,{exact:!0,path:"/",render:function(){return c.a.createElement(E.a,{to:y.leaderboard.path})}}),c.a.createElement(E.b,{path:y.leaderboard.path,component:Nt}),c.a.createElement(E.b,{path:y.ranking.path,component:Dt}),c.a.createElement(E.b,{path:y.profile.path,component:Bt}))}}]),t}(n.Component),qt=a(51),Ht=a(127);function Vt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}function Wt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Vt(a,!0).forEach(function(t){Object(r.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Vt(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var Ut="TRACKLIST/LOADING",Jt="TRACKLIST/SUCCESS",Qt="TRACKLIST/ERROR",zt={isLoading:!1,data:[]};var Yt=Object(qt.c)({presets:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ge,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Te:var a=p.a.find({name:p.a.get("name",e.currentPreset)},t.presets);return Fe({},e,{currentPreset:qe(a)||null,presets:p.a.map(qe,t.presets)});case _e:return Fe({},e,{currentPreset:qe(t.currentPreset)});case Be:return Fe({},e,{isLoading:!0});case Ke:return Fe({},e,{isLoading:!1});default:return e}},profiles:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ve,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case fe:return pe({},e,{data:t.data});case ge:return pe({},e,{filter:t.filter});case he:return pe({},e,{filter:be});default:return e}},ranking:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ne:return re({},e,{data:t.ranking});case ce:var a=!p.a.isEmpty(t.listPrev);return re({},e,{data:p.a.map(function(e){var r=re({},e,{prevRating:p.a.get(e.name,t.rankingsPointsMap)});return a?p.a.includes(r.name,t.listPrev)?p.a.includes(r.name,t.listNow)?re({},r,{change:p.a.indexOf(r.name,t.listPrev)-p.a.indexOf(r.name,t.listNow)}):re({},r,{change:"?"}):re({},r,{change:"NEW"}):r},e.data)});default:return e}},top:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Re,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case je:return Se({},e,{isLoading:!0});case Pe:return Se({},e,{isLoading:!1,error:t.error});case we:return Se({},e,{isLoading:!1,data:t.data,players:t.players});case xe:return Se({},e,{filter:t.filter});case De:return Se({},e,{filter:Ce});default:return e}},tracklist:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:zt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ut:return Wt({},e,{isLoading:!0});case Qt:return Wt({},e,{isLoading:!1,error:t.error});case Jt:return Wt({},e,{isLoading:!1,data:t.data});default:return e}}}),Xt=Object(qt.e)(Yt,(window.__REDUX_DEVTOOLS_EXTENSION__,Object(qt.a)(Ht.a)));function Zt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}function $t(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Zt(a,!0).forEach(function(t){Object(r.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Zt(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}m.a.getItem("filter").then(function(e){e&&Xt.dispatch(Le($t({},e,{chartRange:e.chartRange&&$t({},e.chartRange,{range:p.a.every(function(e){return e>=Q[0]&&e<=Q[1]},e.chartRange.range)?e.chartRange.range:Q})})))}).catch(function(e){return console.error("Cannot get filter from local storage",e)}),Xt.dispatch(function(){var e=Object($.a)(X.a.mark(function e(t){var a;return X.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:Ut}),e.prev=1,e.next=4,ee({url:"".concat(Ne,"/tracklist/stats/XX")});case 4:return a=e.sent,t({type:Jt,data:a}),e.abrupt("return",a);case 9:return e.prev=9,e.t0=e.catch(1),t({type:Qt,error:e.t0}),e.abrupt("return",null);case 13:case"end":return e.stop()}},e,null,[[1,9]])}));return function(t){return e.apply(this,arguments)}}()).then(function(){Xt.dispatch(Ie())}),s.a.render(c.a.createElement(o.a,{store:Xt},c.a.createElement(i.a,null,c.a.createElement(Gt,null))),document.getElementById("root"))}},[[218,1,2]]]);
//# sourceMappingURL=main.2ce2e441.chunk.js.map