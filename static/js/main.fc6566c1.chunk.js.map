{"version":3,"sources":["components/Shared/Overlay/Overlay.js","components/Shared/ToggleButton/ToggleButton.js","components/Shared/Input/Input.js","components/Shared/Toggle/Toggle.js","components/Shared/CollapsibleBar/index.js","utils/fetch.js","reducers/top.js","utils/colors.js","components/Rankings/Rankings.js","constants/backend.js","components/App.js","reducers/index.js","index.js"],"names":["POPPER_MODIFIERS","preventOverflow","enabled","padding","boundariesElement","PLACEMENT_ARROW_MAPPING","right","left","top","bottom","getArrowPlacement","placement","split","Overlay","state","isVisible","containerItemRef","React","createRef","renderPopper","bind","toggleOverlayVisibility","this","setState","event","target","closest","hideOverlay","ref","style","arrowProps","outOfBoundaries","scheduleUpdate","props","children","hideWhenOutOfBounds","data-placement","className","classNames","overlayClassName","overlayItem","Fragment","onClick","ReactDOM","createPortal","container","document","body","modifiers","referenceElement","current","PureComponent","defaultTypes","listensToClickOutside","ToggleButton","active","onToggle","text","Input","value","_","isNil","defaultValue","bindAll","prevProps","e","newValue","onChange","type","numericValue","Number","min","max","onBlur","omit","handleBlur","onInput","handleChange","Component","defaultProps","noop","Toggle","checked","id","uniqueId","htmlFor","CollapsibleBar","open","defaultOpen","title","fetchJson","a","url","fetch","response","status","json","data","Error","console","error","Promise","reject","LOADING","SUCCESS","ERROR","initialState","isLoading","transformBackendData","flow","get","values","map","item","song","track","chartLabel","chart_label","chartLevel","slice","chartType","mix","results","res","index","perfects","Math","sqrt","toInteger","acc","floor","greats","goods","misses","bads","nickname","date","gained","dateObject","Date","grade","isExactDate","exact_gain_date","score","perfect","great","good","bad","miss","combo","max_combo","mods","mods_list","isRank","rank_mode","accuracy","latestScoreDate","reduce","latest","hasRankScore","some","orderBy","colorsArray","TimeAgo","addLocale","ru","timeAgo","timeStyle","flavour","gradation","convenient","units","tooltipFormatterForBests","display","alignItems","flexDirection","toLocaleDateString","nowDate","SORT","sortingOptions","label","chartMinMax","getFilteredData","filter","names","players","namesOr","playersOr","namesNot","playersNot","sortingType","protagonist","excludeAntagonists","defaultSorting","sortingFunctions","row","includes","protIndex","findIndex","protScore","enemies","take","uniqBy","remove","distanceFromProtagonist","dist","enemy","compact","chartRange","items","rows","range","getOr","filterCharts","showRank","showOnlyRank","showRankAndNorank","occuredNames","alreadyOccured","push","length","rowNames","every","name","size","matchSorter","keys","topPlace","occuredNicknames","isSecondOccurenceInResults","ChartFilter","filterValue","buttonText","t","step","r","renderTrack","onMouseDown","onTouchStart","height","width","borderRadius","background","getTrackBackground","colors","alignSelf","renderThumb","isDragged","backgroundColor","justifyContent","boxShadow","newMin","newMax","playersSelector","createSelector","flatMap","uniq","sortBy","toLower","defaultFilter","mapDispatchToProps","fetchTopScores","dispatch","TopScores","showItemsCount","setFilter","curry","localForage","setItem","onRefresh","getItem","then","catch","warn","placeholder","disabled","closeMenuOnSelect","classNamePrefix","isMulti","options","clearable","filteredData","canShowMore","visibleData","uniqueSelectedNames","message","renderSimpleSearch","renderFilters","renderSortings","isEmpty","chart","chartIndex","key","single","nameIndex","indexOf","empty","fontWeight","color","toFixed","vj","content","tooltipClassName","numeral","format","src","process","alt","strTimeAgo","dayDiff","moment","startOf","diff","getTimeAgo","connect","App","exact","path","component","Rankings","rootReducer","combineReducers","action","store","createStore","window","__REDUX_DEVTOOLS_EXTENSION__","compose","applyMiddleware","thunk","stateSanitizer","render","getElementById"],"mappings":"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","file":"static/js/main.fc6566c1.chunk.js","sourcesContent":["import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport toBe from 'prop-types';\r\nimport { Popper } from 'react-popper';\r\nimport classNames from 'classnames';\r\nimport listensToClickOutside from 'react-onclickoutside';\r\n\r\nimport './overlay.scss';\r\n\r\nconst POPPER_MODIFIERS = {\r\n  preventOverflow: {\r\n    enabled: true,\r\n    padding: 10,\r\n    boundariesElement: 'viewport',\r\n  },\r\n};\r\n\r\nconst PLACEMENT_ARROW_MAPPING = {\r\n  right: 'left',\r\n  left: 'right',\r\n  top: 'bottom',\r\n  bottom: 'top',\r\n};\r\n\r\nconst getArrowPlacement = placement => {\r\n  return placement && PLACEMENT_ARROW_MAPPING[placement.split('-')[0]];\r\n};\r\n\r\nclass Overlay extends React.PureComponent {\r\n  static propTypes = {\r\n    placement: toBe.string,\r\n    overlayItem: toBe.any,\r\n    hideWhenOutOfBounds: toBe.bool,\r\n  };\r\n\r\n  static defaultTypes = {\r\n    placement: 'bottom',\r\n  };\r\n\r\n  constructor() {\r\n    super();\r\n    this.state = {\r\n      isVisible: false,\r\n    };\r\n    this.containerItemRef = React.createRef();\r\n    this.renderPopper = this.renderPopper.bind(this);\r\n    this.toggleOverlayVisibility = this.toggleOverlayVisibility.bind(this);\r\n  }\r\n\r\n  hideOverlay() {\r\n    this.setState({\r\n      isVisible: false,\r\n    });\r\n  }\r\n\r\n  toggleOverlayVisibility() {\r\n    this.setState({\r\n      isVisible: !this.state.isVisible,\r\n    });\r\n  }\r\n\r\n  handleClickOutside(event) {\r\n    const preventHiding = event && event.target.closest('.inner-popper-overlay'); // prevent overlays from hiding when a modal is opened within overlay\r\n\r\n    if (!preventHiding) {\r\n      this.hideOverlay();\r\n    }\r\n  }\r\n\r\n  renderPopper({ ref, style, placement, arrowProps, scheduleUpdate, outOfBoundaries }) {\r\n    const { children, hideWhenOutOfBounds } = this.props;\r\n    return (\r\n      <div\r\n        ref={ref}\r\n        style={style}\r\n        data-placement={placement}\r\n        className={classNames(\r\n          'inner-popper-overlay',\r\n          `arrow-${getArrowPlacement(placement)}`,\r\n          this.props.overlayClassName,\r\n          { 'out-of-bounds': outOfBoundaries && hideWhenOutOfBounds }\r\n        )}\r\n      >\r\n        <div className=\"arrow-hider\">\r\n          <div className=\"arrow\" ref={arrowProps.ref} style={arrowProps.style} />\r\n        </div>\r\n        <div\r\n          className=\"inner-popper-content\"\r\n          // ref={ref => this.setupPopperContentRef(scheduleUpdate, ref)}\r\n        >\r\n          {children}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  render() {\r\n    const { placement, overlayItem } = this.props;\r\n    const { isVisible } = this.state;\r\n    return (\r\n      <React.Fragment>\r\n        <div\r\n          className=\"overlay-item\"\r\n          ref={this.containerItemRef}\r\n          onClick={this.toggleOverlayVisibility}\r\n        >\r\n          {overlayItem}\r\n        </div>\r\n        {isVisible &&\r\n          ReactDOM.createPortal(\r\n            <Popper\r\n              container={document.body}\r\n              modifiers={POPPER_MODIFIERS}\r\n              placement={placement}\r\n              referenceElement={this.containerItemRef.current}\r\n            >\r\n              {this.renderPopper}\r\n            </Popper>,\r\n            document.body\r\n          )}\r\n      </React.Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nexport default listensToClickOutside(Overlay);\r\n","import React from 'react';\r\nimport toBe from 'prop-types';\r\nimport classNames from 'classnames';\r\n\r\nimport './toggle-button.scss';\r\n\r\nexport default class ToggleButton extends React.PureComponent {\r\n  static propTypes = {\r\n    text: toBe.string,\r\n    onToggle: toBe.func,\r\n    active: toBe.bool,\r\n  };\r\n\r\n  render() {\r\n    const { active, onToggle, text } = this.props;\r\n    return (\r\n      <div\r\n        className={classNames('toggle-button', { active: active })}\r\n        onClick={() => onToggle(!active)}\r\n      >\r\n        {text}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","/* eslint-disable react/no-deprecated */\r\n// imports from vendor deps\r\nimport React from 'react';\r\nimport toBe from 'prop-types';\r\nimport classNames from 'classnames';\r\nimport _ from 'lodash/fp';\r\n\r\n// imports from styles\r\nexport default class Input extends React.Component {\r\n  static propTypes = {\r\n    value: toBe.any,\r\n    defaultValue: toBe.any,\r\n    onChange: toBe.func,\r\n    onBlur: toBe.func,\r\n    type: toBe.string,\r\n    className: toBe.string,\r\n    trimOnBlur: toBe.bool,\r\n  };\r\n\r\n  static defaultProps = {\r\n    value: null,\r\n    type: 'text',\r\n    onChange: _.noop,\r\n    onBlur: _.noop,\r\n  };\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      value: (!_.isNil(props.value) ? props.value : props.defaultValue) || '',\r\n    };\r\n    _.bindAll(['handleChange', 'handleBlur'], this);\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    if (prevProps.value !== this.props.value) {\r\n      this.setState({ value: this.props.value });\r\n    }\r\n  }\r\n\r\n  handleChange(e) {\r\n    const newValue = e.target.value;\r\n    this.setState({ value: newValue }, () => this.props.onChange(newValue));\r\n  }\r\n\r\n  handleBlur(e) {\r\n    const { type } = this.props;\r\n    const { value } = this.state;\r\n    if (type === 'number') {\r\n      const numericValue = Number(value);\r\n      if (numericValue >= Number(e.target.min) && numericValue <= Number(e.target.max)) {\r\n        this.props.onBlur(numericValue, e);\r\n      } else {\r\n        this.setState({ value: this.props.value });\r\n        this.props.onBlur(this.props.value, e);\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const { className } = this.props;\r\n\r\n    // HACK: This component uses onInput instead of onChange\r\n    // because IE11 fails to call onChange events when you paste/cut using context menu (RMB)\r\n    // We're using onInput because it works fine, and because for text input\r\n    // there's no difference between how onChange and onInput work\r\n    return (\r\n      <input\r\n        {..._.omit(['defaultValue', 'onChange'], this.props)}\r\n        className={classNames(className, 'text-input')}\r\n        value={this.state.value}\r\n        onBlur={this.handleBlur}\r\n        onInput={this.handleChange}\r\n      />\r\n    );\r\n  }\r\n}\r\n","import React from 'react';\r\nimport _ from 'lodash/fp';\r\n\r\nimport './toggle.scss';\r\n\r\n// imports from styles\r\nexport default class Toggle extends React.Component {\r\n  constructor() {\r\n    super();\r\n    this.id = _.uniqueId();\r\n  }\r\n\r\n  onChange = e => {\r\n    this.props.onChange(e.target.checked);\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"toggle-checkbox\">\r\n        <input\r\n          type=\"checkbox\"\r\n          className=\"toggle-checkbox-cb\"\r\n          id={this.id}\r\n          onChange={this.onChange}\r\n          checked={this.props.checked}\r\n        />\r\n        <label htmlFor={this.id} className=\"toggle\">\r\n          <span></span>\r\n        </label>\r\n        <label htmlFor={this.id} className=\"text-label\">\r\n          {this.props.children}\r\n        </label>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React, { PureComponent } from 'react';\r\nimport toBe from 'prop-types';\r\nimport { FaChevronRight } from 'react-icons/fa';\r\nimport classNames from 'classnames';\r\n\r\nimport './styles.scss';\r\n\r\nexport default class CollapsibleBar extends PureComponent {\r\n  static propTypes = {\r\n    className: toBe.string,\r\n    children: toBe.any,\r\n    title: toBe.any,\r\n    defaultOpen: toBe.bool,\r\n  };\r\n\r\n  constructor(props) {\r\n    super();\r\n    this.state = { open: props.defaultOpen || false };\r\n  }\r\n\r\n  render() {\r\n    const { children, title, className } = this.props;\r\n    const { open } = this.state;\r\n\r\n    return (\r\n      <div className={classNames('collapsible-bar', className, { open })}>\r\n        <div className=\"header\" onClick={() => this.setState(state => ({ open: !state.open }))}>\r\n          <div className=\"collapse-button\">\r\n            <FaChevronRight />\r\n          </div>\r\n          <div className=\"title\">{title}</div>\r\n        </div>\r\n        {children && <div className=\"collapsible-children\">{children}</div>}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","export const fetchJson = async ({ url }) => {\r\n  try {\r\n    const response = await fetch(url);\r\n    if (response.status >= 200 && response.status < 300) {\r\n      const data = await response.json();\r\n      return data;\r\n    } else {\r\n      throw Error('HTTP Status ' + response.status);\r\n    }\r\n  } catch (error) {\r\n    console.error(error);\r\n    return Promise.reject(error);\r\n  }\r\n};\r\n","import _ from 'lodash/fp';\r\n\r\nimport { fetchJson } from 'utils/fetch';\r\n\r\nimport { HOST } from 'constants/backend';\r\n\r\nconst LOADING = `TOP/LOADING`;\r\nconst SUCCESS = `TOP/SUCCESS`;\r\nconst ERROR = `TOP/ERROR`;\r\n\r\nconst initialState = {\r\n  isLoading: false,\r\n  data: [],\r\n};\r\n\r\nconst transformBackendData = _.flow(\r\n  _.get('top'),\r\n  _.values,\r\n  _.map(item => ({\r\n    song: item.track,\r\n    chartLabel: item.chart_label,\r\n    chartLevel: item.chart_label.slice(1),\r\n    chartType: item.chart_label.slice(0, 1),\r\n    mix: item.mix,\r\n    results: item.results.map((res, index) => {\r\n      const perfects = (Math.sqrt(res.perfects) * _.toInteger(item.chart_label.slice(1))) / 2;\r\n      const acc =\r\n        Math.floor(\r\n          ((perfects * 100 + res.greats * 60 + res.goods * 30 + res.misses * -20) /\r\n            (perfects + res.greats + res.goods + res.bads + res.misses)) *\r\n            100\r\n        ) / 100;\r\n      return {\r\n        nickname: res.nickname,\r\n        date: res.gained,\r\n        dateObject: new Date(res.gained),\r\n        grade: res.grade,\r\n        isExactDate: !!res.exact_gain_date,\r\n        score: res.score,\r\n        perfect: res.perfects,\r\n        great: res.greats,\r\n        good: res.goods,\r\n        bad: res.bads,\r\n        miss: res.misses,\r\n        combo: res.max_combo,\r\n        mods: res.mods_list,\r\n        isRank: !!res.rank_mode,\r\n        accuracy: !res.max_combo ? null : acc > 0 ? acc : 0,\r\n      };\r\n    }),\r\n  })),\r\n  _.map(song => {\r\n    return {\r\n      ...song,\r\n      latestScoreDate: song.results.reduce(\r\n        (latest, current) => (current.date > latest ? current.date : latest),\r\n        song.results[0].date\r\n      ),\r\n      results: song.results.map(res => ({\r\n        ...res,\r\n        hasRankScore: _.some({ nickname: res.nickname, isRank: true }, song.results),\r\n      })),\r\n    };\r\n  }),\r\n  _.orderBy(['latestScoreDate', 'song', 'chartLevel'], ['desc', 'asc', 'desc']),\r\n  // data => {\r\n  //   const playerScores = {};\r\n  //   const playerScoresCount = {};\r\n  //   data.forEach(song => {\r\n  //     const usedResults = [];\r\n  //     _.orderBy(['score'], ['desc'], song.results).forEach(score => {\r\n  //       if (!score.nickname.includes('???') && !_.some({ nickname: score.nickname }, usedResults)) {\r\n  //         usedResults.push(score);\r\n  //       }\r\n  //     });\r\n  //\r\n  //     usedResults.forEach((score, scoreIndex) => {\r\n  //       const enemyScores = usedResults.length > 1 ? usedResults.slice(scoreIndex + 1) : [];\r\n  //       enemyScores.forEach(enemyScore => {\r\n  //         // This is one match between two players\r\n  //         if (!playerScores[score.nickname]) {\r\n  //           playerScoresCount[score.nickname] = 1;\r\n  //         } else playerScoresCount[score.nickname] += 1;\r\n  //         if (!playerScores[enemyScore.nickname]) {\r\n  //           playerScoresCount[enemyScore.nickname] = 1;\r\n  //         } else playerScoresCount[enemyScore.nickname] += 1;\r\n  //         const r1 = playerScores[score.nickname]\r\n  //           ? playerScores[score.nickname]\r\n  //           : (playerScores[score.nickname] = 1000);\r\n  //         const r2 = playerScores[enemyScore.nickname]\r\n  //           ? playerScores[enemyScore.nickname]\r\n  //           : (playerScores[enemyScore.nickname] = 1000);\r\n  //         const R1 = 10 ** (r1 / 300);\r\n  //         const R2 = 10 ** (r2 / 300);\r\n  //         const E1 = R1 / (R1 + R2);\r\n  //         const E2 = R2 / (R1 + R2);\r\n  //         const A = score.score;\r\n  //         const B = enemyScore.score;\r\n  //         let S1 = (A / (A + B) - 0.5) * 10 + 0.5;\r\n  //         let S2 = (B / (A + B) - 0.5) * 10 + 0.5;\r\n  //         S1 = Math.max(0, Math.min(1, S1));\r\n  //         S2 = Math.max(0, Math.min(1, S2));\r\n  //         const K = song.chartLevel ** 2 / 2;\r\n  //         playerScores[score.nickname] = r1 + K * (S1 - E1);\r\n  //         playerScores[enemyScore.nickname] = r2 + K * (S2 - E2);\r\n  //       });\r\n  //     });\r\n  //   });\r\n  //   const arr = Object.keys(playerScores).map(key => ({\r\n  //     name: key,\r\n  //     score: Math.round(playerScores[key]),\r\n  //     count: playerScoresCount[key],\r\n  //   }));\r\n  //   console.log(_.orderBy(['score'], ['desc'], _.remove(i => i.count < 15, arr)));\r\n  //   return data;\r\n  // },\r\n  data => ({ data })\r\n);\r\n\r\nexport default function reducer(state = initialState, action) {\r\n  switch (action.type) {\r\n    case LOADING:\r\n      return {\r\n        ...state,\r\n        isLoading: true,\r\n      };\r\n    case ERROR:\r\n      return {\r\n        ...state,\r\n        isLoading: false,\r\n        error: action.error,\r\n      };\r\n    case SUCCESS:\r\n      return {\r\n        ...state,\r\n        isLoading: false,\r\n        ...transformBackendData(action.data),\r\n      };\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nexport const fetchTopScores = () => {\r\n  return async dispatch => {\r\n    dispatch({ type: LOADING });\r\n    try {\r\n      const data = await fetchJson({\r\n        url: `${HOST}/top`,\r\n      });\r\n      dispatch({ type: SUCCESS, data });\r\n      return data;\r\n    } catch (error) {\r\n      dispatch({ type: ERROR, error });\r\n    }\r\n  };\r\n};\r\n","export const colorsArray = [\r\n  '#FF6633',\r\n  '#66991A',\r\n  '#6666FF',\r\n  '#E6B333',\r\n  '#CC80CC',\r\n  '#E64D66',\r\n  '#4DB3FF',\r\n  '#99E6E6',\r\n  '#99FF99',\r\n  '#FFFF99',\r\n  '#FFB399',\r\n  '#809900',\r\n  '#00B3E6',\r\n  '#3366E6',\r\n  '#999966',\r\n  '#B34D4D',\r\n  '#80B300',\r\n  '#E6B3B3',\r\n  '#6680B3',\r\n  '#66664D',\r\n  '#FF99E6',\r\n  '#CCFF1A',\r\n  '#FF1A66',\r\n  '#33FFCC',\r\n  '#4D8000',\r\n  '#B33300',\r\n  '#991AFF',\r\n  '#E666FF',\r\n  '#1AB399',\r\n  '#E666B3',\r\n  '#33991A',\r\n  '#4D8066',\r\n  '#CC9999',\r\n  '#B3B31A',\r\n  '#00E680',\r\n  '#E6331A',\r\n  '#809980',\r\n  '#E6FF80',\r\n  '#1AFF33',\r\n  '#999933',\r\n  '#FF3380',\r\n  '#CCCC00',\r\n  '#66E64D',\r\n  '#4D80CC',\r\n  '#9900B3',\r\n  '#4DB380',\r\n  '#FF4D4D',\r\n];\r\n","import React, { Component } from 'react';\r\nimport toBe from 'prop-types';\r\nimport { connect } from 'react-redux';\r\nimport matchSorter from 'match-sorter';\r\nimport { Range, getTrackBackground } from 'react-range';\r\nimport _ from 'lodash/fp';\r\nimport { createSelector } from 'reselect';\r\nimport Select from 'react-select';\r\nimport classNames from 'classnames';\r\nimport numeral from 'numeral';\r\nimport localForage from 'localforage';\r\nimport TimeAgo from 'javascript-time-ago';\r\nimport ru from 'javascript-time-ago/locale/ru';\r\nimport { convenient } from 'javascript-time-ago/gradation';\r\nimport Tooltip from 'react-responsive-ui/modules/Tooltip';\r\nimport moment from 'moment';\r\nimport { FaRedoAlt, FaCaretLeft, FaCaretRight, FaSearch } from 'react-icons/fa';\r\n\r\nimport Overlay from 'components/Shared/Overlay/Overlay';\r\nimport ToggleButton from 'components/Shared/ToggleButton/ToggleButton';\r\nimport Input from 'components/Shared/Input/Input';\r\nimport Toggle from 'components/Shared/Toggle/Toggle';\r\nimport CollapsibleBar from 'components/Shared/CollapsibleBar';\r\n\r\nimport 'react-responsive-ui/style.css';\r\nimport './rankings.scss';\r\n\r\nimport { fetchTopScores } from 'reducers/top';\r\n\r\nimport { colorsArray } from 'utils/colors';\r\n\r\nTimeAgo.addLocale(ru);\r\nconst timeAgo = new TimeAgo('ru-RU');\r\n\r\nconst timeStyle = {\r\n  flavour: 'long',\r\n  gradation: convenient,\r\n  units: ['day', 'week', 'month'],\r\n};\r\nconst tooltipFormatter = date => date.toLocaleDateString();\r\nconst tooltipFormatterForBests = date => (\r\n  <div style={{ display: 'flex', alignItems: 'center', flexDirection: 'column' }}>\r\n    <div>точная дата взятия неизвестна</div>\r\n    <div>скор был записан с my best или machine best</div>\r\n    <div>дата записи: {date.toLocaleDateString()}</div>\r\n  </div>\r\n);\r\n\r\nconst nowDate = new Date();\r\nconst getTimeAgo = date => {\r\n  const strTimeAgo = timeAgo.format(date, timeStyle);\r\n  if (!strTimeAgo) {\r\n    const dayDiff = moment(nowDate)\r\n      .startOf('day')\r\n      .diff(moment(date).startOf('day'), 'days');\r\n    return dayDiff === 0 ? 'сегодня' : dayDiff === 1 ? 'вчера' : '';\r\n  } else {\r\n    return strTimeAgo;\r\n  }\r\n};\r\n\r\nconst SORT = {\r\n  DEFAULT: 'default',\r\n  PROTAGONIST: 'protagonist',\r\n};\r\nconst sortingOptions = [\r\n  {\r\n    label: 'новизне скоров',\r\n    value: SORT.DEFAULT,\r\n  },\r\n  {\r\n    label: 'отставанию от остальных',\r\n    value: SORT.PROTAGONIST,\r\n  },\r\n];\r\n\r\nconst chartMinMax = [1, 28];\r\nconst filterCharts = (filter, rows) => {\r\n  const range = _.getOr(chartMinMax, 'range', filter);\r\n  const type = _.getOr(null, 'type', filter);\r\n\r\n  const filtered = _.flow(\r\n    _.filter(row => {\r\n      return (\r\n        row.chartLevel >= range[0] &&\r\n        row.chartLevel <= range[1] &&\r\n        (!type || type === row.chartType)\r\n      );\r\n    })\r\n  )(rows);\r\n  return filtered;\r\n};\r\n\r\nconst getFilteredData = (data, filter) => {\r\n  const names = _.map('value', filter.players);\r\n  const namesOr = _.map('value', filter.playersOr);\r\n  const namesNot = _.map('value', filter.playersNot);\r\n  const sortingType = _.get('value', filter.sortingType);\r\n  const protagonist = _.get('value', filter.protagonist);\r\n  const excludeAntagonists = _.map('value', filter.excludeAntagonists);\r\n\r\n  const defaultSorting = [_.orderBy(['latestScoreDate'], ['desc'])];\r\n  const sortingFunctions =\r\n    {\r\n      [SORT.DEFAULT]: defaultSorting,\r\n      [SORT.PROTAGONIST]: [\r\n        _.filter(row => _.map('nickname', row.results).includes(protagonist)),\r\n        _.map(row => {\r\n          const protIndex = _.findIndex({ nickname: protagonist }, row.results);\r\n          const protScore = row.results[protIndex].score;\r\n          const enemies = _.flow([\r\n            _.take(protIndex),\r\n            _.uniqBy('nickname'),\r\n            _.remove(res => excludeAntagonists.includes(res.nickname) || res.score === protScore),\r\n          ])(row.results);\r\n          const distance = Math.sqrt(\r\n            _.reduce((dist, enemy) => dist + (enemy.score / protScore - 0.99) ** 2, 0, enemies)\r\n          );\r\n          return {\r\n            ...row,\r\n            distanceFromProtagonist: distance,\r\n          };\r\n        }),\r\n        _.orderBy(['distanceFromProtagonist'], ['desc']),\r\n      ],\r\n    }[sortingType] || defaultSorting;\r\n\r\n  return _.flow(\r\n    _.compact([\r\n      filter.chartRange && (items => filterCharts(filter.chartRange, items)),\r\n      !filter.showRank &&\r\n        _.map(row => ({ ...row, results: _.filter(res => !res.isRank, row.results) })),\r\n      filter.showRank &&\r\n        filter.showOnlyRank &&\r\n        _.map(row => ({ ...row, results: _.filter(res => res.isRank, row.results) })),\r\n      filter.showRank &&\r\n        !filter.showOnlyRank &&\r\n        !filter.showRankAndNorank &&\r\n        _.map(row => {\r\n          const occuredNames = [];\r\n          return {\r\n            ...row,\r\n            results: _.filter(res => {\r\n              const alreadyOccured = occuredNames.includes(res.nickname);\r\n              occuredNames.push(res.nickname);\r\n              return !alreadyOccured;\r\n            }, row.results),\r\n          };\r\n        }),\r\n      (names.length || namesOr.length || namesNot.length) &&\r\n        _.filter(row => {\r\n          const rowNames = _.map('nickname', row.results);\r\n          return (\r\n            (!names.length || _.every(name => rowNames.includes(name), names)) &&\r\n            (!namesOr.length || _.some(name => rowNames.includes(name), namesOr)) &&\r\n            (!namesNot.length || !_.some(name => rowNames.includes(name), namesNot))\r\n          );\r\n        }),\r\n      _.filter(row => _.size(row.results)),\r\n      ...sortingFunctions,\r\n      filter.song && (items => matchSorter(items, filter.song, { keys: ['song'] })),\r\n      _.map(song => {\r\n        let topPlace = 1;\r\n        const occuredNicknames = [];\r\n        return {\r\n          ...song,\r\n          results: song.results.map((res, index) => {\r\n            const isSecondOccurenceInResults = occuredNicknames.includes(res.nickname);\r\n            occuredNicknames.push(res.nickname);\r\n            if (index === 0) {\r\n              topPlace = 1;\r\n            } else if (\r\n              !isSecondOccurenceInResults &&\r\n              res.score !== _.get([index - 1, 'score'], song.results)\r\n            ) {\r\n              topPlace += 1;\r\n            }\r\n            return {\r\n              ...res,\r\n              topPlace,\r\n              isSecondOccurenceInResults,\r\n            };\r\n          }),\r\n        };\r\n      }),\r\n    ])\r\n  )(data);\r\n};\r\n\r\nfunction ChartFilter({ filterValue, onChange }) {\r\n  const range = _.getOr(chartMinMax, 'range', filterValue);\r\n  const type = _.getOr(null, 'type', filterValue);\r\n  let buttonText = 'фильтр чартов';\r\n  if (filterValue) {\r\n    const t = type || '';\r\n    buttonText = range[0] === range[1] ? `${t}${range[0]}` : `${t}${range[0]} - ${t}${range[1]}`;\r\n    buttonText = 'чарты: ' + buttonText;\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <Overlay\r\n        overlayClassName=\"chart-range-overlay-outer\"\r\n        overlayItem={\r\n          <button className=\"filter-charts-button btn btn-sm btn-dark\">{buttonText}</button>\r\n        }\r\n      >\r\n        <div className=\"chart-range-overlay\">\r\n          <div className=\"buttons\">\r\n            <ToggleButton\r\n              text=\"S\"\r\n              active={!type || type === 'S'}\r\n              onToggle={active => {\r\n                onChange({\r\n                  range,\r\n                  type: !active ? 'D' : null,\r\n                });\r\n              }}\r\n            />\r\n            <ToggleButton\r\n              text=\"D\"\r\n              active={!type || type === 'D'}\r\n              onToggle={active => {\r\n                onChange({\r\n                  range,\r\n                  type: !active ? 'S' : null,\r\n                });\r\n              }}\r\n            />\r\n          </div>\r\n          <Range\r\n            values={range}\r\n            step={1}\r\n            min={chartMinMax[0]}\r\n            max={chartMinMax[1]}\r\n            onChange={r => onChange({ type, range: r })}\r\n            renderTrack={({ props, children }) => (\r\n              <div\r\n                onMouseDown={props.onMouseDown}\r\n                onTouchStart={props.onTouchStart}\r\n                style={{\r\n                  ...props.style,\r\n                  height: '10px',\r\n                  display: 'flex',\r\n                  width: '100%',\r\n                }}\r\n              >\r\n                <div\r\n                  ref={props.ref}\r\n                  style={{\r\n                    height: '6px',\r\n                    width: '100%',\r\n                    borderRadius: '3px',\r\n                    background: getTrackBackground({\r\n                      values: range,\r\n                      colors: ['#ccc', '#337ab7', '#ccc'],\r\n                      min: chartMinMax[0],\r\n                      max: chartMinMax[1],\r\n                    }),\r\n                    alignSelf: 'center',\r\n                  }}\r\n                >\r\n                  {children}\r\n                </div>\r\n              </div>\r\n            )}\r\n            renderThumb={({ props, isDragged }) => (\r\n              <div\r\n                {...props}\r\n                style={{\r\n                  ...props.style,\r\n                  height: '12px',\r\n                  width: '12px',\r\n                  borderRadius: '6px',\r\n                  backgroundColor: '#FFF',\r\n                  display: 'flex',\r\n                  justifyContent: 'center',\r\n                  alignItems: 'center',\r\n                  boxShadow: '0px 2px 3px #AAA',\r\n                }}\r\n              >\r\n                <div\r\n                  style={{\r\n                    height: '6px',\r\n                    width: '6px',\r\n                    borderRadius: '3px',\r\n                    backgroundColor: isDragged ? '#337ab7' : '#CCC',\r\n                  }}\r\n                />\r\n              </div>\r\n            )}\r\n          />\r\n          <div className=\"inputs\">\r\n            <button\r\n              className=\"btn btn-sm btn-dark\"\r\n              onClick={() =>\r\n                onChange({\r\n                  type,\r\n                  range: [Math.max(range[0] - 1, chartMinMax[0]), range[1]],\r\n                })\r\n              }\r\n            >\r\n              <FaCaretLeft />\r\n            </button>\r\n            <Input\r\n              type=\"number\"\r\n              className=\"form-control\"\r\n              min={chartMinMax[0]}\r\n              max={Math.min(chartMinMax[1], range[1])}\r\n              value={range[0]}\r\n              onBlur={value => {\r\n                onChange({ type, range: [value, range[1]] });\r\n              }}\r\n            />\r\n            <button\r\n              className=\"btn btn-sm btn-dark\"\r\n              onClick={() => {\r\n                const newMin = Math.min(range[0] + 1, chartMinMax[1]);\r\n                onChange({\r\n                  type,\r\n                  range: [newMin, range[1] < newMin ? newMin : range[1]],\r\n                });\r\n              }}\r\n            >\r\n              <FaCaretRight />\r\n            </button>\r\n            <div className=\"_flex-fill\" />\r\n            <button\r\n              className=\"btn btn-sm btn-dark\"\r\n              onClick={() => {\r\n                const newMax = Math.max(range[1] - 1, chartMinMax[0]);\r\n                onChange({\r\n                  type,\r\n                  range: [range[0] > newMax ? newMax : range[0], newMax],\r\n                });\r\n              }}\r\n            >\r\n              <FaCaretLeft />\r\n            </button>\r\n            <Input\r\n              type=\"number\"\r\n              className=\"form-control\"\r\n              min={Math.max(chartMinMax[0], range[0])}\r\n              max={chartMinMax[1]}\r\n              value={range[1]}\r\n              onBlur={value => onChange({ type, range: [range[0], value] })}\r\n            />\r\n            <button\r\n              className=\"btn btn-sm btn-dark\"\r\n              onClick={() =>\r\n                onChange({\r\n                  type,\r\n                  range: [range[0], Math.min(range[1] + 1, chartMinMax[1])],\r\n                })\r\n              }\r\n            >\r\n              <FaCaretRight />\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </Overlay>\r\n    </div>\r\n  );\r\n}\r\n\r\nconst playersSelector = createSelector(\r\n  state => state.top.data,\r\n  _.flow(\r\n    _.flatMap(_.get('results')),\r\n    _.map('nickname'),\r\n    _.uniq,\r\n    _.sortBy(_.toLower),\r\n    _.map(name => ({ label: name, value: name }))\r\n  )\r\n);\r\n\r\nconst defaultFilter = { showRank: true };\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    players: playersSelector(state),\r\n    data: state.top.data,\r\n    error: state.top.error,\r\n    isLoading: state.top.isLoading,\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = {\r\n  fetchTopScores,\r\n};\r\n\r\nclass TopScores extends Component {\r\n  static propTypes = {\r\n    match: toBe.object,\r\n    data: toBe.array,\r\n    error: toBe.object,\r\n    isLoading: toBe.bool.isRequired,\r\n  };\r\n\r\n  state = { filter: defaultFilter, showItemsCount: 20 };\r\n\r\n  componentDidMount() {\r\n    const { isLoading } = this.props;\r\n    if (!isLoading) {\r\n      this.props.fetchTopScores();\r\n    }\r\n    localForage\r\n      .getItem('filter')\r\n      .then(\r\n        filter =>\r\n          filter &&\r\n          this.setState({\r\n            filter: {\r\n              ...filter,\r\n              chartRange: {\r\n                ...filter.chartRange,\r\n                range: _.every(\r\n                  r => r >= chartMinMax[0] && r <= chartMinMax[1],\r\n                  filter.chartRange.range\r\n                )\r\n                  ? filter.chartRange.range\r\n                  : chartMinMax,\r\n              },\r\n            },\r\n          })\r\n      )\r\n      .catch(error => console.warn('Cannot get filter from local storage', error));\r\n  }\r\n\r\n  setFilter = _.curry((name, value) => {\r\n    this.setState(\r\n      state => ({ filter: { ...state.filter, [name]: value } }),\r\n      () => {\r\n        localForage.setItem('filter', this.state.filter);\r\n      }\r\n    );\r\n  });\r\n\r\n  onRefresh = () => {\r\n    const { isLoading } = this.props;\r\n    if (!isLoading) {\r\n      this.props.fetchTopScores();\r\n    }\r\n  };\r\n\r\n  renderSimpleSearch() {\r\n    const { isLoading } = this.props;\r\n    return (\r\n      <div className=\"simple-search\">\r\n        <div className=\"song-name _margin-right _margin-bottom\">\r\n          <Input\r\n            value={this.state.filter.song || ''}\r\n            placeholder=\"название песни...\"\r\n            className=\"form-control\"\r\n            onChange={this.setFilter('song')}\r\n          />\r\n        </div>\r\n        <div className=\"chart-range _margin-right _margin-bottom\">\r\n          <ChartFilter\r\n            filterValue={this.state.filter.chartRange}\r\n            onChange={this.setFilter('chartRange')}\r\n          />\r\n        </div>\r\n        <div className=\"_flex-fill\" />\r\n        <div className=\"_flex-row _margin-bottom\">\r\n          <button\r\n            className=\"btn btn-sm btn-dark btn-icon _margin-right\"\r\n            onClick={() => this.setState({ filter: defaultFilter })}\r\n          >\r\n            <FaRedoAlt /> сбросить фильтры\r\n          </button>\r\n          <button\r\n            disabled={isLoading}\r\n            className=\"btn btn-sm btn-dark btn-icon\"\r\n            onClick={this.onRefresh}\r\n          >\r\n            <FaSearch /> обновить\r\n          </button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderFilters() {\r\n    const { players } = this.props;\r\n    const { filter } = this.state;\r\n\r\n    return (\r\n      <div className=\"filters\">\r\n        <div className=\"people-filters\">\r\n          <label className=\"label\">показывать чарты, которые сыграл:</label>\r\n          <div className=\"players-block\">\r\n            <div className=\"_margin-right\">\r\n              <label className=\"label\">каждый из этих</label>\r\n              <Select\r\n                closeMenuOnSelect={false}\r\n                className=\"select players\"\r\n                classNamePrefix=\"select\"\r\n                placeholder=\"игроки...\"\r\n                isMulti\r\n                options={players}\r\n                value={_.getOr(null, 'players', filter)}\r\n                onChange={this.setFilter('players')}\r\n              />\r\n            </div>\r\n            <div className=\"_margin-right\">\r\n              <label className=\"label\">и хоть один из этих</label>\r\n              <Select\r\n                closeMenuOnSelect={false}\r\n                className=\"select players\"\r\n                classNamePrefix=\"select\"\r\n                placeholder=\"игроки...\"\r\n                isMulti\r\n                options={players}\r\n                value={_.getOr(null, 'playersOr', filter)}\r\n                onChange={this.setFilter('playersOr')}\r\n              />\r\n            </div>\r\n            <div className=\"_margin-right\">\r\n              <label className=\"label\">и никто из этих</label>\r\n              <Select\r\n                closeMenuOnSelect={false}\r\n                className=\"select players\"\r\n                classNamePrefix=\"select\"\r\n                placeholder=\"игроки...\"\r\n                isMulti\r\n                options={players}\r\n                value={_.getOr(null, 'playersNot', filter)}\r\n                onChange={this.setFilter('playersNot')}\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div>\r\n          <Toggle\r\n            checked={_.getOr(false, 'showRank', filter)}\r\n            onChange={this.setFilter('showRank')}\r\n          >\r\n            показывать скоры на ранке\r\n          </Toggle>\r\n        </div>\r\n        {_.get('showRank', filter) && (\r\n          <>\r\n            <div>\r\n              <Toggle\r\n                checked={_.getOr(false, 'showOnlyRank', filter)}\r\n                onChange={value => {\r\n                  this.setFilter('showOnlyRank', value);\r\n                  if (_.get('showRankAndNorank', filter)) {\r\n                    this.setFilter('showRankAndNorank', false);\r\n                  }\r\n                }}\r\n              >\r\n                <strong>только</strong> на ранке\r\n              </Toggle>\r\n            </div>\r\n            <div>\r\n              <Toggle\r\n                checked={_.getOr(false, 'showRankAndNorank', filter)}\r\n                onChange={value => {\r\n                  this.setFilter('showRankAndNorank', value);\r\n                  if (_.get('showOnlyRank', filter)) {\r\n                    this.setFilter('showOnlyRank', false);\r\n                  }\r\n                }}\r\n              >\r\n                показывать лучшие скоры с ранком и без\r\n              </Toggle>\r\n            </div>\r\n          </>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderSortings() {\r\n    const { filter } = this.state;\r\n    const { players } = this.props;\r\n    return (\r\n      <div className=\"sortings\">\r\n        <div>\r\n          <label className=\"label\">сортировать по</label>\r\n          <Select\r\n            placeholder=\"выберите сортировку\"\r\n            className=\"select\"\r\n            classNamePrefix=\"select\"\r\n            clearable={false}\r\n            options={sortingOptions}\r\n            value={_.getOr(sortingOptions[0], 'sortingType', filter)}\r\n            onChange={this.setFilter('sortingType')}\r\n          />\r\n        </div>\r\n        {_.get('sortingType.value', filter) === SORT.PROTAGONIST && (\r\n          <>\r\n            <div>\r\n              <label className=\"label\">протагонист (кого сравнивать с остальными):</label>\r\n              <Select\r\n                className={classNames('select players', {\r\n                  'red-border': !_.get('protagonist', filter),\r\n                })}\r\n                classNamePrefix=\"select\"\r\n                placeholder=\"игроки...\"\r\n                options={players}\r\n                value={_.getOr(null, 'protagonist', filter)}\r\n                onChange={this.setFilter('protagonist')}\r\n              />\r\n            </div>\r\n            <div>\r\n              <label className=\"label\">не учитывать в сравнении:</label>\r\n              <Select\r\n                closeMenuOnSelect={false}\r\n                className=\"select players\"\r\n                classNamePrefix=\"select\"\r\n                placeholder=\"игроки...\"\r\n                options={players}\r\n                isMulti\r\n                value={_.getOr([], 'excludeAntagonists', filter)}\r\n                onChange={this.setFilter('excludeAntagonists')}\r\n              />\r\n            </div>\r\n          </>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  render() {\r\n    const { isLoading, data, error } = this.props;\r\n    const { showItemsCount, filter } = this.state;\r\n\r\n    const filteredData = getFilteredData(data, filter);\r\n\r\n    const canShowMore = filteredData.length > showItemsCount;\r\n    const visibleData = _.slice(0, showItemsCount, filteredData);\r\n\r\n    const uniqueSelectedNames = _.slice(\r\n      0,\r\n      colorsArray.length,\r\n      _.uniq(\r\n        _.compact([\r\n          _.get('sortingType.value', filter) === SORT.PROTAGONIST &&\r\n            _.get('protagonist.value', filter),\r\n          ..._.map('value', filter.players),\r\n          ..._.map('value', filter.playersOr),\r\n        ])\r\n      )\r\n    );\r\n\r\n    return (\r\n      <div className=\"rankings\">\r\n        <header>leaderboard</header>\r\n        <div className=\"content\">\r\n          {error && error.message}\r\n          <div className=\"search-block\">\r\n            {this.renderSimpleSearch()}\r\n            <CollapsibleBar title=\"фильтры\">{this.renderFilters()}</CollapsibleBar>\r\n            <CollapsibleBar title=\"сортировка\">{this.renderSortings()}</CollapsibleBar>\r\n          </div>\r\n          {isLoading && 'Loading...'}\r\n          <div className=\"top-list\">\r\n            {_.isEmpty(filteredData) && !isLoading && 'ничего не найдено'}\r\n            {visibleData.map((chart, chartIndex) => {\r\n              return (\r\n                <div className=\"song-block\" key={chart.song + chart.chartLabel}>\r\n                  <div className=\"song-name\">\r\n                    <div\r\n                      className={classNames('chart-name', {\r\n                        single: chart.chartType === 'S',\r\n                      })}\r\n                    >\r\n                      {chart.chartType}\r\n                      <span className=\"chart-separator\" />\r\n                      {chart.chartLevel}\r\n                    </div>\r\n                    <div>{chart.song}</div>\r\n                  </div>\r\n                  <div className=\"charts\">\r\n                    <div className=\"chart\">\r\n                      <div className=\"results\">\r\n                        <table>\r\n                          {chartIndex === 0 && (\r\n                            <thead>\r\n                              <tr>\r\n                                <th className=\"place\"></th>\r\n                                <th className=\"nickname\"></th>\r\n                                <th className=\"rank\"></th>\r\n                                <th className=\"score\">score</th>\r\n                                <th className=\"grade\"></th>\r\n                                <th className=\"number\">miss</th>\r\n                                <th className=\"number\">bad</th>\r\n                                <th className=\"number\">good</th>\r\n                                <th className=\"number\">great</th>\r\n                                <th className=\"number\">perfect</th>\r\n                                <th className=\"combo\">combo</th>\r\n                                <th className=\"accuracy\">accuracy</th>\r\n                                <th className=\"date\"></th>\r\n                              </tr>\r\n                            </thead>\r\n                          )}\r\n                          <tbody>\r\n                            {chart.results.map(res => {\r\n                              const nameIndex = uniqueSelectedNames.indexOf(res.nickname);\r\n                              return (\r\n                                <tr\r\n                                  key={res.score + res.nickname}\r\n                                  className={classNames({ empty: !res.isExactDate })}\r\n                                >\r\n                                  <td className=\"place\">\r\n                                    {res.isSecondOccurenceInResults ? '' : `#${res.topPlace}`}\r\n                                  </td>\r\n                                  <td\r\n                                    className=\"nickname\"\r\n                                    style={\r\n                                      nameIndex > -1\r\n                                        ? { fontWeight: 'bold', color: colorsArray[nameIndex] }\r\n                                        : {}\r\n                                    }\r\n                                  >\r\n                                    {res.nickname}\r\n                                    {_.get('sortingType.value', filter) === SORT.PROTAGONIST &&\r\n                                      res.nickname === _.get('protagonist.value', filter) &&\r\n                                      chart.distanceFromProtagonist > 0 && (\r\n                                        <span className=\"protagonist-diff\">\r\n                                          {' '}\r\n                                          -{(chart.distanceFromProtagonist * 100).toFixed(1)}%\r\n                                        </span>\r\n                                      )}\r\n                                  </td>\r\n                                  <td className={classNames('rank', { vj: res.isRank })}>\r\n                                    {res.isRank &&\r\n                                      (res.isExactDate ? (\r\n                                        'VJ'\r\n                                      ) : (\r\n                                        <Tooltip\r\n                                          content={\r\n                                            <>\r\n                                              <div>\r\n                                                наличие ранка на этом результате было угадано,\r\n                                                основываясь на скоре\r\n                                              </div>\r\n                                            </>\r\n                                          }\r\n                                          tooltipClassName=\"timeago-tooltip\"\r\n                                        >\r\n                                          VJ?\r\n                                        </Tooltip>\r\n                                      ))}\r\n                                  </td>\r\n                                  <td className=\"score\">{numeral(res.score).format('0,0')}</td>\r\n                                  <td className=\"grade\">\r\n                                    <div className=\"img-holder\">\r\n                                      {res.grade && res.grade !== '?' && (\r\n                                        <img\r\n                                          src={`${process.env.PUBLIC_URL}/grades/${res.grade}.png`}\r\n                                          alt={res.grade}\r\n                                        />\r\n                                      )}\r\n                                      {res.grade === '?' && null}\r\n                                    </div>\r\n                                  </td>\r\n                                  <td className=\"number miss\">{res.miss}</td>\r\n                                  <td className=\"number bad\">{res.bad}</td>\r\n                                  <td className=\"number good\">{res.good}</td>\r\n                                  <td className=\"number great\">{res.great}</td>\r\n                                  <td className=\"number perfect\">{res.perfect}</td>\r\n                                  <td className=\"combo\">\r\n                                    {res.combo}\r\n                                    {res.combo ? 'x' : ''}\r\n                                  </td>\r\n                                  <td className=\"accuracy\">\r\n                                    {res.accuracy}\r\n                                    {res.accuracy ? '%' : ''}\r\n                                  </td>\r\n                                  <td\r\n                                    className={classNames('date', {\r\n                                      latest: res.date === chart.latestScoreDate,\r\n                                    })}\r\n                                  >\r\n                                    <Tooltip\r\n                                      content={\r\n                                        res.isExactDate\r\n                                          ? tooltipFormatter(res.dateObject)\r\n                                          : tooltipFormatterForBests(res.dateObject)\r\n                                      }\r\n                                      tooltipClassName=\"timeago-tooltip\"\r\n                                    >\r\n                                      {getTimeAgo(res.dateObject)}\r\n                                      {res.isExactDate ? '' : '?'}\r\n                                    </Tooltip>\r\n                                  </td>\r\n                                </tr>\r\n                              );\r\n                            })}\r\n                          </tbody>\r\n                        </table>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              );\r\n            })}\r\n            {!isLoading && canShowMore && (\r\n              <button\r\n                className=\"btn btn-sm btn-primary\"\r\n                onClick={() =>\r\n                  this.setState(state => ({ showItemsCount: state.showItemsCount + 10 }))\r\n                }\r\n              >\r\n                show more...\r\n              </button>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n)(TopScores);\r\n","export const HOST = 'https://vps720616.ovh.net:5000';\r\n","import React, { Component } from 'react';\r\nimport { Route } from 'react-router-dom';\r\n\r\nimport './App.scss';\r\n\r\nimport Rankings from 'components/Rankings/Rankings';\r\n\r\nclass App extends Component {\r\n  render() {\r\n    return (\r\n      <div className=\"container\">\r\n        <Route exact path=\"/\" component={Rankings} />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default App;\r\n","import { combineReducers, createStore, applyMiddleware, compose } from 'redux';\r\nimport thunk from 'redux-thunk';\r\n\r\nimport top from 'reducers/top';\r\n\r\nconst rootReducer = combineReducers({\r\n  top,\r\n});\r\n\r\nexport const store = createStore(\r\n  rootReducer,\r\n  window.__REDUX_DEVTOOLS_EXTENSION__\r\n    ? compose(\r\n        applyMiddleware(thunk),\r\n        window.__REDUX_DEVTOOLS_EXTENSION__({\r\n          stateSanitizer: state => ({\r\n            ...state,\r\n          }),\r\n        })\r\n      )\r\n    : applyMiddleware(thunk)\r\n);\r\n","// import 'promise-polyfill';\r\n// import 'whatwg-fetch';\r\n// import 'utils/polyfills';\r\n\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { HashRouter } from 'react-router-dom';\r\nimport { Provider } from 'react-redux';\r\n\r\nimport './index.scss';\r\nimport App from 'components/App';\r\nimport { store } from 'reducers';\r\n\r\nReactDOM.render(\r\n  <Provider store={store}>\r\n    <HashRouter>\r\n      <App />\r\n    </HashRouter>\r\n  </Provider>,\r\n  document.getElementById('root')\r\n);\r\n"],"sourceRoot":""}