(window["webpackJsonppiu-spy-web-2"]=window["webpackJsonppiu-spy-web-2"]||[]).push([[0],{57:function(e,t,a){e.exports=a(93)},66:function(e,t,a){},67:function(e,t,a){},75:function(e,t,a){},76:function(e,t,a){},78:function(e,t,a){},93:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),c=a(14),o=a.n(c),s=a(38),i=a(30),l=a(97),u=a(54),m=a.n(u),p=(a(66),a(5)),f=a(6),d=a(7),b=a(8),h=a(9),g=a(22),v=(a(67),a(2)),y=a(47),O=a(40),E=a(4),j=a.n(E),w=a(49),k=a(55),N=a(24),x=a.n(N),P=a(50),S=a.n(P),C=a(1),D=a(56),T=a(53),L=(a(75),{preventOverflow:{enabled:!0,padding:10,boundariesElement:"viewport"}}),_={right:"left",left:"right",top:"bottom",bottom:"top"},R=function(e){return e&&_[e.split("-")[0]]},I=function(e){function t(){var e;return Object(p.a)(this,t),(e=Object(d.a)(this,Object(b.a)(t).call(this))).state={isVisible:!1},e.containerItemRef=n.a.createRef(),e.renderPopper=e.renderPopper.bind(Object(C.a)(e)),e.toggleOverlayVisibility=e.toggleOverlayVisibility.bind(Object(C.a)(e)),e}return Object(h.a)(t,e),Object(f.a)(t,[{key:"hideOverlay",value:function(){this.setState({isVisible:!1})}},{key:"toggleOverlayVisibility",value:function(){this.setState({isVisible:!this.state.isVisible})}},{key:"handleClickOutside",value:function(e){e&&e.target.closest(".inner-popper-overlay")||this.hideOverlay()}},{key:"renderPopper",value:function(e){var t=e.ref,a=e.style,r=e.placement,c=e.arrowProps,o=(e.scheduleUpdate,e.outOfBoundaries),s=this.props,i=s.children,l=s.hideWhenOutOfBounds;return n.a.createElement("div",{ref:t,style:a,"data-placement":r,className:x()("inner-popper-overlay","arrow-".concat(R(r)),{"out-of-bounds":o&&l})},n.a.createElement("div",{className:"arrow-hider"},n.a.createElement("div",{className:"arrow",ref:c.ref,style:c.style})),n.a.createElement("div",{className:"inner-popper-content"},i))}},{key:"render",value:function(){var e=this.props,t=e.placement,a=e.overlayItem,r=this.state.isVisible;return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"overlay-item",ref:this.containerItemRef,onClick:this.toggleOverlayVisibility},a),r&&o.a.createPortal(n.a.createElement(D.a,{container:document.body,modifiers:L,placement:t,referenceElement:this.containerItemRef.current},this.renderPopper),document.body))}}]),t}(n.a.PureComponent);I.defaultTypes={placement:"bottom"};var V=Object(T.a)(I),B=(a(76),function(e){function t(){return Object(p.a)(this,t),Object(d.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.props,t=e.active,a=e.onToggle,r=e.text;return n.a.createElement("div",{className:x()("toggle-button",{active:t}),onClick:function(){return a(!t)}},r)}}]),t}(n.a.PureComponent)),M=(a(77),a(78),a(25)),A=a.n(M),F=a(29),W=function(){var e=Object(F.a)(A.a.mark(function e(t){var a,r,n;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.url,e.prev=1,e.next=4,fetch(a);case 4:if(!((r=e.sent).status>=200&&r.status<300)){e.next=12;break}return e.next=8,r.json();case 8:return n=e.sent,e.abrupt("return",n);case 12:throw Error("HTTP Status "+r.status);case 13:e.next=19;break;case 15:return e.prev=15,e.t0=e.catch(1),console.error(e.t0),e.abrupt("return",Promise.reject(e.t0));case 19:case"end":return e.stop()}},e,null,[[1,15]])}));return function(t){return e.apply(this,arguments)}}();function U(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}function X(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?U(a,!0).forEach(function(t){Object(v.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):U(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var J="TOP/LOADING",H="TOP/SUCCESS",q="TOP/ERROR",z={isLoading:!1,data:[]},G=j.a.flow(j.a.get("top"),j.a.values,j.a.map(function(e){return{song:e.track,chartLabel:e.chart_label,chartLevel:e.chart_label.slice(1),chartType:e.chart_label.slice(0,1),mix:e.mix,results:j.a.map(function(e){return{nickname:e.nickname,date:e.gained,isExactDate:!!e.exact_gained_date,score:e.score,perfect:e.perfects,great:e.greats,good:e.goods,bad:e.bads,miss:e.misses,combo:e.max_combo,mods:e.mods_list,isRank:!!e.rank_mode,accuracy:e.max_combo?((300*e.perfects+150*e.greats+50*e.goods+15*e.bads)/(e.perfects+e.greats+e.goods+e.bads+e.misses)/3).toFixed(2):null}},e.results)}}),j.a.orderBy(["song","chartLevel"],["asc","desc"]),function(e){return{data:e}});function K(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}function Q(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?K(a,!0).forEach(function(t){Object(v.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):K(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var Y=[1,29],Z=function(e,t){var a=j.a.map("value",t.players);return j.a.flow(j.a.compact([t.song&&function(e){return Object(y.a)(e,t.song,{keys:["song"]})},a.length&&j.a.filter(function(e){var t=j.a.map("nickname",e.results);return j.a.every(function(e){return t.includes(e)},a)}),t.chartRange&&function(e){return function(e,t){var a=j.a.getOr(Y,"range",e),r=j.a.getOr(null,"type",e);return j.a.flow(j.a.filter(function(e){return e.chartLevel>=a[0]&&e.chartLevel<=a[1]&&(!r||r===e.chartType)}))(t)}(t.chartRange,e)}]))(e)};function $(e){var t=e.filterValue,a=e.onChange,r=j.a.getOr(Y,"range",t),c=j.a.getOr(null,"type",t),o="charts filter...";if(t){var s=c||"";o=r[0]===r[1]?"".concat(s).concat(r[0]):"".concat(s).concat(r[0],"-").concat(s).concat(r[1])}return n.a.createElement("div",null,n.a.createElement(V,{overlayItem:n.a.createElement("button",{className:"filter-charts-button btn btn-sm btn-primary"},o)},n.a.createElement("div",{className:"chart-range-overlay"},n.a.createElement("div",{className:"buttons"},n.a.createElement(B,{text:"S",active:!c||"S"===c,onToggle:function(e){a({range:r,type:e?null:"D"})}}),n.a.createElement(B,{text:"D",active:!c||"D"===c,onToggle:function(e){a({range:r,type:e?null:"S"})}})),n.a.createElement(O.Range,{values:r,step:1,min:Y[0],max:Y[1],onChange:function(e){return a({type:c,range:e})},renderTrack:function(e){var t=e.props,a=e.children;return n.a.createElement("div",{onMouseDown:t.onMouseDown,onTouchStart:t.onTouchStart,style:Q({},t.style,{height:"10px",display:"flex",width:"100%"})},n.a.createElement("div",{ref:t.ref,style:{height:"6px",width:"100%",borderRadius:"3px",background:Object(O.getTrackBackground)({values:r,colors:["#ccc","#337ab7","#ccc"],min:Y[0],max:Y[1]}),alignSelf:"center"}},a))},renderThumb:function(e){var t=e.props,a=e.isDragged;return n.a.createElement("div",Object.assign({},t,{style:Q({},t.style,{height:"12px",width:"12px",borderRadius:"6px",backgroundColor:"#FFF",display:"flex",justifyContent:"center",alignItems:"center",boxShadow:"0px 2px 3px #AAA"})}),n.a.createElement("div",{style:{height:"6px",width:"6px",borderRadius:"3px",backgroundColor:a?"#337ab7":"#CCC"}}))}}))))}var ee=Object(w.a)(function(e){return e.top.data},j.a.flow(j.a.flatMap(j.a.get("results")),j.a.map("nickname"),j.a.uniq,j.a.sortBy(j.a.toLower),j.a.map(function(e){return{label:e,value:e}}))),te={fetchTopScores:function(){return function(){var e=Object(F.a)(A.a.mark(function e(t){var a;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:J}),e.prev=1,e.next=4,W({url:"".concat("https://vps720616.ovh.net:5000","/top")});case 4:return a=e.sent,t({type:H,data:a}),e.abrupt("return",a);case 9:e.prev=9,e.t0=e.catch(1),t({type:q,error:e.t0});case 12:case"end":return e.stop()}},e,null,[[1,9]])}));return function(t){return e.apply(this,arguments)}}()}},ae=function(e){function t(){var e,a;Object(p.a)(this,t);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];return(a=Object(d.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(n)))).state={filter:{},showItemsCount:10},a}return Object(h.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){this.props.isLoading||this.props.fetchTopScores()}},{key:"getColumns",value:function(){return[{minWidth:120,maxWidth:250,Header:"song",accessor:"song"},{minWidth:95,maxWidth:95,accessor:"chartLabel"},{filterMethod:function(e,t){var a=j.a.map("value",j.a.get("value",e));return j.a.filter(function(e){var t=j.a.map("nickname",e.results);return j.a.every(function(e){return t.includes(e)},a)},t)},Cell:function(e){return n.a.createElement("div",null,e.original.results.map(function(e){return n.a.createElement("div",{key:e.nickname},e.nickname," - ",e.score)}))},accessor:"results"}]}},{key:"render",value:function(){var e=this,t=this.props,a=t.isLoading,r=t.data,c=t.error,o=t.players,s=this.state,i=s.showItemsCount,l=s.filter,u=Z(r,l),m=j.a.groupBy("song",u),p=j.a.keys(m),f=p.length>i,d=j.a.slice(0,i,p);return n.a.createElement("div",{className:"rankings"},n.a.createElement("header",null),n.a.createElement("div",{className:"content"},c&&c.message,n.a.createElement("div",{className:"filters"},n.a.createElement("div",{className:"song-name"},n.a.createElement("input",{type:"text",placeholder:"song name...",className:"form-control",onChange:function(t){var a=t.target.value;e.setState(function(e){return{filter:Q({},e.filter,{song:a})}})}})),n.a.createElement("div",{className:"chart-range"},n.a.createElement($,{filterValue:this.state.filter.chartRange,onChange:function(t){return e.setState(function(e){return{filter:Q({},e.filter,{chartRange:t})}})}})),n.a.createElement("div",{className:"players"},n.a.createElement(k.a,{closeMenuOnSelect:!1,className:"select players",classNamePrefix:"select",placeholder:"select players...",isMulti:!0,options:o,value:j.a.getOr(null,"players",this.state.filter),onChange:function(t){return e.setState(function(e){return{filter:Q({},e.filter,{players:t})}})}}))),a&&"Loading...",n.a.createElement("div",{className:"top-list"},d.map(function(e){return n.a.createElement("div",{className:"song-block",key:e},n.a.createElement("div",{className:"song-name"},e),n.a.createElement("div",{className:"charts"},j.a.orderBy(["chartLevel"],["desc"],m[e]).map(function(e){return n.a.createElement("div",{className:"chart",key:e.chartLabel},n.a.createElement("div",{className:x()("chart-name",{single:"S"===e.chartType})},e.chartType,n.a.createElement("span",{className:"chart-separator"}),e.chartLevel),n.a.createElement("div",{className:"results"},n.a.createElement("table",null,n.a.createElement("tbody",null,e.results.map(function(e,t){return n.a.createElement("tr",{key:e.score+e.nickname},n.a.createElement("td",{className:"place"},"#",t+1),n.a.createElement("td",{className:"nickname"},e.nickname),n.a.createElement("td",{className:"score"},S()(e.score).format("0,0")),n.a.createElement("td",{className:"accuracy"},e.accuracy,e.accuracy?"%":""),n.a.createElement("td",{className:"number miss"},e.miss),n.a.createElement("td",{className:"number bad"},e.bad),n.a.createElement("td",{className:"number good"},e.good),n.a.createElement("td",{className:"number great"},e.great),n.a.createElement("td",{className:"number perfect"},e.perfect),n.a.createElement("td",{className:"combo"},e.combo,e.combo?"x":""),n.a.createElement("td",{className:x()("rank",{vj:e.isRank})},e.isRank&&"VJ"),n.a.createElement("td",{className:"date"},e.date))})))))})))}),!a&&f&&n.a.createElement("button",{className:"btn btn-sm btn-primary",onClick:function(){return e.setState(function(e){return{showItemsCount:e.showItemsCount+10}})}},"show more..."))))}}]),t}(r.Component),re=Object(i.b)(function(e){return{players:ee(e),data:e.top.data,error:e.top.error,isLoading:e.top.isLoading}},te)(ae),ne=function(e){function t(){return Object(p.a)(this,t),Object(d.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{className:"container"},n.a.createElement(g.a,{exact:!0,path:"/",component:re}))}}]),t}(r.Component),ce=a(23),oe=a(43);function se(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}var ie=Object(ce.c)({top:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case J:return X({},e,{isLoading:!0});case q:return X({},e,{isLoading:!1,error:t.error});case H:return X({},e,{isLoading:!1},G(t.data));default:return e}}}),le=Object(ce.e)(ie,window.__REDUX_DEVTOOLS_EXTENSION__?Object(ce.d)(Object(ce.a)(oe.a),window.__REDUX_DEVTOOLS_EXTENSION__({stateSanitizer:function(e){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?se(a,!0).forEach(function(t){Object(v.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):se(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},e)}})):Object(ce.a)(oe.a));l.a.locale(m.a),o.a.render(n.a.createElement(i.a,{store:le},n.a.createElement(s.a,null,n.a.createElement(ne,null))),document.getElementById("root"))}},[[57,1,2]]]);
//# sourceMappingURL=main.5f152c67.chunk.js.map