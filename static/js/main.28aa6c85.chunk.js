(this["webpackJsonppiu-spy-web-2"]=this["webpackJsonppiu-spy-web-2"]||[]).push([[0],{181:function(e,t,a){var r=a(273),n=["getProcessedProfiles"];e.exports=function(){var e=new Worker(a.p+"7a1b1cf29acfcd2fc2da.worker.js",{name:"[hash].worker.js"});return r(e,n),e}},226:function(e,t,a){e.exports=a(444)},231:function(e,t){Number.isNaN=Number.isNaN||function(e){return e!==e},"undefined"===typeof Math.sign&&(Math.sign=function(e){return e>0?1:e<0?-1:e}),Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),a=t.length>>>0;if("function"!==typeof e)throw new TypeError("predicate must be a function");for(var r=arguments[1],n=0;n<a;){var s=t[n];if(e.call(r,s,n,t))return n;n++}return-1},configurable:!0,writable:!0})},240:function(e,t,a){},252:function(e,t,a){},253:function(e,t,a){},254:function(e,t,a){},265:function(e,t,a){},266:function(e,t,a){},267:function(e,t,a){},268:function(e,t,a){},270:function(e,t,a){},277:function(e,t,a){},426:function(e,t,a){},427:function(e,t,a){},428:function(e,t,a){},429:function(e,t,a){},439:function(e,t,a){},442:function(e,t,a){},443:function(e,t,a){},444:function(e,t,a){"use strict";a.r(t);a(227),a(230),a(231);var r=a(1),n=a.n(r),s=a(15),c=a.n(s),l=a(14),o=a(13),i=(a(240),a(9)),m=a(49),d=a(19),p=a.n(d),u=a(56),h=a.n(u),g=a(2),f=a.n(g);a(251),a(252);const E={leaderboard:{path:"/leaderboard",sharedChart:{path:"/leaderboard/chart/:sharedChartId",getPath:e=>"/leaderboard/chart/".concat(e.sharedChartId)}},songs:{path:"/songs"},ranking:{path:"/ranking",faq:{path:"/ranking/faq"}},profile:{path:"/profiles/:id",getPath:e=>"/profiles/".concat(e.id),compare:{path:"/profiles/:id/vs/:compareToId",getPath:e=>"/profiles/".concat(e.id,"/vs/").concat(e.compareToId)}}},b={DEFAULT:"default",PROTAGONIST:"protagonist",RANK_ASC:"rankAsc",RANK_DESC:"rankDesc",PP_ASC:"ppAsc",PP_DESC:"ppDesc",NEW_SCORES_PLAYER:"newScoresPlayer",EASIEST_SONGS:"easiestSongs",HARDEST_SONGS:"hardestSongs"},y={SHOW_ALL:"SHOW_ALL",SHOW_BEST:"SHOW_BEST",SHOW_ONLY_RANK:"SHOW_ONLY_RANK",SHOW_ONLY_NORANK:"SHOW_ONLY_NORANK"},v=[1,28],O={STD:"Standard",SHORT:"Short",REMIX:"Remix",FULL:"Full"},N=f.a.values(O);var P=a(10),k=a(11),S=a(5),j=a.n(S);a(253),a(254);function w(){return n.a.createElement("div",{className:"loader"},n.a.createElement("svg",{width:"40",height:"12",viewBox:"0 0 120 30",xmlns:"http://www.w3.org/2000/svg",fill:"#eee"},n.a.createElement("circle",{cx:"15",cy:"15",r:"15"},n.a.createElement("animate",{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}),n.a.createElement("animate",{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"})),n.a.createElement("circle",{cx:"60",cy:"15",r:"9",fillOpacity:"0.3"},n.a.createElement("animate",{attributeName:"r",from:"9",to:"9",begin:"0s",dur:"0.8s",values:"9;15;9",calcMode:"linear",repeatCount:"indefinite"}),n.a.createElement("animate",{attributeName:"fill-opacity",from:"0.5",to:"0.5",begin:"0s",dur:"0.8s",values:".5;1;.5",calcMode:"linear",repeatCount:"indefinite"})),n.a.createElement("circle",{cx:"105",cy:"15",r:"15"},n.a.createElement("animate",{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}),n.a.createElement("animate",{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"}))))}var x=a(85),D=a.n(x);const R="USER/RESET",C=()=>({type:R});function L(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function _(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?L(Object(a),!0).forEach((function(t){Object(i.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):L(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const I=({url:e})=>M({url:e,method:"get"}),A=({url:e,body:t})=>M({url:e,method:"post",body:JSON.stringify(t),headers:{"Content-Type":"application/json;charset=utf-8"}}),T={},M=({url:e,method:t,body:a,headers:r})=>async(n,s)=>{try{const n=D.a.get("session");n&&(T.Session=n);const s=await fetch(e,{method:t,body:a,headers:_({},T,{},r),credentials:"include"});if(s.status>=200&&s.status<300){return await s.json()}{const e=await s.json();throw f.a.isObject(e)&&f.a.isString(e.error)?new Error(e.error):f.a.isString(e)?new Error(e):new Error("HTTP Status "+s.status)}}catch(c){return"Invalid session"===c.message&&n(C()),Promise.reject(c)}},F="https://vps720616.ovh.net:5000",B="ws://127.0.0.1:6789";function H(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function K(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?H(Object(a),!0).forEach((function(t){Object(i.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):H(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const W="MOST_PLAYED/LOADING",U="MOST_PLAYED/SUCCESS",G="MOST_PLAYED/ERROR",q={isLoading:!1,data:[]};function V(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function z(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?V(Object(a),!0).forEach((function(t){Object(i.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):V(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const Y="MOST_PLAYED_MONTH/LOADING",X="MOST_PLAYED_MONTH/SUCCESS",J="MOST_PLAYED_MONTH/ERROR",Q={isLoading:!1,data:[]};function Z(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function $(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(a),!0).forEach((function(t){Object(i.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Z(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const ee="LEAST_PLAYED/LOADING",te="LEAST_PLAYED/SUCCESS",ae="LEAST_PLAYED/ERROR",re={isLoading:!1,data:[]};var ne=a(448),se=a(86),ce=a.n(se),le=a(447),oe=a(16),ie=a.n(oe);ne.a.addLocale(ce.a);const me=new ne.a("ru-RU"),de={flavour:"long",gradation:le.a,units:["day","week","month"]},pe=e=>{if(e.isExactDate)return e.dateObject.toLocaleDateString();{const t=void 0===e.isMyBest&&void 0===e.isMachineBest?"\u0441 my best \u0438\u043b\u0438 machine best":e.isMyBest?"\u0441 my best":e.isMachineBest?"\u0441 machine best":"\u0445\u0437 \u043e\u0442\u043a\u0443\u0434\u0430";return n.a.createElement("div",{style:{display:"flex",alignItems:"center",flexDirection:"column"}},n.a.createElement("div",null,"\u0442\u043e\u0447\u043d\u0430\u044f \u0434\u0430\u0442\u0430 \u0432\u0437\u044f\u0442\u0438\u044f \u043d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u0430"),n.a.createElement("div",null,"\u0441\u043a\u043e\u0440 \u0431\u044b\u043b \u0437\u0430\u043f\u0438\u0441\u0430\u043d ",t),n.a.createElement("div",null,"\u0434\u0430\u0442\u0430 \u0437\u0430\u043f\u0438\u0441\u0438: ",e.dateObject.toLocaleDateString()))}},ue=e=>{const t=ie()().startOf("day").diff(ie()(e).startOf("day"),"days"),a=ie()(e).hour();return ie()().hour()<5?t<=1?"\u0441\u0435\u0433\u043e\u0434\u043d\u044f":me.format(e,de):0===t?a<5?"\u0432\u0447\u0435\u0440\u0430 \u043d\u043e\u0447\u044c\u044e":"\u0441\u0435\u0433\u043e\u0434\u043d\u044f":1===t?"\u0432\u0447\u0435\u0440\u0430":me.format(e,de)},he=e=>"string"===typeof e?ie()(e).toDate():new Date(e);function ge({fetchList:e,title:t,renderRightSide:a}){const s=Object(r.useState)([]),c=Object(P.a)(s,2),l=c[0],o=c[1],i=Object(r.useState)(!1),m=Object(P.a)(i,2),d=m[0],p=m[1],u=a||(e=>n.a.createElement("div",{className:"playcount"},n.a.createElement(k.n,null),n.a.createElement("span",null,e.countplay)));return Object(r.useEffect)(()=>{p(!0),e().then(e=>{e.success&&o(e.data),p(!1)}).catch(()=>{p(!1)})},[e]),n.a.createElement("div",{className:"top-songs-list"},n.a.createElement("div",{className:"top-songs-header"},n.a.createElement("span",null,t)),d&&n.a.createElement(w,null),!d&&l.map((e,t)=>n.a.createElement("div",{key:e.id,className:"top-songs-item"},n.a.createElement("div",{className:j()("place","top-".concat(t+1),{best:t<3})},n.a.createElement("span",null,t+1,".")),n.a.createElement("div",{className:"song-name"},e.full_name),u(e))))}const fe=e=>n.a.createElement("div",{className:"date"},n.a.createElement("span",null,e.last_play?ue(he(e.last_play)):"\u043d\u0438\u043a\u043e\u0433\u0434\u0430"));var Ee=Object(o.b)(null,{fetchMostPlayed:()=>async e=>{e({type:W});try{const t=await e(I({url:"".concat(F,"/track-stats/most-played")}));return e({type:U,data:t}),t}catch(t){return e({type:G,error:t}),null}},fetchMostPlayedMonth:()=>async e=>{e({type:Y});try{const t=await e(I({url:"".concat(F,"/track-stats/most-played-month")}));return e({type:X,data:t}),t}catch(t){return e({type:J,error:t}),null}},fetchLeastPlayed:()=>async e=>{e({type:ee});try{const t=await e(I({url:"".concat(F,"/track-stats/most-time-not-played")}));return e({type:te,data:t}),t}catch(t){return e({type:ae,error:t}),null}}})((function({fetchMostPlayed:e,fetchMostPlayedMonth:t,fetchLeastPlayed:a}){return n.a.createElement("div",{className:"songs-top-page"},n.a.createElement(ge,{fetchList:e,title:"\u0442\u043e\u043f \u043f\u043e\u043f\u0443\u043b\u044f\u0440\u043d\u044b\u0445 \u0442\u0440\u0435\u043a\u043e\u0432"}),n.a.createElement(ge,{fetchList:t,title:"\u0442\u043e\u043f \u043f\u043e\u043f\u0443\u043b\u044f\u0440\u043d\u044b\u0445 \u0442\u0440\u0435\u043a\u043e\u0432 \u0437\u0430 \u043c\u0435\u0441\u044f\u0446"}),n.a.createElement(ge,{fetchList:a,title:"\u0442\u0440\u0435\u043a\u0438, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0434\u043e\u043b\u0433\u043e \u043d\u0435 \u0438\u0433\u0440\u0430\u043b\u0438",renderRightSide:fe}),n.a.createElement("div",{className:"top-songs-list -placeholder"}))})),be=a(24),ye=(a(265),a(35)),ve=a(36),Oe=a(39),Ne=a(37),Pe=a(40),ke=(a(266),function(e){function t(){return Object(ye.a)(this,t),Object(Oe.a)(this,Object(Ne.a)(t).apply(this,arguments))}return Object(Pe.a)(t,e),Object(ve.a)(t,[{key:"render",value:function(){var e=this.props,t=e.active,a=e.onToggle,r=e.text;return n.a.createElement("div",{className:j()("toggle-button",{active:t}),onClick:function(){return a(!t)}},r)}}]),t}(n.a.PureComponent)),Se=a(52),je=function(e){function t(e){var a;return Object(ye.a)(this,t),(a=Object(Oe.a)(this,Object(Ne.a)(t).call(this,e))).state={value:(f.a.isNil(e.value)?e.defaultValue:e.value)||""},f.a.bindAll(["handleChange","handleBlur","handleKeyPress"],Object(Se.a)(a)),a}return Object(Pe.a)(t,e),Object(ve.a)(t,[{key:"componentDidUpdate",value:function(e){e.value!==this.props.value&&this.setState({value:this.props.value})}},{key:"handleChange",value:function(e){var t=this,a=e.target.value;this.setState({value:a},(function(){return t.props.onChange(a)}))}},{key:"handleBlur",value:function(e){var t=this.props.type,a=this.state.value;if("number"===t){var r=Number(a);r>=Number(e.target.min)&&r<=Number(e.target.max)?this.props.onBlur(r,e):(this.setState({value:this.props.value}),this.props.onBlur(this.props.value,e))}}},{key:"handleKeyPress",value:function(e){"Enter"===e.key&&this.handleBlur(e)}},{key:"render",value:function(){var e=this.props.className;return n.a.createElement("input",Object.assign({},f.a.omit(["defaultValue","onChange"],this.props),{className:j()(e,"text-input"),value:this.state.value,onBlur:this.handleBlur,onKeyPress:this.handleKeyPress,onInput:this.handleChange,onChange:f.a.noop}))}}]),t}(n.a.Component);je.defaultProps={value:null,type:"text",onChange:f.a.noop,onBlur:f.a.noop};a(267);class we extends n.a.Component{constructor(){super(),this.onChange=e=>{this.props.onChange(e.target.checked)},this.id=f.a.uniqueId()}render(){return n.a.createElement("div",{className:"toggle-checkbox"},n.a.createElement("input",{type:"checkbox",className:"toggle-checkbox-cb",id:this.id,onChange:this.onChange,checked:this.props.checked}),n.a.createElement("label",{htmlFor:this.id,className:"toggle"},n.a.createElement("span",null)),this.props.children&&n.a.createElement("label",{htmlFor:this.id,className:"text-label"},this.props.children))}}a(268);var xe=function(e){function t(e){var a;return Object(ye.a)(this,t),(a=Object(Oe.a)(this,Object(Ne.a)(t).call(this))).state={open:e.defaultOpen||!1},a}return Object(Pe.a)(t,e),Object(ve.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.children,r=t.title,s=t.className,c=this.state.open;return n.a.createElement("div",{className:j()("collapsible-bar",s,{open:c})},n.a.createElement("div",{className:"header",onClick:function(){return e.setState((function(e){return{open:!e.open}}))}},n.a.createElement("div",{className:"collapse-button"},n.a.createElement(k.g,null)),n.a.createElement("div",{className:"title"},r)),a&&n.a.createElement("div",{className:"collapsible-children"},a))}}]),t}(r.PureComponent),De=a(27),Re=a(200),Ce=a(180),Le=(a(270),{preventOverflow:{enabled:!0,padding:10,boundariesElement:"viewport"}}),_e={right:"left",left:"right",top:"bottom",bottom:"top"},Ie=function(e){return e&&_e[e.split("-")[0]]},Ae=function(e){function t(){var e;return Object(ye.a)(this,t),(e=Object(Oe.a)(this,Object(Ne.a)(t).call(this))).state={isVisible:!1},e.containerItemRef=n.a.createRef(),e.renderPopper=e.renderPopper.bind(Object(Se.a)(e)),e.toggleOverlayVisibility=e.toggleOverlayVisibility.bind(Object(Se.a)(e)),e}return Object(Pe.a)(t,e),Object(ve.a)(t,[{key:"hideOverlay",value:function(){this.setState({isVisible:!1})}},{key:"toggleOverlayVisibility",value:function(){this.setState({isVisible:!this.state.isVisible})}},{key:"handleClickOutside",value:function(e){e&&e.target.closest(".inner-popper-overlay")||this.hideOverlay()}},{key:"renderPopper",value:function(e){var t=e.ref,a=e.style,r=e.placement,s=e.arrowProps,c=(e.scheduleUpdate,e.outOfBoundaries),l=this.props,o=l.children,i=l.hideWhenOutOfBounds;return n.a.createElement("div",{ref:t,style:a,"data-placement":r,className:j()("inner-popper-overlay","arrow-".concat(Ie(r)),this.props.overlayClassName,{"out-of-bounds":c&&i})},n.a.createElement("div",{className:"arrow-hider"},n.a.createElement("div",{className:"arrow",ref:s.ref,style:s.style})),n.a.createElement("div",{className:"inner-popper-content"},o))}},{key:"render",value:function(){var e=this.props,t=e.placement,a=e.overlayItem,r=this.state.isVisible;return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"overlay-item",ref:this.containerItemRef,onClick:this.toggleOverlayVisibility},a),r&&c.a.createPortal(n.a.createElement(Re.a,{container:document.body,modifiers:Le,placement:t,referenceElement:this.containerItemRef.current},this.renderPopper),document.body))}}]),t}(n.a.PureComponent);Ae.defaultTypes={placement:"bottom"};var Te=Object(Ce.a)(Ae),Me=a(118);function Fe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Be(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Fe(Object(a),!0).forEach((function(t){Object(i.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Fe(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function He(e){var t=e.range,a=e.min,r=e.max,s=e.onChange;return n.a.createElement(Me.Range,{values:t,step:1,min:a,max:r,onChange:s,renderTrack:function(e){var s=e.props,c=e.children;return n.a.createElement("div",{onMouseDown:s.onMouseDown,onTouchStart:s.onTouchStart,style:Be({},s.style,{position:"relative",height:"10px",display:"flex",width:"100%"})},n.a.createElement("div",{ref:s.ref,style:{height:"6px",width:"100%",borderRadius:"3px",background:Object(Me.getTrackBackground)({values:t,colors:["#ccc","#88d3ff","#ccc"],min:a,max:r}),alignSelf:"center"}},c))},renderThumb:function(e){var t=e.props,a=e.isDragged;return n.a.createElement("div",Object.assign({},t,{style:Be({},t.style,{height:"12px",width:"12px",borderRadius:"6px",backgroundColor:"#FFF",display:"flex",justifyContent:"center",alignItems:"center",boxShadow:"0px 2px 3px #AAA"})}),n.a.createElement("div",{style:{height:"6px",width:"6px",borderRadius:"3px",backgroundColor:a?"#88d3ff":"#CCC"}}))}})}function Ke(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function We(e){var t=e.filterValue,a=e.onChange,r=f.a.getOr(v,"range",t),s=f.a.getOr(null,"type",t),c=f.a.getOr(N,"duration",t),l="\u0444\u0438\u043b\u044c\u0442\u0440 \u0447\u0430\u0440\u0442\u043e\u0432";if(t){var o=s||"";l="\u0447\u0430\u0440\u0442\u044b: "+(l=r[0]===r[1]?"".concat(o).concat(r[0]):"".concat(o).concat(r[0]," - ").concat(o).concat(r[1])),f.a.isEqual(c,N)||(l+=" ***")}var m=function(e){a(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ke(Object(a),!0).forEach((function(t){Object(i.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ke(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({range:r,type:s},e,{duration:f.a.isEmpty(e.duration)?c:e.duration}))};return n.a.createElement("div",null,n.a.createElement(Te,{overlayClassName:"chart-range-overlay-outer",overlayItem:n.a.createElement("button",{className:"filter-charts-button btn btn-sm btn-dark"},l)},n.a.createElement("div",{className:"chart-range-overlay"},n.a.createElement("div",{className:"buttons"},n.a.createElement(ke,{text:"Single",active:"S"===s,onToggle:function(e){m({type:e?"S":null})}}),n.a.createElement(ke,{text:"Double",active:"D"===s,onToggle:function(e){m({type:e?"D":null})}})),n.a.createElement(He,{range:r,min:v[0],max:v[1],onChange:function(e){return m({range:e})}}),n.a.createElement("div",{className:"inputs"},n.a.createElement("button",{className:"btn btn-sm btn-dark",onClick:function(){return m({range:[Math.max(r[0]-1,v[0]),r[1]]})}},n.a.createElement(k.e,null)),n.a.createElement(je,{type:"number",className:"form-control",min:v[0],max:Math.min(v[1],r[1]),value:r[0],onBlur:function(e){m({range:[e,r[1]]})}}),n.a.createElement("button",{className:"btn btn-sm btn-dark",onClick:function(){var e=Math.min(r[0]+1,v[1]);m({range:[e,r[1]<e?e:r[1]]})}},n.a.createElement(k.f,null)),n.a.createElement("div",{className:"_flex-fill"}),n.a.createElement("button",{className:"btn btn-sm btn-dark",onClick:function(){var e=Math.max(r[1]-1,v[0]);m({range:[r[0]>e?e:r[0],e]})}},n.a.createElement(k.e,null)),n.a.createElement(je,{type:"number",className:"form-control",min:Math.max(v[0],r[0]),max:v[1],value:r[1],onBlur:function(e){return m({range:[r[0],e]})}}),n.a.createElement("button",{className:"btn btn-sm btn-dark",onClick:function(){return m({range:[r[0],Math.min(r[1]+1,v[1])]})}},n.a.createElement(k.f,null))),n.a.createElement("div",{className:"buttons-duration"},n.a.createElement(ke,{text:"Standard",active:c.includes(O.STD),onToggle:function(e){m({duration:e?[].concat(Object(De.a)(c),[O.STD]):f.a.without([O.STD],c)})}}),n.a.createElement(ke,{text:"Short",active:c.includes(O.SHORT),onToggle:function(e){m({duration:e?[].concat(Object(De.a)(c),[O.SHORT]):f.a.without([O.SHORT],c)})}}),n.a.createElement(ke,{text:"Remix",active:c.includes(O.REMIX),onToggle:function(e){m({duration:e?[].concat(Object(De.a)(c),[O.REMIX]):f.a.without([O.REMIX],c)})}}),n.a.createElement(ke,{text:"Full",active:c.includes(O.FULL),onToggle:function(e){m({duration:e?[].concat(Object(De.a)(c),[O.FULL]):f.a.without([O.FULL],c)})}})))))}var Ue=a(57),Ge=a.n(Ue);const qe=[{threshold:0,iconName:"0.png",color:"bronze"},{threshold:1e3,iconName:"1.png",color:"bronze"},{threshold:2e3,iconName:"2.png",color:"bronze"},{threshold:3e3,iconName:"3.png",color:"bronze"},{threshold:4e3,iconName:"4.png",color:"bronze"},{threshold:5e3,iconName:"5.png",color:"bronze"},{threshold:6250,iconName:"6.png",color:"bronze"},{threshold:7500,iconName:"7.png",color:"bronze"},{threshold:8750,iconName:"8.png",color:"bronze"},{threshold:1e4,iconName:"9.png",color:"silver"},{threshold:12e3,iconName:"10.png",color:"silver"},{threshold:14e3,iconName:"11.png",color:"silver"},{threshold:16e3,iconName:"12.png",color:"silver"},{threshold:18e3,iconName:"13.png",color:"silver"},{threshold:22e3,iconName:"14.png",color:"silver"},{threshold:26e3,iconName:"15.png",color:"silver"},{threshold:3e4,iconName:"16.png",color:"silver"},{threshold:35e3,iconName:"17.png",color:"silver"},{threshold:4e4,iconName:"18.png",color:"gold"},{threshold:5e4,iconName:"19.png",color:"gold"},{threshold:6e4,iconName:"20.png",color:"gold"},{threshold:7e4,iconName:"21.png",color:"gold"},{threshold:8e4,iconName:"22.png",color:"gold"},{threshold:1e5,iconName:"23.png",color:"gold"},{threshold:12e4,iconName:"24.png",color:"gold"},{threshold:14e4,iconName:"25.png",color:"gold"},{threshold:16e4,iconName:"26.png",color:"gold"},{threshold:18e4,iconName:"27.png",color:"green"}],Ve={F:.1,D:.2,"D+":.3,C:.3,"C+":.5,B:.5,"B+":.8,A:.8,"A+":1,S:1.1,SS:1.2,SSS:1.2},ze=(e,t)=>{if(!e.isBestGradeOnChart)return 0;if("COOP"===t.chartType)return 1e3*t.chartLevel*(Ve[e.grade]||.8)/8;return t.chartLevel**2.31*(Ve[e.grade]||.8)/9},Ye=e=>e&&n.a.createElement("img",{className:e.color,src:"".concat(".","/ranks/").concat(e.iconName),alt:e.threshold});var Xe=a(20),Je={"500 \u043a\u043e\u043c\u0431\u043e":{icon:Xe.f,description:"\u0417\u0430\u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c 500+ \u043a\u043e\u043c\u0431\u043e \u043d\u0430 \u043b\u044e\u0431\u043e\u043c \u0447\u0430\u0440\u0442\u0435",resultFunction:function(e,t,a){return{progress:100===a.progress?100:e.combo>=500?100:0}}},"1000 \u043a\u043e\u043c\u0431\u043e":{icon:Xe.g,description:"\u0417\u0430\u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c 1000+ \u043a\u043e\u043c\u0431\u043e \u043d\u0430 \u043b\u044e\u0431\u043e\u043c \u0447\u0430\u0440\u0442\u0435",resultFunction:function(e,t,a){return{progress:100===a.progress?100:e.combo>=1e3?100:0}}},"2000 \u043a\u043e\u043c\u0431\u043e":{icon:Xe.h,description:"\u0417\u0430\u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c 2000+ \u043a\u043e\u043c\u0431\u043e \u043d\u0430 \u043b\u044e\u0431\u043e\u043c \u0447\u0430\u0440\u0442\u0435",resultFunction:function(e,t,a){return{progress:100===a.progress?100:e.combo>=2e3?100:0}}},"\u041c\u0430\u0441\u0442\u0435\u0440 \u0444\u0438\u043d\u0433\u0435\u0440\u0438\u043d\u0433\u0430":{icon:Xe.j,description:"\u0421\u044b\u0433\u0440\u0430\u0442\u044c \u0432\u0441\u0435 Fingers \u0442\u0440\u0435\u043a\u0438",initialState:{progress:0,playedSongs:[],songsToPlay:["Monkey Fingers","Kimchi Fingers","Monkey Fingers 2","Money Fingers"]},resultFunction:function(e,t,a){var r=a.songsToPlay.includes(t.song)?f.a.uniq([].concat(Object(De.a)(a.playedSongs),[t.song])):a.playedSongs;return{playedSongs:r,songsToPlay:a.songsToPlay,progress:100*r.length/a.songsToPlay.length}}},"8-bit":{icon:Xe.i,description:"\u0421\u044b\u0433\u0440\u0430\u0442\u044c Seize My Day, Tales of Pumpnia \u0438 Pumptris (8bit ver.)",initialState:{progress:0,playedSongs:[],songsToPlay:["Seize My Day","Tales of Pumpnia","Pumptris (8bit ver.)"]},resultFunction:function(e,t,a){var r=a.songsToPlay.includes(t.song)?f.a.uniq([].concat(Object(De.a)(a.playedSongs),[t.song])):a.playedSongs;return{playedSongs:r,songsToPlay:a.songsToPlay,progress:100*r.length/a.songsToPlay.length}}},"Love is...":{icon:Xe.c,description:"\u0421\u044b\u0433\u0440\u0430\u0442\u044c \u0432\u0441\u0435 Love is a Danger Zone \u0442\u0440\u0435\u043a\u0438",initialState:{progress:0,playedSongs:[],songsToPlay:["Love is a Danger Zone","Love is a Danger Zone [SHORT]","Love is a Danger Zone (Cranky Mix)","Love is a Danger Zone 2","Love is a Danger Zone 2 [SHORT]","Love is a Danger Zone 2 [FULL]","Love is a Danger Zone 2 (D&G Ver.)","Love is a Danger Zone (try to B.P.M.)"]},resultFunction:function(e,t,a){var r=a.songsToPlay.includes(t.song)?f.a.uniq([].concat(Object(De.a)(a.playedSongs),[t.song])):a.playedSongs;return{playedSongs:r,songsToPlay:a.songsToPlay,progress:100*r.length/a.songsToPlay.length}}},"\u0423\u043b\u0438\u0442\u043a\u0430":{icon:Xe.k,description:"\u041c\u0430\u0441\u0442\u0435\u0440 \u0437\u0430\u043c\u0435\u0434\u043b\u0435\u043d\u0438\u0439: \u0441\u044b\u0433\u0440\u0430\u0442\u044c \u0441\u0442\u0430\u0440\u0448\u0438\u0435 \u0447\u0430\u0440\u0442\u044b Twist of Fate, Karyawisata, Awakening \u0438 Moonlight",initialState:{progress:0,playedSongs:[],songsToPlay:[{song:"Twist of Fate (feat. Ruriling)",charts:["D20","S19"]},{song:"Karyawisata",charts:["S20","D16"]},{song:"Awakening",charts:["S19","D20"]},{song:"Moonlight",charts:["S19","D21"]}]},resultFunction:function(e,t,a){var r=a.songsToPlay.some((function(e){return t.song===e.song&&e.charts.includes(t.chartLabel)}))?f.a.uniq([].concat(Object(De.a)(a.playedSongs),[t.song])):a.playedSongs;return{playedSongs:r,songsToPlay:a.songsToPlay,progress:100*r.length/a.songsToPlay.length}}},"\u041a\u043e\u0440\u0438\u0447\u043d\u0435\u0432\u0430\u044f S":{icon:Xe.d,description:"\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c S, \u043d\u043e 5+ \u0431\u044d\u0434\u043e\u0432",resultFunction:function(e,t,a){return{progress:100===a.progress?100:0===e.miss&&e.bad>=5?100:0}}},"\u041c\u044b \u0432\u044b\u0436\u0438\u0432\u0430\u043b\u0438 \u043a\u0430\u043a \u043c\u043e\u0433\u043b\u0438":{icon:Xe.b,description:"\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c B \u0438\u043b\u0438 \u043d\u0438\u0436\u0435, \u043d\u043e \u0443\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u043b\u0430\u0439\u0444\u0431\u0430\u0440",resultFunction:function(e,t,a){return{progress:100===a.progress?100:["B+","C+","D+"].includes(e.grade)?100:0}}},"\u041f\u0430\u0434\u043e\u0432\u044b\u0439 \u043c\u0438\u0441\u0441":{icon:Xe.l,description:"\u041a\u043e\u0433\u0434\u0430 \u043e\u0442 SSS \u0442\u0435\u0431\u044f \u0443\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u044e\u0442 \u0442\u043e\u043b\u044c\u043a\u043e \u043c\u0438\u0441\u0441\u044b \u0438\u0437-\u0437\u0430 \u043f\u043b\u043e\u0445\u043e\u0433\u043e \u043c\u043e\u0434\u0434\u0438\u043d\u0433\u0430 \u043f\u0430\u0434\u043e\u0432",resultFunction:function(e,t,a){return{progress:100===a.progress?100:e.miss>0&&0===e.bad&&0===e.good&&0===e.great?100:0}}}},Qe={progress:0};const Ze=(e,t)=>"SSS"===t?e-3e5:"SS"===t?e-15e4:"S"===t?e-1e5:e;var $e=a(181),et=a.n($e),tt=a(182),at=a.n(tt);function rt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}const nt=(e,t)=>{return f.a.mapValues(e=>{const a=["A","A+","S","SS","SSS"];e.expRank=f.a.findLast(t=>t.threshold<=e.exp,qe),e.expRankNext=f.a.find(t=>t.threshold>e.exp,qe),e.progress={double:{SS:{},S:{},"A+":{},A:{}},single:{SS:{},S:{},"A+":{},A:{}}};const r={SSS:["SS","S","A+","A"],SS:["SS","S","A+","A"],S:["S","A+","A"],"A+":["A+","A"],A:["A"]};return e.accuracyPointsRaw=[],f.a.keys(e.resultsByLevel).forEach(t=>{e.resultsByLevel[t].forEach(n=>{!n.result.isRank&&n.result.accuracyRaw&&e.accuracyPointsRaw.push([f.a.toNumber(t),n.result.accuracyRaw,n.result.sharedChartId]);const s=n.result.grade,c=n.result.playerId,l=n.chart.results.filter(e=>e.playerId===c);if(l.length>1){if(l.sort((e,t)=>a.indexOf(t.grade)-a.indexOf(e.grade))[0].grade!==s)return}const o=r[s];o&&o.forEach(a=>{((t,a,r)=>{const n="S"===r||"SP"===r?e.progress.single:"D"===r||"DP"===r?e.progress.double:null;n&&(n[a][t]=n[a][t]?n[a][t]+1:1)})(t,a,n.chart.chartType)})})}),["single","double"].forEach(a=>{e.progress["".concat(a,"-bonus")]=0,f.a.keys(e.progress[a]).forEach(r=>{e.progress[a]["".concat(r,"-bonus")]=0,f.a.keys(e.progress[a][r]).forEach(n=>{const s=e.progress[a][r][n],c=(e=>Math.round(Math.min(e,1+e/20+.7*Math.sqrt(Math.max(e-1,0)))))(t.data["".concat(a,"sLevels")][n]),l=Math.min(1,s/c),o=(e=>30*(1+2**(e/4))/11)(n)*l;e.progress[a][r]["".concat(n,"-bonus")]=o,e.progress[a][r]["".concat(n,"-bonus-coef")]=l,e.progress[a][r]["".concat(n,"-min-number")]=c,e.progress[a][r]["".concat(n,"-achieved-number")]=s,o>=e.progress[a]["".concat(r,"-bonus")]&&(e.progress[a]["".concat(r,"-bonus")]=o,e.progress[a]["".concat(r,"-bonus-level")]=n,e.progress[a]["".concat(r,"-bonus-level-coef")]=l,e.progress[a]["".concat(r,"-bonus-level-min-number")]=c,e.progress[a]["".concat(r,"-bonus-level-achieved-number")]=s)}),e.progress["".concat(a,"-bonus")]+=e.progress[a]["".concat(r,"-bonus")]})}),e.progress.bonus=e.progress["double-bonus"]+e.progress["single-bonus"],e.achievementBonus=e.progress.bonus,e.accuracy=e.countAcc>0?Math.round(e.sumAccuracy/e.countAcc*100)/100:null,e},e)},st=({sharedCharts:e,profiles:t,debug:a})=>{return f.a.mapValues(e=>{const r=e.results.map(r=>{const n=t[r.playerId];if(!n||!r.accuracy||r.isRank||f.a.size(n.accuracyPointsRaw)<50)return null;if(!n.accuracyPointsInterpolated){const e=f.a.maxBy(([e,t])=>t,n.accuracyPointsRaw)[1],t=f.a.maxBy(([e,t])=>e,f.a.filter(([t,a])=>a===e,n.accuracyPointsRaw))[0],a=n.accuracyPointsRaw.filter(([e,a])=>e>=t-1).map(([e,t])=>[30-e,101-t]),r=at.a.logarithmic(a),s=e=>{const t=101-r.predict(30-e)[1];return Math.max(0,Math.min(t,100))},c=[];for(let n=1;n<=28;n+=.05)c.push([n,s(n)]);n.accuracyPointsInterpolated=c}const s=f.a.find(e=>e[1]<r.accuracyRaw,n.accuracyPointsInterpolated),c={interpolatedDifficulty:s&&s[0],weight:r.accuracyRaw>98?1-(r.accuracyRaw-98)/2:r.accuracyRaw<80?Math.max(0,(r.accuracyRaw-50)/30):1};return c.weight*=Math.min(1,Math.max(.1,(8-Math.abs(c.interpolatedDifficulty-e.chartLevel))/8)),a&&(r.interpolation=c),c}).filter(f.a.identity).reduce((e,t)=>t.interpolatedDifficulty?{diffSum:e.diffSum+t.interpolatedDifficulty*t.weight,weightSum:e.weightSum+t.weight}:e,{diffSum:0,weightSum:0});r.diffSum+=2*f.a.toNumber(e.chartLevel),r.weightSum+=2;const n=r.diffSum/r.weightSum;return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?rt(Object(a),!0).forEach((function(t){Object(i.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):rt(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e,{interpolatedDifficulty:n})},e)},ct=({profiles:e,sharedCharts:t,tracklist:a,battles:r,debug:n})=>{const s=(({profiles:e,sharedCharts:t})=>{const a={};for(const r in t){const n=t[r],s=n.results,c=Number(n.interpolatedDifficulty||n.chartLevel)**2.2/7.6;if(n.maxScore){const t=n.maxScore;for(const r of s)if(!r.isRank&&t){const s=Math.max(0,Math.min(1,r.scoreRaw/t-.3)/.7),l=s*c;a[r.id]={pp:{pp:l,k:s,maxScore:t,maxPP:c,ppPotential:c-l,ppRatio:l/c,ppFixed:Number(l.toFixed(1))}};const o=e[r.playerId];o&&(o.pp||(o.pp={scores:[],pp:0}),o.pp.scores.push({pp_:Number(l.toFixed(1)),s:n.song,l:n.chartLabel,pp:l,result:r,chart:n,K:s}))}}}for(const r in e){const t=e[r];t.pp?(t.pp.scores.sort((e,t)=>t.pp-e.pp),t.pp.pp=0,t.pp.scores.forEach((e,a)=>{t.pp.pp+=.95**a*e.pp}),t.rating=t.pp.pp):(t.pp={},t.rating=0)}return f.a.flow(f.a.values,f.a.orderBy(e=>e.rating,"desc"),e=>e.forEach((e,t)=>{e.ratingHistory.push({rating:e.rating,date:e.firstResultDate}),e.rankingHistory.push({place:t+1,date:e.firstResultDate})}))(e),a})({profiles:e=nt(e,a),sharedCharts:t=st({debug:n,sharedCharts:t,profiles:e})}),c=(({battles:e,profiles:t,debug:a,resultInfo:r})=>{let n="";const s={},c=(e,t)=>"".concat(e.playerId,"vs").concat(t.playerId,"-").concat(e.sharedChartId,"-").concat(e.isRank),l={},o=e=>"".concat(e.playerId,"-").concat(e.sharedChartId,"-").concat(e.isRank);return e.forEach(([e,i,m])=>{const d=t[e.playerId],p=t[i.playerId],u=e.isRank?1.2:1;let h=null;m.maxScore&&(h=m.maxScore*u,Math.max(h,e.score,i.score)===h||e.isRank||e.isExactDate&&i.isExactDate||(h*=1.2),Math.max(h,e.score,i.score)!==h&&(h=Math.max(h,e.score,i.score)+1e4)),r[e.id]||(r[e.id]={}),r[i.id]||(r[i.id]={});const g=r[e.id],E=r[i.id];g.startingRating||(g.startingRating=d.rating),E.startingRating||(E.startingRating=p.rating),d.battleCount++,p.battleCount++;const b=d.rating,y=p.rating,v=10**(b/400),O=10**(y/400),N=v/(v+O),P=O/(v+O);let k,S,j=e.score,w=i.score;j===w?k=S=.5:h&&0!==j&&0!==w?(k=5*((w=h/w-1)/((j=h/j-1)+w)-.5)+.5,S=5*(j/(j+w)-.5)+.5):S=1-(k=j>w?1:w<j?0:.5),k=Math.max(0,Math.min(1,k)),S=Math.max(0,Math.min(1,S));const x=Math.max(0,Math.min(1,(b-700)/800)),D=Math.max(0,Math.min(1,(y-700)/800)),R=20+20*x,C=20+20*D,L=Number(m.interpolatedDifficulty||m.chartLevel),_=Math.max(1,Math.min(R,(L/25)**(5*(x-.5)+2.5)*R)),I=Math.max(1,Math.min(C,(L/25)**(5*(D-.5)+2.5)*C)),A=Math.min(_,I);let T=1;m.maxScore&&(e.grade.startsWith("SS")||0===e.miss&&0===e.bad)&&(i.grade.startsWith("SS")||0===i.miss&&0===i.bad)&&e.score/h>.98&&i.score/h>.98&&(T=Math.max(Math.min(1,Math.max(100-100*e.score/h,100-100*i.score/h)/2),0)**2);const M=A*T,F=A*T;let B=M*(k-N),H=F*(S-P);B=B<0&&"SSS"===e.grade?0:B,H=H<0&&"SSS"===i.grade?0:H;const K=c(e,i),W=c(i,e),U=s[K]||0,G=s[W]||0;s[K]=B,s[W]=H,d.rating=d.rating+B-U,p.rating=p.rating+H-G;const q=o(e),V=o(i);l[q]=(l[q]||0)+B-U,l[V]=(l[V]||0)+H-G,g.ratingDiff=l[q],g.ratingDiffLast=B-U,E.ratingDiff=l[V],E.ratingDiffLast=H-G,a&&(n+="".concat(m.chartLabel," - ").concat(m.song," (").concat(m.sharedChartId,") - ").concat(t[e.playerId].name," / ").concat(t[i.playerId].name,"\n- ").concat(e.score," / ").concat(i.score," (").concat(Math.floor(h)," (").concat(Math.floor(m.maxScore*u),")) - R ").concat(k.toFixed(2),"/").concat(S.toFixed(2)," E ").concat(N.toFixed(2)," / ").concat(P.toFixed(2),"\n- Rating ").concat(b.toFixed(2)," / ").concat(y.toFixed(2)," - ").concat(B.toFixed(2)," / ").concat(H.toFixed(2)," - K ").concat(M.toFixed(2)," ").concat(F.toFixed(2)).concat(1===T?"":" (coef ".concat(T.toFixed(2),")"),"\n- Base elo: ").concat(U.toFixed(2)," / ").concat(G.toFixed(2),"\n- Elo change: ").concat((B-U).toFixed(2)," / ").concat((H-G).toFixed(2),"\n- New base elo: ").concat(s[K].toFixed(2)," / ").concat(s[W].toFixed(2),"\n- RD: ").concat(l[q].toFixed(2)," / ").concat(l[V].toFixed(2),"\n")),d.rating=Math.max(100,d.rating),p.rating=Math.max(100,p.rating);const z=f.a.flow(f.a.keys,f.a.map(e=>({id:e,rating:t[e].rating})),f.a.orderBy(["rating"],["desc"]))(t),Y=e.dateObject>i.dateObject?e.dateObject:i.dateObject;z.forEach((e,a)=>{t[e.id].lastPlace!==a+1&&(t[e.id].rankingHistory.push({place:a+1,date:Y.getTime()}),t[e.id].lastPlace=a+1)});const X=f.a.last(d.ratingHistory),J=f.a.last(p.ratingHistory);X!==d.rating&&d.ratingHistory.push({rating:d.rating,date:Y.getTime()}),J!==p.rating&&p.ratingHistory.push({rating:p.rating,date:Y.getTime()})}),f.a.flow(f.a.keys,f.a.forEach(e=>{t[e].id=f.a.toInteger(e),t[e].accuracy=t[e].countAcc>0?Math.round(t[e].sumAccuracy/t[e].countAcc*100)/100:null,t[e].ratingRaw=t[e].rating,t[e].rating=Math.round(t[e].rating),t[e].rankingHistory=[...t[e].rankingHistory,{place:f.a.get("place",f.a.last(t[e].rankingHistory)),date:Date.now()}]}))(t),{logText:n}})({battles:r,profiles:e,resultInfo:s,debug:n});return{profiles:e,resultInfo:s,sharedCharts:t,logText:c.logText}};localStorage&&(window.debugOn=function(){localStorage.setItem("debug",1)},window.debugOff=function(){localStorage.removeItem("debug")});var lt=localStorage&&localStorage.getItem("debug");function ot(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function it(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ot(Object(a),!0).forEach((function(t){Object(i.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ot(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const mt="TOP/LOADING",dt="TOP/STOP_LOADING",pt="TOP/SUCCESS",ut="TOP/ERROR",ht="TOP/SET_FILTER",gt="TOP/RESET_FILTER",ft="TOP/RANKING_CHANGE_SET",Et="TOP/PROFILES_UPDATE",bt=Object({NODE_ENV:"production",PUBLIC_URL:"."}).REACT_APP_SOCKET?"results/highscores/trusted":"results/highscores",yt={rank:y.SHOW_ALL},vt={isLoading:!1,isLoadingRanking:!1,data:[],filter:yt,players:{},profiles:{},results:[],resultInfo:{},sharedCharts:{}},Ot={"?":0,F:1,D:2,"D+":3,C:4,"C+":5,B:6,"B+":7,A:8,"A+":9,S:10,SS:11,SSS:12},Nt=e=>0===e.misses&&0===e.bads&&0===e.goods?0===e.greats?"SSS":"SS":e.grade,Pt=(e,t,a)=>{if("undefined"===typeof e.recognition_notes)return{id:e.id,isUnknownPlayer:"PUMPITUP"===t[e.player].arcade_name,isIntermediateResult:!0,sharedChartId:e.shared_chart,playerId:e.player,nickname:t[e.player].nickname,nicknameArcade:t[e.player].arcade_name,date:e.gained,dateObject:he(e.gained),grade:e.grade,isExactDate:!!e.exact_gain_date,score:e.score,scoreRaw:Ze(e.score,e.grade),isRank:!!e.rank_mode};let r={isUnknownPlayer:"PUMPITUP"===t[e.player].arcade_name,isIntermediateResult:!1,sharedChartId:e.shared_chart,id:e.id,playerId:e.player,nickname:t[e.player].nickname,nicknameArcade:t[e.player].arcade_name,originalChartMix:e.original_mix,originalChartLabel:e.original_label,originalScore:e.original_score,date:e.gained,dateObject:he(e.gained),grade:"?"!==e.grade?e.grade:Nt(e),isExactDate:!!e.exact_gain_date,score:e.score,scoreRaw:Ze(e.score,e.grade),scoreIncrease:e.score_increase,calories:e.calories&&e.calories/1e3,perfect:e.perfects,great:e.greats,good:e.goods,bad:e.bads,miss:e.misses,combo:e.max_combo,mods:e.mods_list,isRank:!!e.rank_mode,isHJ:(e.mods_list||"").split(" ").includes("HJ"),isMachineBest:"machine_best"===e.recognition_notes,isMyBest:"personal_best"===e.recognition_notes};((e,t)=>{if(!t)return;const a=[e.perfect,e.great,e.good,e.bad,e.miss];let r=-1,n=0,s=0;for(let c=0;c<5;++c)f.a.isNumber(a[c])?s+=a[c]:(r=c,n++);1===n&&(e[["perfect","great","good","bad","miss"][r]]=t-s)})(r,a.maxTotalSteps);const n=10*Math.sqrt(r.perfect),s=n?Math.floor((100*n+85*r.great+60*r.good+20*r.bad+-25*r.miss)/(n+r.great+r.good+r.bad+r.miss)*100)/100:null,c=r.perfect?Math.floor((100*r.perfect+85*r.great+60*r.good+20*r.bad+-25*r.miss)/(r.perfect+r.great+r.good+r.bad+r.miss)*100)/100:null;return r.accuracy=s<0?0:100===c?100:s&&+s.toFixed(2),r.accuracyRaw=f.a.toNumber(r.accuracy),r},kt=e=>e.scoreRaw/e.accuracy*100/(e.isRank?1.2:1),St=(e,t,a)=>{const r=e.playerId,n=f.a.fromPairs(Array.from({length:28}).map((e,t)=>[t+1,[]]));t[r]={name:e.nickname,nameArcade:e.nicknameArcade,resultsByGrade:{},resultsByLevel:n,firstResultDate:e.dateObject,lastResultDate:e.dateObject,count:0,battleCount:0,countAcc:0,grades:{F:0,D:0,C:0,B:0,A:0,S:0,SS:0,SSS:0},sumAccuracy:0,rankingHistory:[],ratingHistory:[],lastPlace:null,lastBattleDate:0,region:a[r].region},t[r].achievements=f.a.flow(f.a.keys,f.a.map(e=>[e,it({},Je[e].initialState||Qe)]),f.a.fromPairs)(Je),t[r].exp=0},jt=(e,t,a)=>{const r=a[e.playerId];r.count++,e.accuracy&&(r.countAcc++,r.sumAccuracy+=e.accuracy),r.grades[e.grade.replace("+","")]++,"COOP"!==t.chartType&&e.isBestGradeOnChart&&(r.resultsByGrade[e.grade]=[...r.resultsByGrade[e.grade]||[],{result:e,chart:t}],r.resultsByLevel[t.chartLevel]=[...r.resultsByLevel[t.chartLevel]||[],{result:e,chart:t}]),e.isExactDate&&r.lastResultDate<e.dateObject&&(r.lastResultDate=e.dateObject),r.achievements=f.a.mapValues.convert({cap:!1})((a,n)=>Je[n].resultFunction(e,t,a,r),r.achievements),r.exp+=ze(e,t)};const wt=()=>async(e,t)=>{e({type:mt});try{const t=await e(I({url:"".concat(F,"/").concat(bt)}));if(t.error)throw new Error(t.error);e(xt(t))}catch(a){console.log(a),e({type:ut,error:a})}},xt=e=>async(t,a)=>{const r=a().tracklist,n=((e,t)=>{const a=e.players,r=e.results,n=e.shared_charts,s=[],c=e=>"".concat(e.sharedChartId,"-").concat(e.playerId,"-").concat(e.isRank),l=e=>"".concat(e.sharedChartId,"-").concat(e.playerId),o={},i={},m={},d=[];let p={};for(let u of r){if(!a[u.player])continue;const e=u.shared_chart;if(!m[e]){const t=n[e],a=f.a.toUpper(t.chart_label),r=a.match(/(\D+)|(\d+)/g),s=Object(P.a)(r,2),c=s[0],l=s[1];m[e]={song:t.track_name,chartLabel:a,chartLevel:l,chartType:c,duration:t.duration,sharedChartId:e,maxTotalSteps:t.max_total_steps,results:[],allResultsIds:[]}}const t=m[e],r=Pt(u,a,t);s.push(r);const p=c(r),h=o[p];if(!h||h.score<r.score){if(h){const e=t.results.indexOf(h);-1!==e&&t.results.splice(e,1)}const e=f.a.sortedLastIndexBy(e=>-e.score,r,t.results);r.isUnknownPlayer&&0!==e||(t.results.splice(e,0,r),t.latestScoreDate=r.date,t.allResultsIds.push(r.playerId),o[p]=r),r.isUnknownPlayer||t.results.forEach(e=>{!e.isUnknownPlayer&&e.isRank===r.isRank&&e.playerId!==r.playerId&&r.score&&e.score&&d.push([r,e,t])})}if(!r.isIntermediateResult){const e=l(r),t=i[e];(!t||Ot[t.grade]<=Ot[r.grade])&&(t&&(t.isBestGradeOnChart=!1),r.isBestGradeOnChart=!0,i[e]=r)}}for(let u in m){const e=m[u];e.maxScore=null;for(let t of e.results){if(!t.isRank)if(t.accuracy){const a=kt(t);e.maxScore<a&&(e.maxScore=a)}else e.maxScore&&e.maxScore<t.score&&(e.maxScore=t.score);t.isUnknownPlayer||t.isIntermediateResult||(p[t.playerId]||St(t,p,a),jt(t,e,p))}}return{mappedResults:s,profiles:p,sharedCharts:m,battles:d}})(e),s=n.sharedCharts,c=n.mappedResults,l=n.profiles,o=n.battles;t({type:pt,data:f.a.values(s),players:f.a.flow(f.a.toPairs,f.a.map(([e,t])=>it({},t,{id:f.a.toInteger(e)})))(e.players),results:c,profiles:l,sharedCharts:s,originalData:e});const i={sharedCharts:s,profiles:l,tracklist:r,battles:o,debug:lt};let m,d;m=window.Worker?(d=new et.a).getProcessedProfiles(i):new Promise(e=>e(ct(i)));const p=await m;lt&&console.log(p.logText),lt&&console.log("Processed profiles:",Object.values(p.profiles).filter(e=>e.pp).sort((e,t)=>t.pp.pp-e.pp.pp)),t(it({type:Et},p)),t(Lt(p.profiles)),d&&d.terminate()},Dt=e=>({type:ht,filter:e}),Rt=f.a.map("id"),Ct=f.a.flow(f.a.map(e=>[e.id,e.rating]),f.a.fromPairs),Lt=e=>async(t,a)=>{try{const a=f.a.orderBy("ratingRaw","desc",f.a.values(e)),r=await Promise.all([p.a.getItem("lastChangedRanking_v3"),p.a.getItem("lastChangedRankingPoints_v3"),p.a.getItem("lastFetchedRanking_v3")]),n=Object(P.a)(r,3),s=n[0],c=n[1],l=n[2],o=Rt(a),i=Rt(l),m=Rt(s),d=Ct(a),u=Ct(l);let h=Ct(c);f.a.isEqual(d,u)||(p.a.setItem("lastChangedRankingPoints_v3",l),h=u);let g=m;f.a.isEqual(o,i)||(p.a.setItem("lastChangedRanking_v3",l),g=i),t({type:ft,listNow:o,listPrev:g,rankingsPointsMap:h}),p.a.setItem("lastFetchedRanking_v3",a)}catch(r){console.warn("Cannot get ranking from local storage",r)}};function _t(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function It(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?_t(Object(a),!0).forEach((function(t){Object(i.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):_t(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var At="PRESETS/SELECT_PRESET",Tt="PRESETS/LOAD_PRESETS",Mt="PRESETS/LOADING_START",Ft="PRESETS/LOADING_END",Bt={presets:[],currentPreset:null,isLoading:!1},Ht=function(e){return e&&It({},e,{label:e.name,value:e.name})};var Kt=function(e){return{type:Tt,presets:e||[]}},Wt=function(){return{type:Mt}},Ut=function(){return{type:Ft}},Gt=function(e){return{type:At,currentPreset:e}},qt=function(){return function(e,t){e(Wt());var a=t().presets.currentPreset,r=f.a.get("name",a);return p.a.getItem("filterPresets").then((function(t){r&&f.a.find({name:r},t)?(e(Gt(a)),e(Dt(a.filter))):e(Kt(t)),e(Ut())}))}};function Vt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}var zt=n.a.createElement("button",{className:"btn btn-sm btn-dark btn-icon _margin-right"},n.a.createElement(k.m,null),"\u043f\u0440\u0435\u0441\u0435\u0442\u044b"),Yt=function(){return"\u043f\u0443\u0441\u0442\u043e"},Xt={loadPresets:function(){return function(e,t){return e(Wt()),p.a.getItem("filterPresets").then((function(t){e(Kt(t)),e(Ut())}))}},savePreset:function(e){return function(t,a){return t(Wt()),p.a.getItem("filterPresets").then((function(r){var n=a().top.filter,s={name:e,filter:n};if(f.a.some({name:e},r)){if(window.confirm("Preset with this name already exists, replace it?")){var c=f.a.remove({name:e},r),l=[].concat(Object(De.a)(c),[s]);t(Kt(l)),p.a.setItem("filterPresets",l)}}else{var o=[].concat(Object(De.a)(r||[]),[s]);t(Kt(o)),t(Gt(s)),p.a.setItem("filterPresets",o)}t(Ut())}))}},openPreset:qt,deletePreset:function(){return function(e,t){e(Wt());var a=f.a.get("name",t().presets.currentPreset);return p.a.getItem("filterPresets").then((function(t){if(f.a.find({name:a},t)&&window.confirm("Are you sure you want to delete selected preset?")){var r=f.a.remove({name:a},t);e(Kt(r)),p.a.setItem("filterPresets",r)}else e(Kt(t));e(Ut())}))}},selectPreset:Gt},Jt=function(e){function t(){var e,a;Object(ye.a)(this,t);for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return(a=Object(Oe.a)(this,(e=Object(Ne.a)(t)).call.apply(e,[this].concat(n)))).state={},a.onChangeSelection=function(e){a.props.selectPreset(e.name)},a.onRewritePreset=function(){var e=a.props.currentPreset;a.props.savePreset(e.name)},a.onSavePreset=function(){var e=a.state.name;a.props.savePreset(e),a.setState({isAddingNew:!1})},a}return Object(Pe.a)(t,e),Object(ve.a)(t,[{key:"componentDidMount",value:function(){this.props.loadPresets()}},{key:"render",value:function(){var e=this,t=this.props,a=t.presets,r=t.currentPreset,s=t.isLoading,c=this.state,l=c.name,o=c.isAddingNew;return n.a.createElement("div",null,n.a.createElement(Te,{overlayItem:zt},n.a.createElement("div",{className:"presets-control-overlay"},n.a.createElement(be.a,{className:"select _margin-bottom",classNamePrefix:"select",placeholder:"\u043f\u0440\u0435\u0441\u0435\u0442\u044b...",options:a,value:r,onChange:this.props.selectPreset,noOptionsMessage:Yt}),r&&n.a.createElement("div",{className:"buttons-presets _margin-bottom"},n.a.createElement("div",{className:"_flex-fill"}),n.a.createElement("button",{className:"btn btn-sm btn-dark btn-icon _margin-right",onClick:this.props.openPreset,disabled:s},n.a.createElement(k.i,null)," \u043e\u0442\u043a\u0440\u044b\u0442\u044c"),n.a.createElement("button",{className:"btn btn-sm btn-dark btn-icon _margin-right",onClick:this.onRewritePreset,disabled:s},n.a.createElement(k.r,null)," \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0438\u0441\u0430\u0442\u044c"),n.a.createElement("button",{className:"btn btn-sm btn-dark btn-icon",onClick:this.props.deletePreset,disabled:s},n.a.createElement(k.u,null)," \u0443\u0434\u0430\u043b\u0438\u0442\u044c")),!o&&n.a.createElement("div",{className:"buttons-presets _margin-bottom"},n.a.createElement("div",{className:"_flex-fill"}),n.a.createElement("button",{className:"btn btn-sm btn-dark btn-icon _margin-left _self-align-end",onClick:function(){return e.setState({isAddingNew:!0})},disabled:s},n.a.createElement(k.o,null)," \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c")),o&&n.a.createElement("div",{className:"adding-new _margin-bottom"},n.a.createElement(je,{value:l,placeholder:"\u0438\u043c\u044f \u043f\u0440\u0435\u0441\u0435\u0442\u0430...",className:"form-control",onChange:function(t){return e.setState({name:t})}}),n.a.createElement("button",{className:"btn btn-sm btn-dark btn-icon _margin-left",onClick:this.onSavePreset,disabled:!l||s},n.a.createElement(k.r,null)," \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),n.a.createElement("button",{className:"btn btn-sm btn-dark btn-icon _margin-left",onClick:function(){return e.setState({isAddingNew:!1})},disabled:s},"\u043e\u0442\u043c\u0435\u043d\u0430")))))}}]),t}(n.a.Component),Qt=Object(o.b)((function(e){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Vt(Object(a),!0).forEach((function(t){Object(i.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Vt(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e.presets)}),Xt)(Jt),Zt=a(88),$t=a(91),ea=a.n($t),ta=a(87),aa=a.n(ta);var ra=({region:e})=>n.a.createElement("div",{className:"flag-img",style:{backgroundImage:"url(https://osu.ppy.sh/images/flags/".concat(e,".png)")}});function na(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function sa(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?na(Object(a),!0).forEach((function(t){Object(i.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):na(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}ne.a.addLocale(ce.a);const ca=new ne.a("ru-RU"),la={flavour:"short",gradation:le.a,units:["day","week","month"]},oa=e=>{const t=ie()().startOf("day").diff(ie()(e).startOf("day"),"days");return 0===t?"\u0441\u0435\u0433\u043e\u0434\u043d\u044f":1===t?"\u0432\u0447\u0435\u0440\u0430":ca.format(e,la).replace("\u043d\u0430\u0437\u0430\u0434","")},ia=e=>sa({},e,{results:f.a.flow(f.a.get("results"),f.a.toPairs,f.a.map(([t,a])=>{const r=f.a.find(e=>f.a.every(f.a.isNumber,[e.perfects,e.greats,e.goods,e.bads,e.misses]),a.results),n=r&&[r.perfects,r.greats,r.goods,r.bads,r.misses].reduce((e,t)=>e+t,0),s=a.chart_label.match(/(\D+)|(\d+)/g),c=Object(P.a)(s,2),l=c[0],o=c[1];return{song:a.track,sharedChartId:f.a.toNumber(t),chartLabel:a.chart_label,chartLevel:o,chartType:l,mix:a.mix,duration:a.duration,results:a.results.map((t,a)=>{let r={};if(n){const e=[t.perfects,t.greats,t.goods,t.bads,t.misses];let a=-1,s=0;1===e.filter((e,t)=>f.a.isNumber(e)?(s+=e,!1):(a=t,!0)).length&&(r[["perfect","great","good","bad","miss"][a]]=n-s)}return sa({id:t.id,playerId:t.player,nickname:e.players[t.player].nickname,nicknameArcade:e.players[t.player].arcade_name,originalChartMix:t.originalChartMix,originalChartLabel:t.originalChartLabel,originalScore:t.originalScore,date:t.gained,dateObject:new Date(t.gained),grade:t.grade,isExactDate:!!t.exact_gain_date,score:t.score,scoreIncrease:t.score_increase,calories:t.calories&&t.calories/1e3,perfect:t.perfects,great:t.greats,good:t.goods,bad:t.bads,miss:t.misses,combo:t.max_combo,mods:t.mods_list,isRank:!!t.rank_mode,isHJ:(t.mods_list||"").split(" ").includes("HJ")},r)})}}),f.a.map(e=>sa({},e,{latestScoreDate:e.results.reduce((e,t)=>t.date>e?t.date:e,e.results[0].date),results:e.results.map(t=>{const a=Math.sqrt(t.perfect)*f.a.toInteger(e.chartLevel)/2,r=a?Math.floor((100*a+60*t.great+30*t.good+-20*t.miss)/(a+t.great+t.good+t.bad+t.miss)*100)/100:null,n=t.perfect?Math.floor((100*t.perfect+60*t.great+30*t.good+-20*t.miss)/(t.perfect+t.great+t.good+t.bad+t.miss)*100)/100:null;return sa({},t,{accuracy:r<0?0:100===n?100:r&&+r.toFixed(2),accuracyRaw:n,hasRankScore:f.a.some({playerId:t.playerId,isRank:!0},e.results)})})})),f.a.orderBy(["latestScoreDate","song","chartLevel"],["desc","asc","desc"]))(e)}),ma=(e,t,a=f.a.noop,n)=>{const s=Object(r.useState)(e),c=Object(P.a)(s,2),l=c[0],o=c[1],i=Object(r.useState)(e),m=Object(P.a)(i,2),d=m[0],p=m[1],u=Object(r.useRef)(t);Object(r.useEffect)(()=>{u.current!==t?(u.current=t,o(e),p(e)):e&&!f.a.isEqual(e,d)&&(o(d),p(e),a(d,e))},[e,a,d,l,t]);const h=Object(r.useCallback)(()=>{o(e),p(e)},[e]);return Object(r.useMemo)(()=>[d,l,h],[d,l,h])},da=e=>Object(r.useCallback)(()=>{f.a.values(e).forEach(e=>e[2]())},[e]);var pa=["#4DB3FF","#80B300","#FF6655","#FF99E6","#33FFCC","#e633c8","#dbe812","#FF1A66","#991AFF","#E6B333","#1AB399","#4D8066","#CC9999","#00E680","#809980","#E6FF80","#1AFF33","#999933","#E6331A","#CCCC00","#66E64D","#4D80CC","#9900B3","#4DB380","#FF4D4D"];var ua=Object(o.b)(e=>({resultInfo:e.results.resultInfo,profiles:e.results.profiles}),null,null,{forwardRef:!0})(n.a.forwardRef(({res:e,chart:t,resultInfo:a,profiles:r,placeDifference:s,showProtagonistEloChange:c=!1,showProtagonistPpChange:o=!1,protagonistName:i=null,uniqueSelectedNames:m=[],leftProfile:d={},rightProfile:p={},isSocketView:u=!1},h)=>{const g=a[e.id]||{};let b=null;lt?b=n.a.createElement(n.a.Fragment,null,n.a.createElement("span",{className:"debug-elo-info"}," ",g.startingRating&&Math.round(g.startingRating)," / ",g.ratingDiff>0?"+":"",g.ratingDiff&&Math.round(g.ratingDiff)," / ",g.pp&&g.pp.ppFixed,"pp")):e.nickname===i&&(c||o)&&(b=n.a.createElement(n.a.Fragment,null," / ",c&&g.ratingDiff&&n.a.createElement("span",null,"".concat(g.ratingDiff>0?"+":"").concat(Math.round(g.ratingDiff))),o&&g.pp&&n.a.createElement("span",null,g.pp.ppFixed,"pp")));const y=r[e.playerId]?n.a.createElement(ra,{region:r[e.playerId].region}):null,v=m.indexOf(e.nickname);return n.a.createElement("tr",{key:e.id,ref:h,className:j()({empty:!e.accuracy,latest:e.date===t.latestScoreDate,left:e.nickname===d.name,right:e.nickname===p.name}),style:v>-1?{background:pa[v]+"3A",outline:"1px solid ".concat(pa[v],"A0")}:{}},!u&&n.a.createElement("td",{className:"place"},e.isSecondOccurenceInResults?"":"#".concat(e.topPlace)),n.a.createElement("td",{className:"nickname",style:v>-1?{fontWeight:"bold"}:{}},n.a.createElement("div",{className:"nickname-container"},y,n.a.createElement("span",{className:"nickname-text"},n.a.createElement(l.c,{exact:!0,to:E.profile.getPath({id:e.playerId})},e.nickname),!!s&&n.a.createElement("span",{className:"change-holder up"},n.a.createElement("span",null,s),n.a.createElement(k.b,null)),b),!u&&n.a.createElement("div",{className:"mods-container"},u&&e.mods&&e.mods.split(" ").filter(e=>e.includes("AV")).map(e=>n.a.createElement("div",{className:"mod av-mod"},n.a.createElement("div",{className:"av-text"},"AV"),n.a.createElement("div",{className:"av-number"},e.replace("AV","")))),u&&e.mods&&e.mods.split(" ").filter(e=>e.endsWith("X")).map(e=>n.a.createElement("div",{className:"mod x-mod"},n.a.createElement("div",{className:"x-number"},e))),e.isRank&&n.a.createElement("div",{className:"mod vj"},e.isExactDate?"R":"R?"),e.isHJ&&n.a.createElement("div",{className:"mod hj"},"HJ")))),n.a.createElement("td",{className:"score"},n.a.createElement(Te,{overlayClassName:"score-overlay-outer",overlayItem:n.a.createElement("span",{className:"score-span"},e.scoreIncrease>.8*e.score&&"*",ea()(e.score).format("0,0")),placement:"top"},n.a.createElement("div",{className:"score-overlay"},lt&&n.a.createElement(n.a.Fragment,null,n.a.createElement("div",null,n.a.createElement("span",{className:"_grey"},"result id: "),e.id),n.a.createElement("div",null,n.a.createElement("span",{className:"_grey"},"player id: "),e.playerId)),n.a.createElement("div",null,n.a.createElement("span",{className:"_grey"},"\u0438\u0433\u0440\u043e\u043a: "),n.a.createElement(l.c,{exact:!0,to:E.profile.getPath({id:e.playerId})},e.nickname," (",e.nicknameArcade,")")),!!ze(e,t)&&n.a.createElement("div",{className:"important"},n.a.createElement("span",{className:"_grey"},"\u043e\u043f\u044b\u0442: "),"+",ea()(ze(e,t)).format("0,0")),f.a.isNumber(g.startingRating)&&f.a.isNumber(g.ratingDiff)&&n.a.createElement("div",{className:"important"},n.a.createElement("span",{className:"_grey"},"\u044d\u043b\u043e: ",g.startingRating.toFixed(0)," "),g.ratingDiff>=0?"+".concat(g.ratingDiff.toFixed(0)):g.ratingDiff.toFixed(0)),g.pp&&n.a.createElement("div",{className:"important"},n.a.createElement("span",{className:"_grey"},"pp: "),n.a.createElement("span",null,g.pp.ppFixed,"pp")),!e.isExactDate&&n.a.createElement("div",{className:"warning"},n.a.createElement(k.h,null),"\u0440\u0435\u043a\u043e\u0440\u0434 \u0432\u0437\u044f\u0442 \u0441 my best. \u0447\u0430\u0441\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0445 \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u0430"),!!e.isExactDate&&n.a.createElement(n.a.Fragment,null,!!e.mods&&n.a.createElement("div",null,n.a.createElement("span",{className:"_grey"},"\u043c\u043e\u0434\u044b: "),e.mods),!!e.calories&&n.a.createElement("div",null,n.a.createElement("span",{className:"_grey"},"\u043a\u043a\u0430\u043b: "),e.calories),!!e.scoreIncrease&&n.a.createElement("div",null,n.a.createElement("span",{className:"_grey"},"\u043f\u0440\u0438\u0440\u043e\u0441\u0442: "),"+",ea()(e.scoreIncrease).format("0,0")),e.originalChartMix&&n.a.createElement("div",null,n.a.createElement("div",{className:"warning"},n.a.createElement(k.h,null),"\u0431\u044b\u043b\u043e \u0441\u044b\u0433\u0440\u0430\u043d\u043e \u043d\u0430 ",e.originalChartMix),e.originalChartLabel&&n.a.createElement("div",null,n.a.createElement("span",{className:"_grey"},"\u043e\u0440\u0438\u0433\u0438\u043d\u0430\u043b\u044c\u043d\u044b\u0439 \u0447\u0430\u0440\u0442: "),e.originalChartLabel),e.originalScore&&n.a.createElement("div",null,n.a.createElement("span",{className:"_grey"},"\u043e\u0440\u0438\u0433\u0438\u043d\u0430\u043b\u044c\u043d\u044b\u0439 \u0441\u043a\u043e\u0440: "),e.originalScore)),e.scoreIncrease>.8*e.score&&"* \u0441\u0430\u0439\u0442\u0440\u0438\u0434")))),n.a.createElement("td",{className:"grade"},n.a.createElement("div",{className:"img-holder"},e.grade&&"?"!==e.grade&&n.a.createElement("img",{src:"".concat(".","/grades/").concat(e.grade,".png"),alt:e.grade}),"?"===e.grade&&null)),u&&n.a.createElement("td",{className:j()("mods",{vj:e.isRank,hj:e.isHJ})},n.a.createElement("div",{className:"mods-container"},u&&e.mods&&e.mods.split(" ").filter(e=>e.includes("AV")).map(e=>n.a.createElement("div",{className:"av-mod"},n.a.createElement("div",{className:"av-text"},"AV"),n.a.createElement("div",{className:"av-number"},e.replace("AV","")))),u&&e.mods&&e.mods.split(" ").filter(e=>e.endsWith("X")).map(e=>n.a.createElement("div",{className:"x-mod"},n.a.createElement("div",{className:"x-number"},e))),e.isRank&&n.a.createElement("div",{className:"inner"},e.isExactDate?"R":"R?"),e.isHJ&&n.a.createElement("div",{className:"inner"},"HJ"))),n.a.createElement("td",{className:"number miss"},e.miss),n.a.createElement("td",{className:"number bad"},e.bad),n.a.createElement("td",{className:"number good"},e.good),n.a.createElement("td",{className:"number great"},e.great),n.a.createElement("td",{className:"number perfect"},e.perfect),n.a.createElement("td",{className:"combo"},e.combo,e.combo?"x":""),n.a.createElement("td",{className:"accuracy"},100===e.accuracy?100:e.accuracy?e.accuracy.toFixed(2):"",e.accuracy?"%":""),n.a.createElement("td",{className:j()("date",{latest:e.date===t.latestScoreDate})},u?oa(e.dateObject):n.a.createElement(aa.a,{content:pe(e),tooltipClassName:"pumpking-tooltip"},oa(e.dateObject),e.isExactDate?"":"?")))})),ha=({type:e,level:t})=>n.a.createElement("div",{className:j()("chart-name",{single:"S"===e,singlep:"SP"===e,doublep:"DP"===e,double:"D"===e,coop:"COOP"===e})},n.a.createElement("span",{className:"chart-letter"},e),n.a.createElement("span",{className:"chart-number"},t));function ga(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function fa(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ga(Object(a),!0).forEach((function(t){Object(i.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ga(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const Ea=n.a.forwardRef(({allResults:e,playersHiddenStatus:t={},sharedCharts:a={},chart:s,showHiddenPlayers:c=!1,showProtagonistEloChange:o=!1,showProtagonistPpChange:i=!1,uniqueSelectedNames:m=[],protagonistName:d=null,leftProfile:p={},rightProfile:u={},isSocketView:h=!1},g)=>{const b=Object(r.useState)(null),y=Object(P.a)(b,2),v=y[0],O=y[1],N=Object(r.useState)(!c),S=Object(P.a)(N,2),w=S[0],x=S[1];Object(r.useEffect)(()=>{x(!c)},[c]);const D=f.a.first(v)||s;lt&&console.log(D,v);let R=1;const C=[];let L=0;const _=D.results.map((e,a)=>{const r=w&&(t[e.playerId]||!1),n=C.includes(e.nickname);return C.push(e.nickname),0===a?R=1:n||e.score===f.a.get([a-1,"score"],D.results)||(R+=1),r&&L++,fa({},e,{topPlace:R,isSecondOccurenceInResults:n,isPlayerHidden:r})}),I=f.a.throttle(260,e=>{const t=f.a.drop(1,v);O(1===f.a.size(t)?null:t)}),A=f.a.throttle(260,t=>{f.a.isEmpty(_)&&O(null);const a=f.a.maxBy("date",_);if(!a)return;const r=a.playerId,n=f.a.findLast(e=>e.playerId===r&&e.sharedChartId===t.sharedChartId&&e.isRank===a.isRank&&e.date<a.date,e),s=f.a.orderBy("score","desc",f.a.compact(f.a.map(e=>e.id===a.id?n:e,_))),c=f.a.maxBy("date",s),l=fa({},t,{latestScoreDate:c&&c.date,results:s});f.a.isEmpty(s)?O(null):O([l,...v||[t]])}),T=!f.a.isEmpty(v),M=f.a.countBy(e=>!t[e],D.allResultsIds).true,F=T?1+M-f.a.size(v):M,B=!(1===F&&1===M),H=D.interpolatedDifficulty||f.a.get("interpolatedDifficulty",a[D.sharedChartId]);return n.a.createElement("div",{className:"song-block",ref:g},n.a.createElement("div",{className:"song-name"},n.a.createElement(ha,{type:D.chartType,level:D.chartLevel}),h?n.a.createElement("div",{className:"song-name-text"},H?"(".concat(H.toFixed(1),") "):"",D.song):n.a.createElement("div",{className:"song-name-text"},n.a.createElement(l.c,{exact:!0,to:E.leaderboard.sharedChart.getPath({sharedChartId:D.sharedChartId})},D.song)," ",n.a.createElement("span",{className:"_grey-text"},"(",H&&H.toFixed(1),")")),!h&&n.a.createElement("div",{className:"youtube-link"},n.a.createElement("a",{href:"https://youtube.com/results?".concat(Ge.a.stringify({search_query:"".concat(D.song," ").concat(D.chartLabel).replace(/( -)|(- )/g," ")})),target:"_blank",rel:"noopener noreferrer"},n.a.createElement(k.v,null))),n.a.createElement("div",{className:"_flex-fill"}),n.a.createElement("div",{className:"right-side-block"},L>0&&n.a.createElement("div",{className:j()("players-hidden-count _grey-text",{"_on-hover":!h})},"\u0441\u043a\u0440\u044b\u0442\u043e: ",L),(L>0||!w)&&!h&&n.a.createElement("div",{className:"globe-icon _on-hover",onClick:()=>x(!w)},n.a.createElement(k.k,null)),!h&&n.a.createElement("div",{className:j()("undo-result-button _on-hover",{active:T})},n.a.createElement(k.d,{className:j()("backward-btn",{disabled:!B}),onClick:()=>B&&A(D)}),n.a.createElement("span",{className:"number"},F,"/",M),n.a.createElement(k.j,{className:j()("forward-btn",{disabled:!T}),onClick:()=>T&&I(D)})))),n.a.createElement("div",{className:"charts"},!f.a.isEmpty(_)&&n.a.createElement("div",{className:"chart"},n.a.createElement("div",{className:"results"},n.a.createElement("table",null,n.a.createElement(Zt.a,{enterAnimation:"fade",leaveAnimation:"fade",typeName:"tbody",maintainContainerHeight:!0,duration:250},_.map((e,t)=>{const a=e.nickname===d;if(e.isPlayerHidden&&!a||e.isUnknownPlayer&&0!==t)return null;let r,s;if(e.scoreIncrease&&e.date===D.latestScoreDate){const a=e.score-e.scoreIncrease;r=(s=f.a.findLastIndex(e=>e.score>a,_))-t}return n.a.createElement(ua,{key:e.isRank+"_"+e.nickname,chart:D,results:_,res:e,placeDifference:r,showProtagonistEloChange:o,showProtagonistPpChange:i,uniqueSelectedNames:m,protagonistName:d,leftProfile:p,rightProfile:u,isSocketView:h})})))))))});var ba=Object(o.b)((e,t)=>({allResults:e.results.results,sharedCharts:e.results.sharedCharts,playersHiddenStatus:t.playersHiddenStatus||e.preferences.data.playersHiddenStatus}),null,null,{forwardRef:!0})(Ea),ya=a(28),va=a(183);function Oa(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Na(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Oa(Object(a),!0).forEach((function(t){Object(i.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Oa(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const Pa=Object(ya.a)(e=>e.results.players,e=>e.user.data.player.id,(e,t)=>f.a.flow(f.a.toPairs,f.a.map(([,{nickname:e,arcade_name:a,id:r,region:n}])=>({label:"".concat(e," (").concat(a,")"),value:e,isCurrentPlayer:t===r})),f.a.sortBy(e=>e.isCurrentPlayer?"!":f.a.toLower(e.label)))(e)),ka=Object(ya.a)(e=>e.results.data,e=>e.results.sharedCharts,e=>e.results.filter,e=>e.results.resultInfo,e=>e.preferences.data,(e,t,a=yt,r={},n)=>{const s=performance.now(),c=n.playersHiddenStatus,l=a.showHiddenFromPreferences,o=f.a.map("value",a.players),i=f.a.map("value",a.playersOr),m=f.a.map("value",a.playersNot),d=f.a.get("value",a.sortingType),p=f.a.get("value",a.rank)||y.SHOW_ALL,u=[b.PROTAGONIST,b.RANK_ASC,b.RANK_DESC,b.PP_ASC,b.PP_DESC,b.NEW_SCORES_PLAYER].includes(d)?f.a.get("value",a.protagonist):null,h=f.a.map("value",a.excludeAntagonists),g=[f.a.orderBy([e=>f.a.max(f.a.map(e=>l||!c[e.playerId]?e.dateObject.getTime():0,e.results))],["desc"])],E=u?[f.a.orderBy([e=>f.a.max(f.a.map(e=>e.nickname===u?e.dateObject.getTime():0,e.results))],["desc"])]:g,O=[f.a.filter(e=>f.a.map("nickname",e.results).includes(u)),f.a.map(e=>{const t=f.a.findIndex({nickname:u},e.results),a=e.results[t].score,r=f.a.flow([f.a.take(t),f.a.uniqBy("nickname"),f.a.remove(e=>h.includes(e.nickname)||e.score===a)])(e.results);return Na({},e,{distanceFromProtagonist:Math.sqrt(f.a.reduce((e,t)=>e+(t.score/a-.99)**2,0,r))})}),f.a.orderBy(["distanceFromProtagonist"],["desc"])],P=(e,t="desc")=>[f.a.filter(e=>f.a.map("nickname",e.results).includes(u)),f.a.orderBy([a=>{const n=f.a.find({nickname:u},a.results),s=r[n.id]||{};return f.a.getOr("desc"===t?-1/0:1/0,e,s)}],[t])],k=e=>[f.a.filter(e=>f.a.map("nickname",e.results).includes(u)),f.a.orderBy([t=>{const a=f.a.find({nickname:u},t.results),n=r[a.id];return f.a.getOr("asc"===e?1/0:-1/0,"ratingDiff",n)}],[e])],S=(e="desc")=>[f.a.orderBy([e=>{const a=t[e.sharedChartId];return f.a.getOr(f.a.toNumber(e.chartLevel),"interpolatedDifficulty",a)}],[e])],j={[b.DEFAULT]:g,[b.NEW_SCORES_PLAYER]:E,[b.PROTAGONIST]:O,[b.RANK_ASC]:k("asc"),[b.RANK_DESC]:k("desc"),[b.PP_ASC]:P("pp.ppRatio","asc"),[b.PP_DESC]:P("pp.pp"),[b.EASIEST_SONGS]:S("asc"),[b.HARDEST_SONGS]:S("desc")}[d]||g,w=f.a.flow(f.a.compact([f.a.map(e=>{let t=null;const a=[],r=e.results.filter((e,r)=>{const n=!p||p===y.SHOW_ALL||(p===y.SHOW_ONLY_RANK?e.isRank:p===y.SHOW_ONLY_NORANK?!e.isRank:p!==y.SHOW_BEST||!a.includes(e.playerId));p===y.SHOW_BEST&&a.push(e.playerId);const s=(!e.isUnknownPlayer||0===r)&&n;return s&&(!t||t<e.date)&&(t=e.date),s},e.results);return Na({},e,{latestScoreDate:t,results:r})}),a.chartRange&&(e=>((e,t)=>{const a=f.a.getOr(v,"range",e),r=f.a.getOr(null,"type",e),n=f.a.getOr(N,"duration",e);return f.a.filter(e=>!(n!==N&&!n.includes(e.duration))&&(e.chartLevel>=a[0]&&e.chartLevel<=a[1]&&(!r||e.chartType.startsWith(r))),t)})(a.chartRange,e)),(o.length||i.length||m.length)&&f.a.filter(e=>{const t=f.a.map("nickname",e.results);return(!o.length||f.a.every(e=>t.includes(e),o))&&(!i.length||f.a.some(e=>t.includes(e),i))&&(!m.length||!f.a.some(e=>t.includes(e),m))}),f.a.filter(e=>f.a.size(e.results)),...j,a.song&&(e=>Object(va.a)(e,a.song.trim(),{keys:["song"]}))]))(e);return console.log("Sorting took",performance.now()-s,"ms"),w}),Sa=Object(ya.a)(e=>e.results.data,(e,t)=>t.match.params.sharedChartId,(e,t)=>{const a=f.a.toNumber(t);return e.filter(e=>e.sharedChartId===a)});function ja(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}const wa=[{label:"\u043e\u0442 \u043d\u043e\u0432\u044b\u0445 \u0441\u043a\u043e\u0440\u043e\u0432",value:b.DEFAULT},{label:"\u043e\u0442 \u043d\u043e\u0432\u044b\u0445 \u0441\u043a\u043e\u0440\u043e\u0432 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u0438\u0433\u0440\u043e\u043a\u0430",value:b.NEW_SCORES_PLAYER},{label:"\u043e\u0442 \u0445\u0443\u0434\u0448\u0438\u0445 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u0432 (\u044d\u043b\u043e)",value:b.RANK_ASC},{label:"\u043e\u0442 \u043b\u0443\u0447\u0448\u0438\u0445 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u0432 (\u044d\u043b\u043e)",value:b.RANK_DESC},{label:"\u043e\u0442 \u0445\u0443\u0434\u0448\u0438\u0445 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u0432 (pp)",value:b.PP_ASC},{label:"\u043e\u0442 \u043b\u0443\u0447\u0448\u0438\u0445 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u0432 (pp)",value:b.PP_DESC},{label:"\u043e\u0442 \u043b\u0451\u0433\u043a\u0438\u0445 \u0447\u0430\u0440\u0442\u043e\u0432",value:b.EASIEST_SONGS},{label:"\u043e\u0442 \u0441\u043b\u043e\u0436\u043d\u044b\u0445 \u0447\u0430\u0440\u0442\u043e\u0432",value:b.HARDEST_SONGS}],xa=[{label:"\u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c \u0432\u0441\u0435 \u0441\u043a\u043e\u0440\u044b",value:y.SHOW_ALL},{label:"\u043e\u0434\u0438\u043d \u043b\u0443\u0447\u0448\u0438\u0439 \u0441\u043a\u043e\u0440 \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u0438\u0433\u0440\u043e\u043a\u0430 (\u0440\u0430\u043d\u043a \u0438\u043b\u0438 \u043d\u0435\u0442)",value:y.SHOW_BEST},{label:"\u0442\u043e\u043b\u044c\u043a\u043e \u043d\u0430 \u0440\u0430\u043d\u043a\u0435",value:y.SHOW_ONLY_RANK},{label:"\u0442\u043e\u043b\u044c\u043a\u043e \u0431\u0435\u0437 \u0440\u0430\u043d\u043a\u0430",value:y.SHOW_ONLY_NORANK}],Da={fetchResults:wt,setFilter:Dt,resetFilter:()=>({type:gt}),selectPreset:Gt,openPreset:qt};class Ra extends r.Component{constructor(...e){super(...e),this.state={showItemsCount:20},this.setFilter=f.a.curry((e,t)=>{const a=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ja(Object(a),!0).forEach((function(t){Object(i.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ja(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},this.props.filter,{[e]:t});this.props.setFilter(a),p.a.setItem("filter",a)}),this.resetFilter=()=>{this.props.resetFilter(),p.a.setItem("filter",yt)},this.onRefresh=()=>{!this.props.isLoading&&this.props.fetchResults()},this.onTypeSongName=f.a.debounce(300,e=>{this.setFilter("song",e)})}renderSimpleSearch(){const e=this.props,t=e.isLoading,a=e.filter;return n.a.createElement("div",{className:"simple-search"},n.a.createElement("div",{className:"song-name _margin-right _margin-bottom"},n.a.createElement(je,{value:a.song||"",placeholder:"\u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043f\u0435\u0441\u043d\u0438...",className:"form-control",onChange:this.onTypeSongName})),n.a.createElement("div",{className:"chart-range _margin-right _margin-bottom"},n.a.createElement(We,{filterValue:a.chartRange,onChange:this.setFilter("chartRange")})),n.a.createElement("div",{className:"_flex-fill"}),n.a.createElement("div",{className:"_flex-row _margin-bottom"},n.a.createElement(Qt,null),n.a.createElement("button",{className:"btn btn-sm btn-dark btn-icon _margin-right",onClick:this.resetFilter},n.a.createElement(k.q,null)," \u0441\u0431\u0440\u043e\u0441\u0438\u0442\u044c \u0444\u0438\u043b\u044c\u0442\u0440\u044b"),n.a.createElement("button",{disabled:t,className:"btn btn-sm btn-dark btn-icon",onClick:this.onRefresh},n.a.createElement(k.s,null)," \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c")))}renderFilters(){const e=this.props,t=e.players,a=e.filter;return n.a.createElement("div",{className:"filters"},n.a.createElement("div",{className:"people-filters"},n.a.createElement("label",{className:"label"},"\u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c \u0447\u0430\u0440\u0442\u044b, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0441\u044b\u0433\u0440\u0430\u043b:"),n.a.createElement("div",{className:"players-block"},n.a.createElement("div",{className:"_margin-right"},n.a.createElement("label",{className:"label"},"\u043a\u0430\u0436\u0434\u044b\u0439 \u0438\u0437 \u044d\u0442\u0438\u0445"),n.a.createElement(be.a,{closeMenuOnSelect:!1,className:"select players",classNamePrefix:"select",placeholder:"\u0438\u0433\u0440\u043e\u043a\u0438...",isMulti:!0,options:t,value:f.a.getOr(null,"players",a),onChange:this.setFilter("players")})),n.a.createElement("div",{className:"_margin-right"},n.a.createElement("label",{className:"label"},"\u0438 \u0445\u043e\u0442\u044c \u043e\u0434\u0438\u043d \u0438\u0437 \u044d\u0442\u0438\u0445"),n.a.createElement(be.a,{closeMenuOnSelect:!1,className:"select players",classNamePrefix:"select",placeholder:"\u0438\u0433\u0440\u043e\u043a\u0438...",isMulti:!0,options:t,value:f.a.getOr(null,"playersOr",a),onChange:this.setFilter("playersOr")})),n.a.createElement("div",{className:"_margin-right"},n.a.createElement("label",{className:"label"},"\u0438 \u043d\u0438\u043a\u0442\u043e \u0438\u0437 \u044d\u0442\u0438\u0445"),n.a.createElement(be.a,{closeMenuOnSelect:!1,className:"select players",classNamePrefix:"select",placeholder:"\u0438\u0433\u0440\u043e\u043a\u0438...",isMulti:!0,options:t,value:f.a.getOr(null,"playersNot",a),onChange:this.setFilter("playersNot")})))),n.a.createElement("div",{className:"people-filters"},n.a.createElement("div",{className:"players-block"},n.a.createElement("div",{className:"_margin-right"},n.a.createElement("label",{className:"label"},"\u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c \u0440\u0430\u043d\u043a:"),n.a.createElement(be.a,{closeMenuOnSelect:!1,className:"select",classNamePrefix:"select",placeholder:"...",options:xa,value:f.a.getOr(null,"rank",a)||y.SHOW_ALL,onChange:this.setFilter("rank")})))),n.a.createElement("div",null,n.a.createElement(we,{checked:f.a.getOr(!1,"showHiddenFromPreferences",a),onChange:this.setFilter("showHiddenFromPreferences")},"\u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c \u0441\u043a\u0440\u044b\u0442\u044b\u0445 \u0438\u0433\u0440\u043e\u043a\u043e\u0432")))}renderSortings(){const e=this.props,t=e.players,a=e.filter;return n.a.createElement("div",{className:"sortings"},n.a.createElement("div",null,n.a.createElement("label",{className:"label"},"\u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0430:"),n.a.createElement(be.a,{placeholder:"\u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0443",className:"select",classNamePrefix:"select",isClearable:!1,options:wa,value:f.a.getOr(wa[0],"sortingType",a),onChange:this.setFilter("sortingType")})),[b.PROTAGONIST,b.RANK_ASC,b.RANK_DESC,b.PP_ASC,b.PP_DESC,b.NEW_SCORES_PLAYER].includes(f.a.get("sortingType.value",a))&&n.a.createElement("div",null,n.a.createElement("label",{className:"label"},"\u0438\u0433\u0440\u043e\u043a:"),n.a.createElement(be.a,{className:j()("select players",{"red-border":!f.a.get("protagonist",a)}),classNamePrefix:"select",placeholder:"\u0438\u0433\u0440\u043e\u043a\u0438...",options:t,value:f.a.getOr(null,"protagonist",a),onChange:this.setFilter("protagonist")})),[b.PROTAGONIST].includes(f.a.get("sortingType.value",a))&&n.a.createElement("div",null,n.a.createElement("label",{className:"label"},"\u043d\u0435 \u0443\u0447\u0438\u0442\u044b\u0432\u0430\u0442\u044c \u0432 \u0441\u0440\u0430\u0432\u043d\u0435\u043d\u0438\u0438:"),n.a.createElement(be.a,{closeMenuOnSelect:!1,className:"select players",classNamePrefix:"select",placeholder:"\u0438\u0433\u0440\u043e\u043a\u0438...",options:t,isMulti:!0,value:f.a.getOr([],"excludeAntagonists",a),onChange:this.setFilter("excludeAntagonists")})))}render(){const e=this.props,t=e.isLoading,a=e.isChartView,r=e.filteredData,s=e.error,c=e.filter,o=e.presets,i=this.state.showItemsCount,m=r.length>i,d=f.a.slice(0,i,r),p=f.a.get("sortingType.value",c),u=[b.RANK_ASC,b.RANK_DESC].includes(p),h=[b.PP_ASC,b.PP_DESC].includes(p),g=[b.PROTAGONIST,b.RANK_ASC,b.RANK_DESC,b.PP_ASC,b.PP_DESC,b.NEW_SCORES_PLAYER].includes(p),y=f.a.get("protagonist.value",c),v=f.a.slice(0,pa.length,f.a.uniq(f.a.compact([g&&y,...f.a.map("value",c.players),...f.a.map("value",c.playersOr)])));return n.a.createElement("div",{className:"leaderboard-page"},n.a.createElement("div",{className:"content"},a&&n.a.createElement("div",{className:"simple-search"},n.a.createElement(l.c,{exact:!0,to:E.leaderboard.path},n.a.createElement("button",{className:"btn btn-sm btn-dark btn-icon"},n.a.createElement(k.c,null)," \u043a\u043e \u0432\u0441\u0435\u043c \u0447\u0430\u0440\u0442\u0430\u043c"))),!a&&n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"search-block"},this.renderSimpleSearch(),n.a.createElement(xe,{title:"\u0444\u0438\u043b\u044c\u0442\u0440\u044b"},this.renderFilters()),n.a.createElement(xe,{title:"\u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0430"},this.renderSortings())),!!o.length&&n.a.createElement("div",{className:"presets-buttons"},n.a.createElement("span",null,"\u043f\u0440\u0435\u0441\u0435\u0442\u044b:"),o.map(e=>n.a.createElement(ke,{key:e.name,text:e.name,className:"btn btn-sm btn-dark _margin-right",active:f.a.get("filter",e)===c,onToggle:()=>{this.props.selectPreset(e),this.props.openPreset()}})))),n.a.createElement("div",{className:"top-list"},t&&n.a.createElement(w,null),f.a.isEmpty(r)&&!t&&(s?s.message:"\u043d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e"),!t&&d.map((e,t)=>n.a.createElement(ba,{showHiddenPlayers:a||c.showHiddenFromPreferences,key:e.sharedChartId,chart:e,chartIndex:t,showProtagonistEloChange:u,showProtagonistPpChange:h,uniqueSelectedNames:v,protagonistName:y})),!t&&m&&n.a.createElement("button",{className:"btn btn-sm btn-primary",onClick:()=>this.setState(e=>({showItemsCount:e.showItemsCount+10}))},"show more..."))))}}var Ca=Object(o.b)((e,t)=>{const a=!!t.match.params.sharedChartId;return{isChartView:a,players:Pa(e),filteredData:a?Sa(e,t):ka(e),filter:a?yt:e.results.filter,error:e.results.error||e.tracklist.error,isLoading:e.results.isLoading||e.tracklist.isLoading,presets:e.presets.presets}},Da)(Ra);a(277);const La=e=>n.a.createElement("img",{src:"".concat(".","/grades/").concat(e,".png"),alt:e});function _a({ranking:e,isLoading:t,preferences:a,updatePreferences:r}){return n.a.createElement("div",{className:"ranking-list"},f.a.isEmpty(e)&&!t&&"\u043d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e",t&&n.a.createElement(w,null),!t&&n.a.createElement("table",null,n.a.createElement("thead",null,n.a.createElement("tr",null,n.a.createElement("th",{className:"place"}),n.a.createElement("th",{className:"change"}),n.a.createElement("th",{className:"exp-rank"},"rank"),n.a.createElement("th",{className:"name"},"name"),n.a.createElement("th",{className:"name name-piu"},"piu name"),n.a.createElement("th",{className:"rating"},"elo"),n.a.createElement("th",{className:"rating-change-cell"}),n.a.createElement("th",{className:"rating"},"pp"),n.a.createElement("th",{className:"grades sss"},La("SSS")),n.a.createElement("th",{className:"grades ss"},La("SS")),n.a.createElement("th",{className:"grades s"},La("S")),n.a.createElement("th",{className:"grades a"},La("A+")),n.a.createElement("th",{className:"grades b"},La("B")),n.a.createElement("th",{className:"grades c"},La("C")),n.a.createElement("th",{className:"grades d"},La("D")),n.a.createElement("th",{className:"grades f"},La("F")),n.a.createElement("th",{className:"playcount"},"scores"),n.a.createElement("th",{className:"accuracy"},"accuracy"),n.a.createElement("th",{className:"hide-col"}," "))),n.a.createElement("tbody",null,e.map((e,t)=>{const s=a.playersHiddenStatus[e.id];return s&&!a.showHiddenPlayersInRanking?null:n.a.createElement("tr",{className:j()("player",{"hidden-player":s}),key:e.name},n.a.createElement("td",{className:"place"},0===t?n.a.createElement(Xe.e,null):"#".concat(t+1)),n.a.createElement("td",{className:"change"},e.change>0&&n.a.createElement("div",{className:"change-holder up"},n.a.createElement("span",null,e.change),n.a.createElement(k.b,null)),e.change<0&&n.a.createElement("div",{className:"change-holder down"},n.a.createElement("span",null,-e.change),n.a.createElement(k.a,null)),!!e.change&&f.a.isString(e.change)&&n.a.createElement("div",{className:"change-holder text"},n.a.createElement("span",null,e.change))),n.a.createElement("td",{className:"exp-rank"},Ye(e.expRank)),n.a.createElement("td",{className:"name"},n.a.createElement("div",{className:"name-container"},n.a.createElement(ra,{region:e.region}),n.a.createElement(l.c,{exact:!0,to:E.profile.getPath({id:e.id})},e.name))),n.a.createElement("td",{className:"name name-piu"},n.a.createElement(l.c,{exact:!0,to:E.profile.getPath({id:e.id})},e.nameArcade)),n.a.createElement("td",{className:"rating"},e.rating),n.a.createElement("td",{className:"rating-change-cell"},!!e.prevRating&&e.prevRating!==e.rating&&n.a.createElement("span",{className:j()("rating-change",{down:e.prevRating>e.rating,up:e.prevRating<e.rating})},e.prevRating<e.rating?"+":"",e.rating-e.prevRating)),n.a.createElement("td",{className:"rating secondary"},Math.round(e.pp.pp)),n.a.createElement("td",{className:"grades sss"},e.grades.SSS),n.a.createElement("td",{className:"grades ss"},e.grades.SS),n.a.createElement("td",{className:"grades s"},e.grades.S),n.a.createElement("td",{className:"grades a"},e.grades.A),n.a.createElement("td",{className:"grades b"},e.grades.B),n.a.createElement("td",{className:"grades c"},e.grades.C),n.a.createElement("td",{className:"grades d"},e.grades.D),n.a.createElement("td",{className:"grades f"},e.grades.F),n.a.createElement("td",{className:"playcount"},e.count),n.a.createElement("td",{className:"accuracy"},e.accuracy?"".concat(e.accuracy.toFixed(2),"%"):""),n.a.createElement("td",{className:"hide-col"},n.a.createElement(we,{onChange:()=>{r(f.a.set(["playersHiddenStatus",e.id],!s,a))},checked:!s})))}))))}function Ia(){return n.a.createElement("div",{className:"faq"},n.a.createElement("div",{className:"question-answer"},n.a.createElement("div",{className:"question"},"Q: \u041a\u0430\u043a \u0441\u0447\u0438\u0442\u0430\u0435\u0442\u0441\u044f \u0440\u0435\u0439\u0442\u0438\u043d\u0433?"),n.a.createElement("div",{className:"answer"},"A: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f ",n.a.createElement("a",{href:"https://en.wikipedia.org/wiki/Elo_rating_system"},"\u0440\u0435\u0439\u0442\u0438\u043d\u0433 \u042d\u043b\u043e"),", \u0448\u0438\u0440\u043e\u043a\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0439 \u0432 \u0448\u0430\u0445\u043c\u0430\u0442\u0430\u0445 \u0438 \u0434\u0440\u0443\u0433\u0438\u0445 \u0438\u0433\u0440\u0430\u0445, \u0441\u043b\u0435\u0433\u043a\u0430 \u043c\u043e\u0434\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0439 \u043f\u043e\u0434 \u0443\u0441\u043b\u043e\u0432\u0438\u044f \u0438\u0433\u0440\u044b \u043d\u0430 \u043f\u0430\u043c\u043f\u0435. \u0421\u0440\u0435\u0434\u043d\u0438\u0439 \u0440\u0435\u0439\u0442\u0438\u043d\u0433 - 1000. \u041a\u043e\u044d\u0444\u0444\u0438\u0446\u0438\u0435\u043d\u0442 \u041a \u0437\u0430\u0432\u0438\u0441\u0438\u0442 \u043e\u0442 \u0443\u0440\u043e\u0432\u043d\u044f \u0447\u0430\u0440\u0442\u0430 (\u0431\u043e\u043b\u0435\u0435 \u0441\u043b\u043e\u0436\u043d\u044b\u0435 \u0447\u0430\u0440\u0442\u044b \u0441\u0438\u043b\u044c\u043d\u0435\u0435 \u0432\u043b\u0438\u044f\u044e\u0442 \u043d\u0430 \u0440\u0435\u0439\u0442\u0438\u043d\u0433). \u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043e\u0447\u043a\u043e\u0432 \u0432\u043b\u0438\u044f\u0435\u0442 \u043d\u0430 \u0437\u0430\u0440\u0430\u0431\u043e\u0442\u0430\u043d\u043d\u044b\u0439 \u0440\u0435\u0439\u0442\u0438\u043d\u0433 (\u043c\u0430\u043b\u0435\u043d\u044c\u043a\u0438\u0439 \u043e\u0442\u0440\u044b\u0432 \u043e\u0442 \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u0438\u043a\u0430 \u043d\u0435 \u0434\u0430\u0441\u0442 \u0442\u0430\u043a \u043c\u043d\u043e\u0433\u043e \u043e\u0447\u043a\u043e\u0432 \u043a\u0430\u043a \u0431\u043e\u043b\u044c\u0448\u043e\u0439 \u043e\u0442\u0440\u044b\u0432).")),n.a.createElement("div",{className:"question-answer"},n.a.createElement("div",{className:"question"},"Q: \u0427\u0442\u043e \u0442\u0430\u043a\u043e\u0435 \u0440\u0440 \u0438 \u0447\u0435\u043c \u043e\u043d\u043e \u043e\u0442\u043b\u0438\u0447\u0430\u0435\u0442\u0441\u044f \u043e\u0442 \u044d\u043b\u043e?"),n.a.createElement("div",{className:"answer"},"A: \u0420\u0420 (performance points) - \u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u043e\u0447\u043a\u043e\u0432, \u0432\u0437\u044f\u0442\u0430\u044f \u0438\u0437 osu!. \u042d\u043b\u043e - \u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u0440\u0435\u0439\u0442\u0438\u043d\u0433\u0430, \u0432\u0437\u044f\u0442\u0430\u044f \u0438\u0437 \u0448\u0430\u0445\u043c\u0430\u0442. \u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u043e\u0442\u043b\u0438\u0447\u0438\u044f:",n.a.createElement("br",null),"\u0421 \u044d\u043b\u043e \u0442\u0432\u043e\u0438 \u043e\u0447\u043a\u0438 \u0437\u0430\u0432\u0438\u0441\u044f\u0442 \u043e\u0442 \u0434\u0440\u0443\u0433\u0438\u0445 \u0438\u0433\u0440\u043e\u043a\u043e\u0432 \u043d\u0430 \u044d\u0442\u043e\u043c \u0447\u0430\u0440\u0442\u0435, \u0441 \u0440\u0440 \u0442\u0432\u043e\u0438 \u043e\u0447\u043a\u0438 \u0437\u0430\u0432\u0438\u0441\u044f\u0442 \u0442\u043e\u043b\u044c\u043a\u043e \u043e\u0442 \u0442\u043e\u0433\u043e, \u043a\u0430\u043a \u0442\u044b \u0441\u044b\u0433\u0440\u0430\u0435\u0448\u044c \u0447\u0430\u0440\u0442.",n.a.createElement("br",null),"\u0421 \u044d\u043b\u043e \u043c\u043e\u0436\u043d\u043e \u043f\u043e\u0442\u0435\u0440\u044f\u0442\u044c \u043e\u0447\u043a\u0438 \u0438\u043b\u0438 \u0437\u0430\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u0434\u0440\u0443\u0433\u043e\u0433\u043e \u0438\u0433\u0440\u043e\u043a\u0430 \u0438\u0445 \u043f\u043e\u0442\u0435\u0440\u044f\u0442\u044c, \u0441 \u0440\u0440 \u043c\u043e\u0436\u043d\u043e \u0442\u043e\u043b\u044c\u043a\u043e \u043d\u0430\u0431\u0438\u0440\u0430\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435 \u043e\u0447\u043a\u043e\u0432.",n.a.createElement("br",null),"\u0421 \u044d\u043b\u043e \u043d\u0430\u043c\u043d\u043e\u0433\u043e \u043f\u0440\u043e\u0449\u0435 \u043a\u043e\u0433\u043e-\u0442\u043e \u043e\u0431\u043e\u0433\u043d\u0430\u0442\u044c, \u0441 \u0440\u0440 \u043b\u044e\u0434\u0438 \u0440\u0435\u0434\u043a\u043e \u043c\u0435\u043d\u044f\u044e\u0442\u0441\u044f \u043c\u0435\u0441\u0442\u0430\u043c\u0438 \u0432 \u0440\u0435\u0439\u0442\u0438\u043d\u0433\u0435.",n.a.createElement("br",null),"\u042d\u043b\u043e \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442 \u043a\u0442\u043e \u043a\u043e\u0433\u043e \u043e\u0431\u044b\u0433\u0440\u044b\u0432\u0430\u0435\u0442 \u0432 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0435 \u0432\u0440\u0435\u043c\u044f, \u0430 \u0440\u0440 \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442, \u043a\u0442\u043e \u043d\u0430 \u043a\u0430\u043a\u043e\u043c \u043f\u0440\u0438\u043c\u0435\u0440\u043d\u043e \u0443\u0440\u043e\u0432\u043d\u0435 \u043f\u043e \u0441\u043a\u0438\u043b\u043b\u0443.",n.a.createElement("br",null),"\u0421\u0435\u0439\u0447\u0430\u0441 \u0440\u0435\u0439\u0442\u0438\u043d\u0433 \u0441\u043e\u0440\u0442\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u043f\u043e \u042d\u043b\u043e. \u0420\u0420 \u0432\u044b\u0441\u0442\u0443\u043f\u0430\u0435\u0442 \u0432 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0439 \u0438\u043d\u0444\u044b \u0434\u043b\u044f \u0438\u043d\u0442\u0435\u0440\u0435\u0441\u0430, \u043f\u043b\u044e\u0441 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u043a\u0430\u043a \u0441\u0442\u0430\u0440\u0442\u043e\u0432\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u042d\u043b\u043e.")),n.a.createElement("div",{className:"question-answer"},n.a.createElement("div",{className:"question"},"Q: \u0421\u0438\u0441\u0442\u0435\u043c\u0430 \u042d\u043b\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0438\u0433\u0440 1 \u043d\u0430 1, \u043a\u0430\u043a \u043e\u043d\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u043d\u0430 \u043f\u0430\u043c\u043f\u0435, \u0433\u0434\u0435 \u043d\u0430 \u043e\u0434\u043d\u043e\u043c \u0447\u0430\u0440\u0442\u0435 \u0438\u0433\u0440\u0430\u0435\u0442 \u043c\u043d\u043e\u0433\u043e \u0438\u0433\u0440\u043e\u043a\u043e\u0432?"),n.a.createElement("div",{className:"answer"},"A: \u0420\u0435\u043a\u043e\u0440\u0434\u044b \u043d\u0430 \u043e\u0434\u043d\u043e\u043c \u0447\u0430\u0440\u0442\u0435 \u0434\u0435\u043b\u044f\u0442\u0441\u044f \u043d\u0430 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0438\u0433\u0440 1 \u043d\u0430 1. \u0415\u0441\u043b\u0438 \u0435\u0441\u0442\u044c 3 \u0438\u0433\u0440\u043e\u043a\u0430: A, B, C; \u0442\u043e \u0441\u0447\u0438\u0442\u0430\u0435\u0442\u0441\u044f, \u0447\u0442\u043e \u0431\u044b\u043b\u043e 3 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u0435 \u0438\u0433\u0440\u044b: A vs B, A vs C, B vs C.")),n.a.createElement("div",{className:"question-answer"},n.a.createElement("div",{className:"question"},"Q: \u041a\u0430\u043a \u0441\u0447\u0438\u0442\u0430\u0435\u0442\u0441\u044f \u0441\u0443\u043c\u043c\u0430 \u0440\u0440?"),n.a.createElement("div",{className:"answer"},"A: \u0421\u043d\u0430\u0447\u0430\u043b\u0430 \u0432\u0441\u0435 \u0441\u043a\u043e\u0440\u044b \u0438\u0433\u0440\u043e\u043a\u0430 \u0441\u043e\u0440\u0442\u0438\u0440\u0443\u044e\u0442\u0441\u044f \u043f\u043e \u0440\u0440. \u0417\u0430\u0442\u0435\u043c \u0432 \u043e\u0431\u0449\u0443\u044e \u0441\u0443\u043c\u043c\u0443 \u0440\u0440 \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442\u0441\u044f 100% \u043e\u0442 \u043b\u0443\u0447\u0448\u0435\u0433\u043e \u0441\u043a\u043e\u0440\u0430, 95% \u043e\u0442 \u0432\u0442\u043e\u0440\u043e\u0433\u043e \u0441\u043a\u043e\u0440\u0430, 90% \u043e\u0442 \u0442\u0440\u0435\u0442\u044c\u0435\u0433\u043e, 86% \u043e\u0442 4-\u0433\u043e \u0438 \u0442\u0430\u043a \u0434\u0430\u043b\u0435\u0435. (\u0424\u043e\u0440\u043c\u0443\u043b\u0430 \u043a\u043e\u044d\u0444\u0444\u0438\u0446\u0438\u0435\u043d\u0442\u0430 - 0.95^N). \u0422\u0430\u043a\u0438\u043c \u043e\u0431\u0440\u0430\u0437\u043e\u043c, \u043d\u0430 \u043e\u0431\u0449\u0443\u044e \u0441\u0443\u043c\u043c\u0443 \u0440\u0440 \u0431\u043e\u043b\u044c\u0448\u0435 \u0432\u0441\u0435\u0433\u043e \u0432\u043b\u0438\u044f\u044e\u0442 \u0441\u0430\u043c\u044b\u0435 \u043b\u0443\u0447\u0448\u0438\u0435 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u0447\u0435\u043b\u043e\u0432\u0435\u043a\u0430 \u0437\u0430 \u0432\u0441\u0451 \u0432\u0440\u0435\u043c\u044f, \u0438 \u0447\u0442\u043e\u0431\u044b \u043f\u043e\u0434\u043d\u044f\u0442\u044c \u0441\u0432\u043e\u0439 \u0443\u0440\u043e\u0432\u0435\u043d\u044c \u0440\u0440, \u043d\u0443\u0436\u043d\u043e \u043f\u043e\u043b\u0443\u0447\u0430\u0442\u044c \u043d\u043e\u0432\u044b\u0435 \u0442\u043e\u043f\u043e\u0432\u044b\u0435 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b (\u0438 \u043f\u043e\u0434\u043d\u0438\u043c\u0430\u0442\u044c \u0441\u0432\u043e\u0439 \u0441\u043a\u0438\u043b\u043b).")),n.a.createElement("div",{className:"question-answer"},n.a.createElement("div",{className:"question"},"Q: \u0423\u0447\u0438\u0442\u044b\u0432\u0430\u044e\u0442\u0441\u044f \u043b\u0438 \u0440\u0435\u043a\u043e\u0440\u0434\u044b \u043d\u0430 \u0440\u0430\u043d\u043a\u0435 \u0432 \u0440\u0435\u0439\u0442\u0438\u043d\u0433\u0435?"),n.a.createElement("div",{className:"answer"},"A: \u0414\u0430. \u041a\u0430\u043a \u043c\u0438\u043d\u0438\u043c\u0443\u043c \u043f\u043e\u0442\u043e\u043c\u0443 \u0447\u0442\u043e \u0443 \u043d\u0430\u0441 \u0435\u0441\u0442\u044c \u043c\u043d\u043e\u0433\u043e \u0440\u0435\u043a\u043e\u0440\u0434\u043e\u0432, \u0432\u0437\u044f\u0442\u044b\u0445 \u0441 \u043c\u0430\u0448\u0438\u043d \u0431\u0435\u0441\u0442\u043e\u0432, \u0438 \u043c\u044b \u043d\u0435 \u0437\u043d\u0430\u0435\u043c \u043d\u0430\u0432\u0435\u0440\u043d\u044f\u043a\u0430, \u043d\u0430 \u0440\u0430\u043d\u043a\u0435 \u043e\u043d\u0438 \u0438\u043b\u0438 \u043d\u0435\u0442. \u0415\u0441\u043b\u0438 \u0443 \u0438\u0433\u0440\u043e\u043a\u0430 \u0432 \u0442\u043e\u043f\u0435 \u0435\u0441\u0442\u044c \u0434\u0432\u0430 \u0441\u043a\u043e\u0440\u0430 - \u043d\u0430 \u0440\u0430\u043d\u043a\u0435 \u0438 \u0431\u0435\u0437 \u0440\u0430\u043d\u043a\u0430, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0442\u043e\u0442, \u0433\u0434\u0435 \u0431\u043e\u043b\u044c\u0448\u0435 \u043e\u0447\u043a\u043e\u0432.")),n.a.createElement("div",{className:"question-answer"},n.a.createElement("div",{className:"question"},"Q: \u041f\u043e\u0447\u0435\u043c\u0443 \u043c\u0435\u043d\u044f \u043d\u0435\u0442 \u0432 \u0440\u0435\u0439\u0442\u0438\u043d\u0433\u0435?"),n.a.createElement("div",{className:"answer"},"A: \u0412 \u0442\u0430\u0431\u043b\u0438\u0446\u0443 \u043f\u043e\u043f\u0430\u0434\u0430\u044e\u0442 \u0442\u043e\u043b\u044c\u043a\u043e \u0442\u0435, \u0443 \u043a\u043e\u0433\u043e \u0435\u0441\u0442\u044c \u0445\u043e\u0442\u044f \u0431\u044b 20 \u0438\u0433\u0440 1 \u043d\u0430 1. \u041f\u0435\u0440\u0432\u044b\u0435 20 \u0438\u0433\u0440 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442\u0441\u044f \u0434\u043b\u044f \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u044f \u0438\u0437\u043d\u0430\u0447\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u0440\u0435\u0439\u0442\u0438\u043d\u0433\u0430.")),n.a.createElement("div",{className:"question-answer"},n.a.createElement("div",{className:"question"},"Q: \u041f\u043e\u0447\u0435\u043c\u0443 \u0441\u0443\u043c\u043c\u0430\u0440\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043e\u0446\u0435\u043d\u043e\u043a S-A-B \u043d\u0435 \u0441\u043e\u0432\u043f\u0430\u0434\u0430\u0435\u0442 \u0441 \u043e\u0431\u0449\u0438\u043c \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e\u043c \u0441\u043a\u043e\u0440\u043e\u0432?"),n.a.createElement("div",{className:"answer"},"A: \u041d\u0435 \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430 \u0438\u0437\u0432\u0435\u0441\u0442\u043d\u0430 \u043e\u0446\u0435\u043d\u043a\u0430.")),n.a.createElement("div",{className:"question-answer"},n.a.createElement("div",{className:"question"},"Q: \u0415\u0441\u043b\u0438 \u0443 \u043c\u0435\u043d\u044f \u0435\u0441\u0442\u044c \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0440\u0435\u043a\u043e\u0440\u0434\u043e\u0432 \u043d\u0430 \u0410, \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u043d\u0430 \u0410+, \u043a\u0430\u043a \u0441\u0447\u0438\u0442\u0430\u0435\u0442\u0441\u044f \u0441\u0443\u043c\u043c\u0430\u0440\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0433\u0440\u0435\u0439\u0434\u043e\u0432 \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0435?"),n.a.createElement("div",{className:"answer"},"A: \u0412 \u043a\u0430\u0436\u0434\u043e\u0439 \u043a\u043e\u043b\u043e\u043d\u043a\u0435 \u0443\u0447\u0438\u0442\u044b\u0432\u0430\u044e\u0442\u0441\u044f \u043e\u0431\u0435 \u0431\u0443\u043a\u0432\u044b - \u0438 \u0442\u0440\u0435\u0441\u043d\u0443\u0442\u044b\u0435, \u0438 \u0441 \u0443\u0434\u0435\u0440\u0436\u0430\u043d\u043d\u044b\u043c \u043b\u0430\u0439\u0444\u043e\u043c. \u0422\u043e \u0435\u0441\u0442\u044c \u0438 \u0410, \u0438 \u0410+ \u0438\u0434\u0443\u0442 \u0432 \u043a\u043e\u043b\u043e\u043d\u043a\u0443 \u0410. \u0422\u043e\u0447\u043d\u043e \u0442\u0430\u043a \u0436\u0435 \u0434\u043b\u044f B, C, D.")),n.a.createElement("div",{className:"question-answer"},n.a.createElement("div",{className:"question"},"Q: \u0423\u0431\u0435\u0440\u0438 \u0430\u043a\u043a\u0443\u0440\u0430\u0441\u0438 \u0438\u0437 \u0442\u0430\u0431\u043b\u0438\u0446\u044b!"),n.a.createElement("div",{className:"answer"},"A: \u0413\u0440\u0435\u043c, \u044d\u0442\u043e \u0441\u0435\u043a\u0446\u0438\u044f \u0434\u043b\u044f \u0432\u043e\u043f\u0440\u043e\u0441\u043e\u0432.")))}function Aa(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Ta(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Aa(Object(a),!0).forEach((function(t){Object(i.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Aa(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const Ma="PREFERENCES/LOADING",Fa="PREFERENCES/SUCCESS",Ba="PREFERENCES/ERROR",Ha="PREFERENCES/CHANGE",Ka={playersHiddenStatus:{}},Wa={isLoading:!1,data:Ka,error:null};const Ua=Object(ya.a)(e=>e.results.profiles,f.a.flow(f.a.values,f.a.orderBy(["ratingRaw"],["desc"]))),Ga={fetchResults:wt,updatePreferences:e=>async t=>{t({type:Ha,data:e});try{await t(A({url:"".concat(F,"/profile/preferences"),body:{preferences:e}}))}catch(a){return null}}};class qa extends r.Component{constructor(...e){super(...e),this.onChangeHidingPlayers=()=>{const e=this.props,t=e.preferences;(0,e.updatePreferences)(f.a.set(["showHiddenPlayersInRanking"],!t.showHiddenPlayersInRanking,t))},this.onRefresh=()=>{!this.props.isLoading&&this.props.fetchResults()}}render(){const e=this.props,t=e.isLoading,a=e.ranking,r=e.error,s=e.preferences,c=e.updatePreferences;return n.a.createElement("div",{className:"ranking-page"},n.a.createElement("div",{className:"content"},r&&r.message,n.a.createElement("div",{className:"top-controls"},n.a.createElement("div",{className:"_flex-fill"}),n.a.createElement(m.b,{exact:!0,path:E.ranking.path,render:()=>n.a.createElement(n.a.Fragment,null,n.a.createElement("button",{className:"btn btn-sm btn-dark btn-icon _margin-right",onClick:this.onChangeHidingPlayers},s.showHiddenPlayersInRanking?"\u0441\u043a\u0440\u044b\u0442\u044c \u043d\u0435\u0432\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0445":"\u043f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0432\u0441\u0435\u0445"),n.a.createElement(l.b,{to:E.ranking.faq.path},n.a.createElement("button",{className:"btn btn-sm btn-dark btn-icon _margin-right"},n.a.createElement(k.p,null)," faq")),n.a.createElement("button",{disabled:t,className:"btn btn-sm btn-dark btn-icon",onClick:this.onRefresh},n.a.createElement(k.s,null)," \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c"))}),n.a.createElement(m.b,{exact:!0,path:E.ranking.faq.path,render:()=>n.a.createElement(l.b,{to:E.ranking.path},n.a.createElement("button",{className:"btn btn-sm btn-dark btn-icon"},"\u043d\u0430\u0437\u0430\u0434"))})),n.a.createElement(m.b,{exact:!0,path:E.ranking.path,render:()=>n.a.createElement(_a,{ranking:a,isLoading:t,preferences:s,updatePreferences:c})}),n.a.createElement(m.b,{exact:!0,path:E.ranking.faq.path,component:Ia})))}}qa.defaultProps={ranking:[]};var Va=Object(o.b)(e=>({preferences:e.preferences.data,ranking:Ua(e),error:e.results.error||e.tracklist.error,isLoading:e.results.isLoading||e.results.isLoadingRanking||e.tracklist.isLoading}),Ga)(Object(m.g)(qa)),za=a(3),Ya=(a(426),a(196)),Xa=(a(427),Object(o.b)(e=>({charts:e.results.sharedCharts}),{fetchJson:I})(({playerId:e,charts:t,fetchJson:a})=>{const s=Object(r.useState)(!1),c=Object(P.a)(s,2),o=c[0],i=c[1],m=Object(r.useState)(10),d=Object(P.a)(m,2),p=d[0],u=d[1],h=Object(r.useState)([]),g=Object(P.a)(h,2),b=g[0],y=g[1];return Object(r.useEffect)(()=>{i(!0),a({url:"".concat(F,"/player/").concat(e,"/mostPlayed?limit=").concat(p)}).then(e=>{i(!1),e.success&&y(e.data)}).catch(()=>{i(!1)})},[e,p,a]),n.a.createElement("div",{className:"most-played"},o&&n.a.createElement(w,null),b.map(e=>{const a=t[e.shared_chart];return n.a.createElement("div",{className:"chart",key:e.shared_chart},n.a.createElement("div",{className:j()("chart-name",{single:"S"===a.chartType,singlep:"SP"===a.chartType,doublep:"DP"===a.chartType,double:"D"===a.chartType,coop:"COOP"===a.chartType})},n.a.createElement("span",{className:"chart-letter"},a.chartType),n.a.createElement("span",{className:"chart-number"},a.chartLevel)),n.a.createElement("div",{className:"song-name"},n.a.createElement(l.c,{exact:!0,to:E.leaderboard.sharedChart.getPath({sharedChartId:a.sharedChartId})},a.song)),n.a.createElement("div",{className:"date"},e.latestDate?ue(he(e.latestDate)):null),n.a.createElement("div",{className:"playcount"},n.a.createElement(k.n,null),n.a.createElement("span",null,e.count)))}),p===f.a.size(b)&&n.a.createElement("button",{className:"show-more btn btn-sm btn-dark btn-icon",onClick:()=>u(p+10)},n.a.createElement(Ya.a,null)," \u0431\u043e\u043b\u044c\u0448\u0435"))}));function Ja(){return n.a.createElement("div",{className:"faq-exp"},n.a.createElement("div",{className:"faq-header"},n.a.createElement("strong",null,"\u041e\u043f\u044b\u0442")," \u0438\u0433\u0440\u043e\u043a\u0430 \u043e\u0441\u043d\u043e\u0432\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u043d\u0430 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0435 \u0441\u044b\u0433\u0440\u0430\u043d\u043d\u044b\u0445 \u043f\u0435\u0441\u0435\u043d \u0438 \u0447\u0430\u0440\u0442\u043e\u0432.",n.a.createElement("br",null),"\u0427\u0435\u043c \u0432\u044b\u0448\u0435 \u0443\u0440\u043e\u0432\u0435\u043d\u044c \u0447\u0430\u0440\u0442\u0430 \u0438 \u0447\u0435\u043c \u043b\u0443\u0447\u0448\u0435 \u043e\u0446\u0435\u043d\u043a\u0430 \u043d\u0430 \u0447\u0430\u0440\u0442\u0435, \u0442\u0435\u043c \u0431\u043e\u043b\u044c\u0448\u0435 \u043e\u043f\u044b\u0442\u0430 \u043e\u043d \u0434\u0430\u0451\u0442.",n.a.createElement("br",null),"\u041f\u043e\u0432\u0442\u043e\u0440\u043d\u044b\u0435 \u043f\u043e\u043f\u044b\u0442\u043a\u0438 \u043d\u0430 \u0442\u0435\u0445 \u0436\u0435 \u0447\u0430\u0440\u0442\u0430\u0445 \u043d\u0435 \u0434\u0430\u044e\u0442 \u0431\u043e\u043b\u044c\u0448\u0435 \u043e\u043f\u044b\u0442\u0430. \u0427\u0442\u043e\u0431\u044b \u043f\u043e\u0434\u043d\u0438\u043c\u0430\u0442\u044c \u0441\u0432\u043e\u0439 \u0443\u0440\u043e\u0432\u0435\u043d\u044c, \u0438\u0433\u0440\u0430\u0439 \u043d\u043e\u0432\u044b\u0435 \u0442\u0440\u0435\u043a\u0438 \u0438 \u0447\u0430\u0440\u0442\u044b."),n.a.createElement("div",{className:"faq-header"},"\u0421\u043f\u0438\u0441\u043e\u043a \u0443\u0440\u043e\u0432\u043d\u0435\u0439 \u0438 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b\u0439 \u043e\u043f\u044b\u0442 \u0434\u043b\u044f \u0438\u0445 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f:"),n.a.createElement("div",{className:"ranks-list"},qe.map((function(e){return n.a.createElement("div",{key:e.threshold,className:"rank"},n.a.createElement("div",{className:"exp-rank"},Ye(e)),n.a.createElement("div",{className:"threshold"},e.threshold))}))))}function Qa(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Za(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Qa(Object(a),!0).forEach((function(t){Object(i.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Qa(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const $a="PROFILES/SET_FILTER",er="PROFILES/RESET_FILTER",tr={},ar={isLoading:!1,filter:tr};const rr=e=>({type:$a,filter:e}),nr=()=>({type:er});function sr(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function cr(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?sr(Object(a),!0).forEach((function(t){Object(i.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):sr(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const lr=(e,t)=>{const a=f.a.findIndex(e=>e.date>t[0],e),r=f.a.findLastIndex(e=>e.date<t[1],e);let n=a>0?e[a-1]:0===a?e[a]:f.a.last(e),s=r>-1?e[r]:f.a.first(e);return n=cr({},n,{date:t[0]}),s=cr({},s,{date:t[1]}),[n,...a>-1&&r>-1?e.slice(a,r+1):[],s]},or={SSS:0,SS:0,S:0,"A+":0,A:0,B:0,C:0,D:0,F:0},ir=f.a.flow(f.a.flatMap(e=>f.a.flow(f.a.toPairs,f.a.map(([t,a])=>["".concat(e,"-").concat(t),a]))(or)),f.a.fromPairs)(["S","D"]),mr=e=>Object(ya.a)((t,a)=>f.a.toInteger(a.match.params[e]),e=>e.results.isLoading||e.results.isLoadingRanking,e=>e.results.profiles,e=>e.profiles.filter,e=>e.tracklist.data,(e,t,a,r,n)=>{const s=a[e];if(f.a.isEmpty(s)||t)return null;const c=f.a.flow(f.a.get("resultsByLevel"),f.a.toPairs,f.a.map(([e,t])=>({x:f.a.toInteger(e),S:f.a.size(f.a.filter(e=>"S"===e.chart.chartType||"SP"===e.chart.chartType,t))/n.singlesLevels[e]*100,D:-f.a.size(f.a.filter(e=>"D"===e.chart.chartType||"DP"===e.chart.chartType,t))/n.doublesLevels[e]*100})))(s),l=f.a.flow(f.a.get("resultsByLevel"),f.a.toPairs,f.a.map(f.a.update("[1].result.grade",e=>e&&e.includes("+")&&"A+"!==e?e.replace("+",""):e)))(s),o=f.a.flow(f.a.map(([e,t])=>cr({x:f.a.toInteger(e)},or,{},f.a.omit("?",f.a.mapValues(f.a.size,f.a.groupBy("result.grade",t))))),f.a.map(e=>{const t=f.a.pick(Object.keys(or),e),a=f.a.sum(f.a.values(t));return cr({},e,{gradesValues:t},0===a?t:f.a.mapValues(e=>100*e/a,t))}))(l),i=f.a.flow(f.a.map(([e,t])=>{const a=f.a.groupBy("result.grade",t),r=f.a.omit("?",f.a.mapValues(f.a.countBy(e=>"S"===e.chart.chartType||"SP"===e.chart.chartType?"S":"D"===e.chart.chartType||"DP"===e.chart.chartType?"D":"Other"),a)),s=f.a.reduce((t,[a,r])=>{return cr({},t,{},f.a.flow(f.a.toPairs,f.a.map(([t,r])=>["".concat(t,"-").concat(a),"S"===t?r/n.singlesLevels[e]*100:-r/n.doublesLevels[e]*100]),f.a.fromPairs)(r))},{},f.a.toPairs(r));return cr({x:f.a.toInteger(e)},ir,{},s)}))(l),m=f.a.last(s.ratingHistory).date,d=f.a.last(s.rankingHistory).date,p=m>d?m:d,u=f.a.first(s.ratingHistory).date,h=ie()(p).endOf("day"),g=[ie()(u).startOf("day")/1e3/60/60/24,h/1e3/60/60/24],E=r.dayRange||[Math.max(g[0],g[1]-30),g[1]],b=[+ie()(1e3*E[0]*60*60*24).startOf("day"),+ie()(1e3*E[1]*60*60*24).endOf("day")],y=lr(s.rankingHistory,b),v=lr(s.ratingHistory,b);return cr({},s,{rank:1+f.a.findIndex({id:e},f.a.orderBy(["ratingRaw"],["desc"],f.a.values(a))),minMaxRange:g,filterRange:E,levelsDistribution:c,gradesDistribution:o,gradesAndLevelsDistribution:i,placesChanges:y,ratingChanges:v})});function dr(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}const pr=void 0,ur=mr("id"),hr=Object(ya.a)(e=>e.results.players,(e,t)=>f.a.toNumber(t.match.params.id),(e,t)=>f.a.flow(f.a.toPairs,f.a.map(([e,{nickname:t,arcade_name:a,id:r}])=>({label:"".concat(t," (").concat(a,")"),value:t,id:f.a.toNumber(r)})),f.a.remove(e=>e.id===t),f.a.sortBy(e=>f.a.toLower(e.label)))(e)),gr={fetchResults:wt,setProfilesFilter:rr,resetProfilesFilter:nr};class fr extends r.Component{constructor(...e){super(...e),this.state={isLevelGraphCombined:!0,showFaq:!1},this.onRefresh=()=>{!this.props.isLoading&&this.props.fetchResults()},this.onChangeDayRange=e=>{const t=this.props.filter;this.props.setProfilesFilter(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?dr(Object(a),!0).forEach((function(t){Object(i.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):dr(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},t,{dayRange:e}))},this.onShowFaq=()=>{this.setState({showFaq:!0})},this.onHideFaq=()=>{this.setState({showFaq:!1})},this.circleShape=e=>n.a.createElement("circle",{key:e.key,cx:e.cx,cy:e.cy,r:4,fill:e.fill})}componentWillUnmount(){this.props.resetProfilesFilter()}renderRankingHistory(){const e=this.props.profile;return n.a.createElement(za.i,{minHeight:pr,aspect:1.6},n.a.createElement(za.g,{data:e.ratingChanges,margin:{top:5,bottom:5,right:5,left:0}},n.a.createElement(za.c,{strokeDasharray:"3 3"}),n.a.createElement(za.m,{dataKey:"date",type:"number",domain:["dataMin","dataMax"],tickFormatter:e=>he(e).toLocaleDateString()}),n.a.createElement(za.n,{allowDecimals:!1,domain:["dataMin - 100","dataMax + 100"],tickFormatter:Math.round,width:40}),n.a.createElement(za.h,{y:1e3,stroke:"white"}),n.a.createElement(za.l,{isAnimationActive:!1,content:({active:e,payload:t,label:a})=>t&&t[0]?n.a.createElement("div",{className:"history-tooltip"},n.a.createElement("div",null,he(t[0].payload.date).toLocaleDateString()),t&&t[0]&&n.a.createElement("div",null,"Rating: ",Math.round(t[0].value))):null}),n.a.createElement(za.f,{type:"monotone",isAnimationActive:!1,dataKey:"rating",stroke:"#88d3ff",strokeWidth:3,dot:!1})))}renderAccuracyPoints(e=!1){const t=this.props,a=t.profile,r=t.sharedCharts,s=f.a.groupBy(([,,e])=>{const t=r[e].chartType;return"D"===t||"DP"===t},a.accuracyPointsRaw);return e?n.a.createElement(za.i,{minHeight:pr,aspect:1.6},n.a.createElement(za.g,{margin:{top:5,bottom:5,right:5,left:0}},n.a.createElement(za.c,{strokeDasharray:"3 3"}),n.a.createElement(za.m,{dataKey:"[0]",type:"number",domain:[1,28],tickFormatter:e=>Math.round(e)}),n.a.createElement(za.n,{domain:[0,100],width:40}),n.a.createElement(za.l,{isAnimationActive:!1,content:({active:e,payload:t,label:a})=>t&&t[0]?n.a.createElement("div",{className:"history-tooltip"},n.a.createElement("div",null,t[0].payload[0]),t&&t[0]&&n.a.createElement("div",null,"Acc: #",t[0].value)):null}),n.a.createElement(za.f,{data:a.accuracyPointsInterpolated,isAnimationActive:!1,dataKey:"[1]",stroke:"#88d3ff",strokeWidth:3,dot:!1}))):n.a.createElement(za.i,{minHeight:pr,aspect:1.6},n.a.createElement(za.k,{margin:{top:5,bottom:5,right:5,left:0}},n.a.createElement(za.c,{strokeDasharray:"3 3"}),n.a.createElement(za.m,{dataKey:"[0]",type:"number",domain:[1,28],tickFormatter:e=>Math.round(e),ticks:[1,3,5,7,9,11,13,15,17,19,21,23,25,27]}),n.a.createElement(za.n,{dataKey:"[1]",type:"number",domain:[0,100],width:40,tickFormatter:e=>Math.round(e)+"%"}),n.a.createElement(za.j,{data:s.true,shape:this.circleShape,fill:"#169c16"}),n.a.createElement(za.j,{data:s.false,shape:this.circleShape,fill:"#af2928"}),n.a.createElement(za.l,{isAnimationActive:!1,content:({active:e,payload:t,label:a})=>{if(!t||!t[0]||!t[1])return null;const s=t[0].payload[2]&&r[t[0].payload[2]];return n.a.createElement("div",{className:"history-tooltip"},n.a.createElement("div",null,"Level: ",t[0].value),n.a.createElement("div",null,"Accuracy: ",t[1].value,"%"),s&&n.a.createElement("div",null,s.song," ",s.chartLabel," (",s.interpolatedDifficulty.toFixed(1),")"))}})))}renderPlaceHistory(){const e=this.props.profile;return n.a.createElement(za.i,{minHeight:pr,aspect:1.6},n.a.createElement(za.g,{data:e.placesChanges,margin:{top:5,bottom:5,right:5,left:0}},n.a.createElement(za.c,{strokeDasharray:"3 3"}),n.a.createElement(za.m,{dataKey:"date",type:"number",domain:["dataMin","dataMax"],tickFormatter:e=>he(e).toLocaleDateString()}),n.a.createElement(za.n,{allowDecimals:!1,domain:[1,e=>e<3?e+2:e+1],interval:0,reversed:!0,width:40}),n.a.createElement(za.l,{isAnimationActive:!1,content:({active:e,payload:t,label:a})=>t&&t[0]?n.a.createElement("div",{className:"history-tooltip"},n.a.createElement("div",null,he(t[0].payload.date).toLocaleDateString()),t&&t[0]&&n.a.createElement("div",null,"Place: #",t[0].value)):null}),n.a.createElement(za.f,{isAnimationActive:!1,type:"stepAfter",dataKey:"place",stroke:"#88d3ff",strokeWidth:3,dot:!1})))}renderGrades(){const e=this.props.profile;return n.a.createElement(za.i,{minHeight:pr,aspect:1.6},n.a.createElement(za.b,{data:e.gradesDistribution,margin:{top:5,bottom:5,right:5,left:0}},n.a.createElement(za.l,{isAnimationActive:!1,content:({active:e,payload:t,label:a})=>t&&t[0]?n.a.createElement("div",{className:"history-tooltip"},n.a.createElement("div",null,"Level: ",t[0].payload.x),f.a.filter(e=>e.value>0,t).map(e=>n.a.createElement("div",{key:e.name,style:{fontWeight:"bold",color:e.color}},e.name,": ",t[0].payload.gradesValues[e.name]))):null}),n.a.createElement(za.m,{dataKey:"x"}),n.a.createElement(za.n,{domain:[0,100],ticks:[0,50,100],tickFormatter:e=>"".concat(Math.round(e),"%"),width:40}),n.a.createElement(za.e,null),n.a.createElement(za.a,{dataKey:"SSS",fill:"#ffd700",stackId:"stack"}),n.a.createElement(za.a,{dataKey:"SS",fill:"#dab800",stackId:"stack"}),n.a.createElement(za.a,{dataKey:"S",fill:"#b19500",stackId:"stack"}),n.a.createElement(za.a,{dataKey:"A+",fill:"#396eef",stackId:"stack"}),n.a.createElement(za.a,{dataKey:"A",fill:"#828fb7",stackId:"stack"}),n.a.createElement(za.a,{dataKey:"B",fill:"#7a6490",stackId:"stack"}),n.a.createElement(za.a,{dataKey:"C",fill:"#6d5684",stackId:"stack"}),n.a.createElement(za.a,{dataKey:"D",fill:"#5d4e6d",stackId:"stack"}),n.a.createElement(za.a,{dataKey:"F",fill:"#774949",stackId:"stack"})))}renderGradesWithLevels(){const e=this.props,t=e.profile,a=e.tracklist;return n.a.createElement(za.i,{minHeight:pr,aspect:.74},n.a.createElement(za.b,{data:t.gradesAndLevelsDistribution,margin:{top:5,bottom:5,right:5,left:0},stackOffset:"sign"},n.a.createElement(za.l,{isAnimationActive:!1,content:({active:e,payload:t,label:r})=>{if(!t||!t[0])return null;const s=f.a.filter(e=>0!==e.value&&e.dataKey.startsWith("D"),t),c=f.a.filter(e=>0!==e.value&&e.dataKey.startsWith("S"),t);return n.a.createElement("div",{className:"history-tooltip"},n.a.createElement("div",null,"Level: ",t[0].payload.x),!!c.length&&n.a.createElement(n.a.Fragment,null,n.a.createElement("div",null,"Single:"),c.map(e=>n.a.createElement("div",{key:e.name,style:{fontWeight:"bold",color:e.color}},e.name.slice(2),": ",Math.round(Math.abs(e.value)),"% (",Math.round(a.singlesLevels[e.payload.x]*e.value/100),"/",a.singlesLevels[e.payload.x],")"))),!!s.length&&n.a.createElement(n.a.Fragment,null,n.a.createElement("div",null,"Double:"),s.map(e=>n.a.createElement("div",{key:e.name,style:{fontWeight:"bold",color:e.color}},e.name.slice(2),": ",Math.round(Math.abs(e.value)),"% (",Math.round(a.doublesLevels[e.payload.x]*-e.value/100),"/",a.doublesLevels[e.payload.x],")"))))}}),n.a.createElement(za.m,{dataKey:"x"}),n.a.createElement(za.n,{tickFormatter:e=>"".concat(Math.round(Math.abs(e)),"%"),width:40,domain:[e=>Math.min(e,-10),e=>Math.max(10,e)]}),n.a.createElement(za.a,{dataKey:"S-SSS",fill:"#ffd700",stackId:"stack"}),n.a.createElement(za.a,{dataKey:"S-SS",fill:"#dab800",stackId:"stack"}),n.a.createElement(za.a,{dataKey:"S-S",fill:"#b19500",stackId:"stack"}),n.a.createElement(za.a,{dataKey:"S-A+",fill:"#396eef",stackId:"stack"}),n.a.createElement(za.a,{dataKey:"S-A",fill:"#828fb7",stackId:"stack"}),n.a.createElement(za.a,{dataKey:"S-B",fill:"#7a6490",stackId:"stack"}),n.a.createElement(za.a,{dataKey:"S-C",fill:"#6d5684",stackId:"stack"}),n.a.createElement(za.a,{dataKey:"S-D",fill:"#5d4e6d",stackId:"stack"}),n.a.createElement(za.a,{dataKey:"S-F",fill:"#774949",stackId:"stack"}),n.a.createElement(za.a,{dataKey:"D-SSS",fill:"#ffd700",stackId:"stack"}),n.a.createElement(za.a,{dataKey:"D-SS",fill:"#dab800",stackId:"stack"}),n.a.createElement(za.a,{dataKey:"D-S",fill:"#b19500",stackId:"stack"}),n.a.createElement(za.a,{dataKey:"D-A+",fill:"#396eef",stackId:"stack"}),n.a.createElement(za.a,{dataKey:"D-A",fill:"#828fb7",stackId:"stack"}),n.a.createElement(za.a,{dataKey:"D-B",fill:"#7a6490",stackId:"stack"}),n.a.createElement(za.a,{dataKey:"D-C",fill:"#6d5684",stackId:"stack"}),n.a.createElement(za.a,{dataKey:"D-D",fill:"#5d4e6d",stackId:"stack"}),n.a.createElement(za.a,{dataKey:"D-F",fill:"#774949",stackId:"stack"}),n.a.createElement(za.d,{value:"Double",offset:0,position:"insideBottomLeft"}),n.a.createElement(za.d,{value:"Single",offset:0,position:"insideTopLeft"}),n.a.createElement(za.h,{y:0,stroke:"#bbb"})))}renderLevels(){const e=this.props,t=e.profile,a=e.tracklist;return n.a.createElement(za.i,{minHeight:pr,aspect:1.6},n.a.createElement(za.b,{data:t.levelsDistribution,stackOffset:"sign",margin:{top:5,bottom:5,right:5,left:0}},n.a.createElement(za.l,{isAnimationActive:!1,content:({active:e,payload:t,label:r})=>{if(!t||!t[0])return null;const s=a.doublesLevels[t[0].payload.x],c=a.singlesLevels[t[0].payload.x];return n.a.createElement("div",{className:"history-tooltip"},n.a.createElement("div",null,"Level: ",t[0].payload.x),c>0&&n.a.createElement("div",{style:{fontWeight:"bold",color:t[1].color}},"Single: ",Math.abs(t[1].value).toFixed(1),"% (",Math.round(t[1].value*c/100),"/",c,")"),s>0&&n.a.createElement("div",{style:{fontWeight:"bold",color:t[0].color}},"Double: ",Math.abs(t[0].value).toFixed(1),"% (",Math.round(Math.abs(t[0].value)*s/100),"/",s,")"))}}),n.a.createElement(za.m,{dataKey:"x"}),n.a.createElement(za.n,{tickFormatter:e=>Math.round(Math.abs(e))+"%",width:40,domain:[e=>Math.min(e,-10),e=>Math.max(10,e)]}),n.a.createElement(za.l,null),n.a.createElement(za.h,{y:0,stroke:"#555"}),n.a.createElement(za.e,null),n.a.createElement(za.a,{dataKey:"D",fill:"#169c16",stackId:"stack"}),n.a.createElement(za.a,{dataKey:"S",fill:"#af2928",stackId:"stack"})))}renderGradeBlock(e,t){const a=this.props.profile.progress[e],r="double"===e?"D":"S",s=Math.floor(100*(a["".concat(t,"-bonus-level-coef")]||0)),c=a["".concat(t,"-bonus-level-min-number")],l=a["".concat(t,"-bonus-level-achieved-number")],o=a["".concat(t,"-bonus-level")]?"".concat(r).concat(a["".concat(t,"-bonus-level")]):"?";return n.a.createElement("div",{className:"grade-block"},n.a.createElement("div",{className:"grade-letter"},n.a.createElement("img",{src:"".concat(".","/grades/").concat(t,".png"),alt:t})),n.a.createElement("div",{className:"grade-level"},o),n.a.createElement("div",{className:"grade-progress"},s,"% (",100===s?c:l,"/",c,")"),n.a.createElement("div",{className:j()("progress-background",{complete:100===s,zero:0===s}),style:{height:"".concat(s,"%")}}))}renderAchievement(e,t){const a=Je[e].icon,r=Je[e].description;return n.a.createElement(aa.a,{key:e,content:n.a.createElement("div",null,r),tooltipClassName:"pumpking-tooltip achievement-tooltip"},n.a.createElement("div",{className:"ach-block"},a&&n.a.createElement("div",{className:"ach-icon"},n.a.createElement(a,null)),n.a.createElement("div",{className:"ach-name"},e),n.a.createElement("div",{className:j()("progress-background",{complete:100===t.progress,zero:0===t.progress}),style:{height:"".concat(Math.round(t.progress),"%")}})))}renderProfile(){const e=this.props,t=e.profile,a=e.otherPlayers,r=e.filter,s=this.state.isLevelGraphCombined,c=t.expRankNext?(t.exp-t.expRank.threshold)/(t.expRankNext.threshold-t.expRank.threshold):100;return n.a.createElement("div",{className:"profile"},n.a.createElement("div",{className:"profile-header"},n.a.createElement("div",{className:"profile-name text-with-header"},n.a.createElement("div",{className:"text-header"},"\u0438\u0433\u0440\u043e\u043a"),n.a.createElement("div",null,t.name)),n.a.createElement("div",{className:"text-with-header"},n.a.createElement("div",{className:"text-header"},"\u0440\u0430\u043d\u043a"),n.a.createElement("div",null,"#",t.rank)),n.a.createElement("div",{className:"text-with-header"},n.a.createElement("div",{className:"text-header"},"\u044d\u043b\u043e"),n.a.createElement("div",null,t.rating)),n.a.createElement("div",{className:"text-with-header"},n.a.createElement("div",{className:"text-header"},"\u043f\u043e\u0441\u043b\u0435\u0434\u043d\u044f\u044f \u0438\u0433\u0440\u0430"),n.a.createElement("div",null,t.lastResultDate?ue(t.lastResultDate):"\u043d\u0438\u043a\u043e\u0433\u0434\u0430")),n.a.createElement("div",{className:"_flex-fill"}),n.a.createElement("div",{className:"text-with-header -select"},n.a.createElement("div",{className:"text-header"},"\u0441\u0440\u0430\u0432\u043d\u0438\u0442\u044c \u0441"),n.a.createElement("div",null,n.a.createElement(be.a,{closeMenuOnSelect:!0,className:"select players",classNamePrefix:"select",placeholder:"\u0438\u0433\u0440\u043e\u043a\u0438...",options:a,onChange:e=>{this.props.history.push(E.profile.compare.getPath({id:t.id,compareToId:e.id}))}})))),n.a.createElement("div",{className:"profile-section"},n.a.createElement("div",{className:"profile-sm-section-header _flex-row _align-center"},n.a.createElement("span",null,"\u043e\u043f\u044b\u0442"),n.a.createElement("div",{className:"_flex-fill"}),n.a.createElement("div",{onClick:this.onShowFaq,className:"_clickable"},n.a.createElement(k.p,{onClick:this.onShowFaq})),n.a.createElement(h.a,{ariaHideApp:!1,className:"Modal faq-modal",overlayClassName:"Overlay",isOpen:this.state.showFaq,onRequestClose:this.onHideFaq},n.a.createElement("div",{className:"close-btn",onClick:this.onHideFaq},n.a.createElement(k.t,null))," ",n.a.createElement(Ja,null))),n.a.createElement("div",{className:"exp-range"},n.a.createElement("div",{className:"rank exp-rank"},Ye(t.expRank),t.expRank&&n.a.createElement("div",null,t.expRank.threshold)),n.a.createElement("div",{className:"exp-line-with-label"},n.a.createElement("div",{className:"exp-label"},t.expRankNext?n.a.createElement(n.a.Fragment,null,n.a.createElement("span",{className:"taken-num"},Math.round(t.exp-t.expRank.threshold))," / ".concat(t.expRankNext.threshold-t.expRank.threshold)):null),n.a.createElement("div",{className:"exp-line"},n.a.createElement("div",{className:"taken",style:{width:Math.floor(100*c)+"%"}}),n.a.createElement("div",{className:"rest",style:{width:100-Math.ceil(100*c)+"%"}})),n.a.createElement("div",{className:"exp-label"},"total: ",n.a.createElement("span",{className:"taken-num"},Math.round(t.exp)))),t.expRankNext&&n.a.createElement("div",{className:"rank exp-rank"},Ye(t.expRankNext),t.expRankNext&&n.a.createElement("div",null,t.expRankNext.threshold)))),n.a.createElement("div",{className:"profile-section-horizontal-container"},n.a.createElement("div",{className:"profile-section"},n.a.createElement("div",{className:"profile-section-content"},s?n.a.createElement("div",{className:"profile-section-2"},n.a.createElement("div",{className:"profile-sm-section-header flex"},n.a.createElement("span",null,"\u043e\u0446\u0435\u043d\u043a\u0438"),n.a.createElement("div",{className:"toggle-holder"},n.a.createElement(we,{className:"combine-toggle",checked:s,onChange:()=>this.setState(e=>({isLevelGraphCombined:!e.isLevelGraphCombined}))},"\u043e\u0431\u044a\u0435\u0434\u0438\u043d\u0438\u0442\u044c \u0433\u0440\u0430\u0444\u0438\u043a\u0438"))),n.a.createElement("div",{className:"chart-container single-double-labels"},this.renderGradesWithLevels())):n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"profile-section-2"},n.a.createElement("div",{className:"profile-sm-section-header flex"},n.a.createElement("span",null,"\u0443\u0440\u043e\u0432\u043d\u0438"),n.a.createElement("div",{className:"toggle-holder"},n.a.createElement(we,{className:"combine-toggle",checked:s,onChange:()=>this.setState(e=>({isLevelGraphCombined:!e.isLevelGraphCombined}))},"\u043e\u0431\u044a\u0435\u0434\u0438\u043d\u0438\u0442\u044c \u0433\u0440\u0430\u0444\u0438\u043a\u0438"))),n.a.createElement("div",{className:"chart-container"},this.renderLevels())),n.a.createElement("div",{className:"profile-section-2"},n.a.createElement("div",{className:"profile-sm-section-header"},n.a.createElement("span",null,"\u043e\u0446\u0435\u043d\u043a\u0438")),n.a.createElement("div",{className:"chart-container"},this.renderGrades()))))),n.a.createElement("div",{className:"profile-section"},n.a.createElement("div",{className:"profile-section-content"},n.a.createElement("div",{className:"profile-section-2"},n.a.createElement("div",{className:"profile-sm-section-header"},n.a.createElement("span",null,"\u044d\u043b\u043e")),n.a.createElement("div",{className:"chart-container"},this.renderRankingHistory())),n.a.createElement("div",{className:"profile-section-2"},n.a.createElement("div",{className:"profile-sm-section-header"},n.a.createElement("span",null,"\u043c\u0435\u0441\u0442\u043e \u0432 \u0442\u043e\u043f\u0435")),n.a.createElement("div",{className:"chart-container"},this.renderPlaceHistory()))),(()=>{const e=r.dayRange||t.filterRange,a=ie()(1e3*e[0]*60*60*24).format("L"),s=ie()(1e3*e[1]*60*60*24).format("L"),c=Math.max(e[0]-1,t.minMaxRange[0]),l=Math.min(e[0]+1,e[1]),o=Math.max(e[1]-1,e[0]),i=Math.min(e[1]+1,t.minMaxRange[1]);return n.a.createElement("div",{className:"range-container"},n.a.createElement(He,{range:e,min:t.minMaxRange[0],max:t.minMaxRange[1],onChange:this.onChangeDayRange}),n.a.createElement("div",{className:"range-controls _flex-row"},n.a.createElement("button",{className:"btn btn-sm btn-dark",onClick:()=>this.onChangeDayRange([c,e[1]])},n.a.createElement(k.e,null)),n.a.createElement("span",{className:"date-text"},a),n.a.createElement("button",{className:"btn btn-sm btn-dark",onClick:()=>this.onChangeDayRange([l,e[1]])},n.a.createElement(k.f,null)),n.a.createElement("div",{className:"_flex-fill"}),n.a.createElement("button",{className:"btn btn-sm btn-dark",onClick:()=>this.onChangeDayRange([e[0],o])},n.a.createElement(k.e,null)),n.a.createElement("span",{className:"date-text"},s),n.a.createElement("button",{className:"btn btn-sm btn-dark",onClick:()=>this.onChangeDayRange([e[0],i])},n.a.createElement(k.f,null))))})())),n.a.createElement("div",{className:"profile-section-horizontal-container"},n.a.createElement("div",{className:"profile-section"},n.a.createElement("div",{className:"profile-section-content"},n.a.createElement("div",{className:"profile-section-2"},n.a.createElement("div",{className:"profile-sm-section-header"},n.a.createElement("span",null,"\u0442\u043e\u0447\u043d\u043e\u0441\u0442\u044c \u043f\u043e \u0443\u0440\u043e\u0432\u043d\u044f\u043c")),n.a.createElement("div",{className:"chart-container"},this.renderAccuracyPoints())))),n.a.createElement("div",{className:"profile-section"})),n.a.createElement("div",{className:"profile-section progress-section"},n.a.createElement("div",{className:"profile-sm-section-header"},n.a.createElement("span",null,"\u0434\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u044f \u043f\u043e \u0443\u0440\u043e\u0432\u043d\u044f\u043c")),n.a.createElement("div",{className:"progress-blocks-single-double"},n.a.createElement("div",{className:"progress-block"},n.a.createElement("div",{className:"achievements-grades single"},this.renderGradeBlock("single","A"),this.renderGradeBlock("single","A+"),this.renderGradeBlock("single","S"),this.renderGradeBlock("single","SS"))),n.a.createElement("div",{className:"progress-block"},n.a.createElement("div",{className:"achievements-grades double"},this.renderGradeBlock("double","A"),this.renderGradeBlock("double","A+"),this.renderGradeBlock("double","S"),this.renderGradeBlock("double","SS")))),n.a.createElement("div",{className:"bonus-faq"},"* \u0434\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0430\u0447\u0438\u0432\u043a\u0438 \u043d\u0443\u0436\u043d\u043e \u0441\u044b\u0433\u0440\u0430\u0442\u044c \u043e\u043a\u043e\u043b\u043e 10% \u0432\u0441\u0435\u0445 \u0447\u0430\u0440\u0442\u043e\u0432 \u0434\u0430\u043d\u043d\u043e\u0433\u043e \u043b\u0435\u0432\u0435\u043b\u0430 \u043d\u0430 \u043d\u0443\u0436\u043d\u044b\u0439 \u0433\u0440\u0435\u0439\u0434")),n.a.createElement("div",{className:"profile-section"},n.a.createElement("div",{className:"profile-sm-section-header"},n.a.createElement("span",null,"\u0434\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u044f")),n.a.createElement("div",{className:"achievements"},f.a.keys(t.achievements).map(e=>this.renderAchievement(e,t.achievements[e])))),n.a.createElement("div",{className:"profile-section"},n.a.createElement("div",{className:"profile-sm-section-header"},n.a.createElement("span",null,"\u0447\u0430\u0441\u0442\u043e \u0438\u0433\u0440\u0430\u0435\u043c\u044b\u0435 \u0447\u0430\u0440\u0442\u044b")),n.a.createElement(Xa,{playerId:t.id})))}render(){const e=this.props,t=e.isLoading,a=e.profile,r=e.error;return lt&&console.log("profile:",a),n.a.createElement("div",{className:"profile-page"},n.a.createElement("div",{className:"content"},r&&r.message,n.a.createElement("div",{className:"top-controls"},n.a.createElement("div",{className:"_flex-fill"}),n.a.createElement("button",{disabled:t,className:"btn btn-sm btn-dark btn-icon",onClick:this.onRefresh},n.a.createElement(k.s,null)," \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c")),t&&n.a.createElement(w,null),!t&&f.a.isEmpty(a)&&n.a.createElement("div",{className:"profile"},"Profile not found"),!t&&!f.a.isEmpty(a)&&this.renderProfile()))}}fr.defaultProps={profile:{}};var Er=Object(o.b)((e,t)=>({profile:ur(e,t),otherPlayers:hr(e,t),tracklist:e.tracklist.data,filter:e.profiles.filter,error:e.results.error||e.tracklist.error,sharedCharts:e.results.sharedCharts,isLoading:e.results.isLoading||e.results.isLoadingRanking||e.tracklist.isLoading}),gr)(Object(m.g)(fr)),br=a(197);a(428);function yr(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}const vr={SINGLE_TWO:"SINGLE_TWO",SINGLE_FIVE:"SINGLE_FIVE",DOUBLE_TWO:"DOUBLE_TWO",DOUBLE_FIVE:"DOUBLE_FIVE",BOTH_TWO:"BOTH_TWO",BOTH_FIVE:"BOTH_FIVE"},Or=e=>{switch(e){case vr.SINGLE_TWO:return[n.a.createElement(za.a,{key:"11",dataKey:"single.twoBars.p1win",fill:"#4696f0",stackId:"stack",isAnimationActive:!0}),n.a.createElement(za.a,{key:"22",dataKey:"single.twoBars.p2win",fill:"#eda338",stackId:"stack",isAnimationActive:!0})];case vr.SINGLE_FIVE:return[n.a.createElement(za.a,{key:"1",dataKey:"single.p1win",fill:"#4696f0",stackId:"stack",isAnimationActive:!0}),n.a.createElement(za.a,{key:"2",dataKey:"single.p2notPlayed",fill:"#899db3",stackId:"stack",isAnimationActive:!0}),n.a.createElement(za.a,{key:"3",dataKey:"single.notPlayed",fill:"#70707060",stackId:"stack",isAnimationActive:!0}),n.a.createElement(za.a,{key:"4",dataKey:"single.p1notPlayed",fill:"#bfa988",stackId:"stack",isAnimationActive:!0}),n.a.createElement(za.a,{key:"5",dataKey:"single.p2win",fill:"#eda338",stackId:"stack",isAnimationActive:!0})];case vr.DOUBLE_TWO:return[n.a.createElement(za.a,{key:"11",dataKey:"double.twoBars.p1win",fill:"#4696f0",stackId:"stack",isAnimationActive:!0}),n.a.createElement(za.a,{key:"22",dataKey:"double.twoBars.p2win",fill:"#eda338",stackId:"stack",isAnimationActive:!0})];case vr.DOUBLE_FIVE:return[n.a.createElement(za.a,{key:"1",dataKey:"double.p1win",fill:"#4696f0",stackId:"stack",isAnimationActive:!0}),n.a.createElement(za.a,{key:"2",dataKey:"double.p2notPlayed",fill:"#899db3",stackId:"stack",isAnimationActive:!0}),n.a.createElement(za.a,{key:"3",dataKey:"double.notPlayed",fill:"#70707060",stackId:"stack",isAnimationActive:!0}),n.a.createElement(za.a,{key:"4",dataKey:"double.p1notPlayed",fill:"#bfa988",stackId:"stack",isAnimationActive:!0}),n.a.createElement(za.a,{key:"5",dataKey:"double.p2win",fill:"#eda338",stackId:"stack",isAnimationActive:!0})];case vr.BOTH_TWO:return[n.a.createElement(za.a,{key:"11",dataKey:"all.twoBars.p1win",fill:"#4696f0",stackId:"stack",isAnimationActive:!0}),n.a.createElement(za.a,{key:"22",dataKey:"all.twoBars.p2win",fill:"#eda338",stackId:"stack",isAnimationActive:!0})];case vr.BOTH_FIVE:return[n.a.createElement(za.a,{key:"1",dataKey:"all.p1win",fill:"#4696f0",stackId:"stack",isAnimationActive:!0}),n.a.createElement(za.a,{key:"2",dataKey:"all.p2notPlayed",fill:"#899db3",stackId:"stack",isAnimationActive:!0}),n.a.createElement(za.a,{key:"3",dataKey:"all.notPlayed",fill:"#70707060",stackId:"stack",isAnimationActive:!0}),n.a.createElement(za.a,{key:"4",dataKey:"all.p1notPlayed",fill:"#bfa988",stackId:"stack",isAnimationActive:!0}),n.a.createElement(za.a,{key:"5",dataKey:"all.p2win",fill:"#eda338",stackId:"stack",isAnimationActive:!0})];default:return null}},Nr=void 0,Pr=mr("id"),kr=mr("compareToId"),Sr=Object(br.a)()((e,t,a)=>{if(!e||!t)return{};let r=e.ratingChanges[0].rating,n=t.ratingChanges[0].rating;const s=f.a.flow(f.a.sortBy("date"),f.a.map(e=>(e.rating&&(r=e.rating),e.rating2&&(n=e.rating2),{rating1:r,rating2:n,date:e.date})),f.a.sortedUniqBy("date"))([...e.ratingChanges,...t.ratingChanges.map(e=>({date:e.date,rating2:e.rating}))]);r=e.placesChanges[0].place,n=t.placesChanges[0].place;const c=f.a.flow(f.a.sortBy("date"),f.a.map(e=>(e.place&&(r=e.place),e.place2&&(n=e.place2),{place1:r,place2:n,date:e.date})))([...e.placesChanges,...t.placesChanges.map(e=>({date:e.date,place2:e.place}))]),l=f.a.fromPairs(Array.from({length:28}).map((e,t)=>[t+1,{}]));return f.a.keys(l).forEach(r=>{const n=f.a.flow(f.a.map("chart"),f.a.uniqBy("sharedChartId"))([...e.resultsByLevel[r],...t.resultsByLevel[r]]),s={x:r,all:{p1win:0,p1notPlayed:0,p2win:0,p2notPlayed:0,notPlayed:0,twoBars:{}},double:{p1win:0,p1notPlayed:0,p2win:0,p2notPlayed:0,notPlayed:0,twoBars:{}},single:{p1win:0,p1notPlayed:0,p2win:0,p2notPlayed:0,notPlayed:0,twoBars:{}}};n.forEach(a=>{const r=a.results.findIndex(t=>t.playerId===e.id),n=a.results.findIndex(e=>e.playerId===t.id),c=a.chartType.startsWith("D")?s.double:s.single;r<0&&n<0?console.log("wtf?"):r<0?(s.all.p1notPlayed++,c.p1notPlayed++):n<0?(s.all.p2notPlayed++,c.p2notPlayed++):r<n?(s.all.p1win++,c.p1win++):n<r&&(s.all.p2win++,c.p2win++)});const c=e=>{const t=e.p1win+e.p2win||1;e.twoBars.p1win=e.p1win/t,e.twoBars.p2win=e.p2win/t};c(s.all),c(s.single),c(s.double);const o=(e,t)=>{e.p1win=e.p1win/t,e.p1notPlayed=e.p1notPlayed/t,e.p2win=e.p2win/t,e.p2notPlayed=e.p2notPlayed/t,e.notPlayed=1-e.p1win-e.p1notPlayed-e.p2win-e.p2notPlayed};o(s.all,a.chartLevels[r]),o(s.double,a.doublesLevels[r]),o(s.single,a.singlesLevels[r]),l[r]=s}),{ratingChanges:s,placesChanges:c,perLevelComparison:f.a.values(l)}}),jr={fetchResults:wt,setProfilesFilter:rr,resetProfilesFilter:nr};class wr extends r.Component{constructor(...e){super(...e),this.state={isLevelGraphCombined:!0,compareBarsMode:vr.BOTH_TWO},this.onRefresh=()=>{!this.props.isLoading&&this.props.fetchResults()},this.onChangeDayRange=e=>{const t=this.props.filter;this.props.setProfilesFilter(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?yr(Object(a),!0).forEach((function(t){Object(i.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):yr(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},t,{dayRange:e}))},this.rhMargin={top:5,bottom:5,right:5,left:0},this.rhXDomain=["dataMin","dataMax"],this.rhYDomain=["dataMin - 100","dataMax + 100"],this.rhXTickFormatter=e=>he(e).toLocaleDateString(),this.rhTooltip=({active:e,payload:t,label:a})=>{const r=this.props,s=r.profile,c=r.profile2,l=s.name,o=c.name;return t&&t[0]?n.a.createElement("div",{className:"history-tooltip"},n.a.createElement("div",null,he(t[0].payload.date).toLocaleDateString()),t[1]&&n.a.createElement("div",{style:{fontWeight:"bold",color:t[1].color}},l,": ",Math.round(t[1].value)),t[0]&&n.a.createElement("div",{style:{fontWeight:"bold",color:t[0].color}},o,": ",Math.round(t[0].value))):null},this.circleShape=e=>n.a.createElement("circle",{key:e.key,cx:e.cx,cy:e.cy,r:4,fill:e.fill}),this.plcMargin={top:5,bottom:5,right:5,left:0},this.plcTooltip=({active:e,payload:t,label:a})=>{const r=this.props,s=r.profile,c=r.profile2,l=this.state.compareBarsMode,o=[vr.SINGLE_TWO,vr.DOUBLE_TWO,vr.BOTH_TWO].includes(l),i=s.name,m=c.name;if(!t||!t[0])return null;const d=(e,t)=>n.a.createElement("div",{key:e.name,style:{fontWeight:"bold",color:e.color}},t,": ",Math.round(100*f.a.get(e.dataKey,e.payload)),"%");return n.a.createElement("div",{className:"history-tooltip"},n.a.createElement("div",null,"Level: ",t[0].payload.x),d(t[0],"".concat(i," wins")),!o&&d(t[1],"".concat(m," has no score")),!o&&d(t[2],"Both have no score"),!o&&d(t[3],"".concat(i," has no score")),d(o?t[1]:t[4],"".concat(m," wins")))},this.plcXDomain=[0,1],this.plcXTicks=[0,.5,1],this.plcXFormatter=e=>"".concat(Math.round(100*e),"%")}renderRankingHistory(){const e=this.props.combinedData;return n.a.createElement(za.i,{minHeight:Nr,aspect:1.6},n.a.createElement(za.g,{data:e.ratingChanges,margin:this.rhMargin},n.a.createElement(za.c,{strokeDasharray:"3 3"}),n.a.createElement(za.m,{dataKey:"date",type:"number",domain:this.rhXDomain,tickFormatter:this.rhXTickFormatter}),n.a.createElement(za.n,{allowDecimals:!1,domain:this.rhYDomain,tickFormatter:Math.round,width:40}),n.a.createElement(za.h,{y:1e3,stroke:"white"}),n.a.createElement(za.l,{isAnimationActive:!1,content:this.rhTooltip}),n.a.createElement(za.f,{type:"monotone",isAnimationActive:!1,dataKey:"rating2",stroke:"#ffd388",strokeWidth:3,dot:!1}),n.a.createElement(za.f,{type:"monotone",isAnimationActive:!1,dataKey:"rating1",stroke:"#88d3ff",strokeWidth:3,dot:!1})))}renderAccuracyPoints(e=!1){const t=this.props,a=t.profile,r=t.profile2;return n.a.createElement(za.i,{minHeight:Nr,aspect:1.6},n.a.createElement(za.k,{margin:{top:5,bottom:5,right:5,left:0}},n.a.createElement(za.c,{strokeDasharray:"3 3"}),n.a.createElement(za.m,{dataKey:"[0]",type:"number",domain:[1,28],tickFormatter:e=>Math.round(e),ticks:[1,3,5,7,9,11,13,15,17,19,21,23,25,27]}),n.a.createElement(za.n,{dataKey:"[1]",type:"number",domain:[0,100],width:40,tickFormatter:e=>Math.round(e)+"%"}),n.a.createElement(za.j,{shape:this.circleShape,data:(e?r:a).accuracyPointsRaw,fill:e?"#ffd388":"#88d3ff"})))}renderPlaceHistory(){const e=this.props,t=e.combinedData,a=e.profile,r=e.profile2,s=a.name,c=r.name;return n.a.createElement(za.i,{minHeight:Nr,aspect:1.6},n.a.createElement(za.g,{data:t.placesChanges,margin:{top:5,bottom:5,right:5,left:0}},n.a.createElement(za.c,{strokeDasharray:"3 3"}),n.a.createElement(za.m,{dataKey:"date",type:"number",domain:["dataMin","dataMax"],tickFormatter:e=>he(e).toLocaleDateString()}),n.a.createElement(za.n,{allowDecimals:!1,domain:[1,e=>e<3?e+2:e+1],interval:0,reversed:!0,width:40}),n.a.createElement(za.l,{isAnimationActive:!1,content:({active:e,payload:t,label:a})=>t&&t[0]?n.a.createElement("div",{className:"history-tooltip"},n.a.createElement("div",null,he(t[0].payload.date).toLocaleDateString()),t[1]&&n.a.createElement("div",{style:{fontWeight:"bold",color:t[1].color}},s,": #",t[1].value),t[0]&&n.a.createElement("div",{style:{fontWeight:"bold",color:t[0].color}},c,": #",t[0].value)):null}),n.a.createElement(za.f,{isAnimationActive:!1,type:"stepAfter",dataKey:"place2",stroke:"#ffd388",strokeWidth:3,dot:!1}),n.a.createElement(za.f,{isAnimationActive:!1,type:"stepAfter",dataKey:"place1",stroke:"#88d3ff",strokeWidth:3,dot:!1})))}renderPerLevelComparison(){const e=this.props.combinedData,t=this.state.compareBarsMode;return n.a.createElement(za.i,{width:"100%",aspect:.7},n.a.createElement(za.b,{layout:"vertical",data:[...e.perLevelComparison],margin:this.plcMargin},n.a.createElement(za.l,{isAnimationActive:!1,content:this.plcTooltip}),n.a.createElement(za.n,{reversed:!0,dataKey:"x",type:"category",width:23}),n.a.createElement(za.m,{type:"number",domain:this.plcXDomain,ticks:this.plcXTicks,tickFormatter:this.plcXFormatter}),n.a.createElement(za.h,{x:.5,stroke:"#666"}),Or(t)))}renderProfile(){const e=this.props,t=e.profile,a=e.profile2,r=e.filter,s=e.otherPlayers,c=this.state.compareBarsMode;return n.a.createElement("div",{className:"profile"},n.a.createElement("div",{className:"profile-header"},n.a.createElement("div",{className:"profile-name text-with-header blue"},n.a.createElement("div",{className:"text-header"},"\u0438\u0433\u0440\u043e\u043a"),n.a.createElement("div",null,t.name)),n.a.createElement("div",{className:"text-with-header"},n.a.createElement("div",{className:"text-header"},"\u0440\u0430\u043d\u043a"),n.a.createElement("div",null,"#",t.rank)),n.a.createElement("div",{className:"text-with-header"},n.a.createElement("div",{className:"text-header"},"\u044d\u043b\u043e"),n.a.createElement("div",null,t.rating)),n.a.createElement("div",{className:"text-with-header"},n.a.createElement("div",{className:"text-header"},"\u043f\u043e\u0441\u043b\u0435\u0434\u043d\u044f\u044f \u0438\u0433\u0440\u0430"),n.a.createElement("div",null,t.lastResultDate?ue(t.lastResultDate):"\u043d\u0438\u043a\u043e\u0433\u0434\u0430")),n.a.createElement("div",{className:"_flex-fill"}),n.a.createElement("div",{className:"text-with-header -select"},n.a.createElement("div",{className:"text-header"},"\u0441\u0440\u0430\u0432\u043d\u0438\u0442\u044c \u0441"),n.a.createElement("div",null,n.a.createElement(be.a,{closeMenuOnSelect:!0,className:"select players",classNamePrefix:"select",placeholder:"\u0438\u0433\u0440\u043e\u043a\u0438...",options:s,onChange:e=>{this.props.history.push(E.profile.compare.getPath({id:t.id,compareToId:e.id}))}})))),n.a.createElement("div",{className:"profile-header right-align"},n.a.createElement("div",{className:"profile-name text-with-header orange"},n.a.createElement("div",{className:"text-header"},"\u0438\u0433\u0440\u043e\u043a"),n.a.createElement("div",null,a.name)),n.a.createElement("div",{className:"text-with-header"},n.a.createElement("div",{className:"text-header"},"\u0440\u0430\u043d\u043a"),n.a.createElement("div",null,"#",a.rank)),n.a.createElement("div",{className:"text-with-header"},n.a.createElement("div",{className:"text-header"},"\u044d\u043b\u043e"),n.a.createElement("div",null,a.rating)),n.a.createElement("div",{className:"text-with-header"},n.a.createElement("div",{className:"text-header"},"\u043f\u043e\u0441\u043b\u0435\u0434\u043d\u044f\u044f \u0438\u0433\u0440\u0430"),n.a.createElement("div",null,a.lastResultDate?ue(a.lastResultDate):"\u043d\u0438\u043a\u043e\u0433\u0434\u0430"))),n.a.createElement("div",{className:"profile-section-horizontal-container"},n.a.createElement("div",{className:"profile-section"},n.a.createElement("div",{className:"profile-section-content"},n.a.createElement("div",{className:"profile-section-2"},n.a.createElement("div",{className:"profile-sm-section-header flex"},n.a.createElement("span",null,"\u043f\u043e\u0431\u0435\u0434\u044b \u043f\u043e \u0443\u0440\u043e\u0432\u043d\u044f\u043c")),n.a.createElement("div",{className:"profile-sm-section-header flex"},(()=>{const e=[vr.SINGLE_TWO,vr.DOUBLE_TWO,vr.BOTH_TWO].includes(c);return n.a.createElement("div",{className:"toggle-holder"},n.a.createElement(we,{className:"combine-toggle",checked:!e,onChange:()=>this.setState(e=>({compareBarsMode:{[vr.SINGLE_TWO]:vr.SINGLE_FIVE,[vr.DOUBLE_TWO]:vr.DOUBLE_FIVE,[vr.BOTH_TWO]:vr.BOTH_FIVE,[vr.SINGLE_FIVE]:vr.SINGLE_TWO,[vr.DOUBLE_FIVE]:vr.DOUBLE_TWO,[vr.BOTH_FIVE]:vr.BOTH_TWO}[e.compareBarsMode]}))},"\u043f\u043e\u0434\u0440\u043e\u0431\u043d\u043e"),n.a.createElement("div",{className:"tabs-holder"},n.a.createElement(ke,{text:"\u0432\u0441\u0435",active:[vr.BOTH_TWO,vr.BOTH_FIVE].includes(c),onToggle:()=>{this.setState(t=>({compareBarsMode:e?vr.BOTH_TWO:vr.BOTH_FIVE}))}}),n.a.createElement(ke,{text:"\u0441\u0438\u043d\u0433\u043b\u044b",active:[vr.SINGLE_TWO,vr.SINGLE_FIVE].includes(c),onToggle:t=>{this.setState(t=>({compareBarsMode:e?vr.SINGLE_TWO:vr.SINGLE_FIVE}))}}),n.a.createElement(ke,{text:"\u0434\u0430\u0431\u043b\u044b",active:[vr.DOUBLE_TWO,vr.DOUBLE_FIVE].includes(c),onToggle:t=>{this.setState(t=>({compareBarsMode:e?vr.DOUBLE_TWO:vr.DOUBLE_FIVE}))}})))})()),n.a.createElement("div",{className:"chart-container"},this.renderPerLevelComparison())))),n.a.createElement("div",{className:"profile-section"},n.a.createElement("div",{className:"profile-section-content"},n.a.createElement("div",{className:"profile-section-2"},n.a.createElement("div",{className:"profile-sm-section-header"},n.a.createElement("span",null,"\u044d\u043b\u043e")),n.a.createElement("div",{className:"chart-container"},this.renderRankingHistory())),n.a.createElement("div",{className:"profile-section-2"},n.a.createElement("div",{className:"profile-sm-section-header"},n.a.createElement("span",null,"\u043c\u0435\u0441\u0442\u043e \u0432 \u0442\u043e\u043f\u0435")),n.a.createElement("div",{className:"chart-container"},this.renderPlaceHistory()))),(()=>{const e=r.dayRange||t.filterRange,a=ie()(1e3*e[0]*60*60*24).format("L"),s=ie()(1e3*e[1]*60*60*24).format("L"),c=Math.max(e[0]-1,t.minMaxRange[0]),l=Math.min(e[0]+1,e[1]),o=Math.max(e[1]-1,e[0]),i=Math.min(e[1]+1,t.minMaxRange[1]);return n.a.createElement("div",{className:"range-container"},n.a.createElement(He,{range:e,min:t.minMaxRange[0],max:t.minMaxRange[1],onChange:this.onChangeDayRange}),n.a.createElement("div",{className:"range-controls _flex-row"},n.a.createElement("button",{className:"btn btn-sm btn-dark",onClick:()=>this.onChangeDayRange([c,e[1]])},n.a.createElement(k.e,null)),n.a.createElement("span",{className:"date-text"},a),n.a.createElement("button",{className:"btn btn-sm btn-dark",onClick:()=>this.onChangeDayRange([l,e[1]])},n.a.createElement(k.f,null)),n.a.createElement("div",{className:"_flex-fill"}),n.a.createElement("button",{className:"btn btn-sm btn-dark",onClick:()=>this.onChangeDayRange([e[0],o])},n.a.createElement(k.e,null)),n.a.createElement("span",{className:"date-text"},s),n.a.createElement("button",{className:"btn btn-sm btn-dark",onClick:()=>this.onChangeDayRange([e[0],i])},n.a.createElement(k.f,null))))})())),n.a.createElement("div",{className:"profile-section-horizontal-container"},n.a.createElement("div",{className:"profile-section"},n.a.createElement("div",{className:"profile-section-content"},n.a.createElement("div",{className:"profile-section-2"},n.a.createElement("div",{className:"profile-sm-section-header"},n.a.createElement("span",null,"\u0442\u043e\u0447\u043d\u043e\u0441\u0442\u044c \u043f\u043e \u0443\u0440\u043e\u0432\u043d\u044f\u043c")),n.a.createElement("div",{className:"chart-container"},this.renderAccuracyPoints())))),n.a.createElement("div",{className:"profile-section"},n.a.createElement("div",{className:"profile-section-content"},n.a.createElement("div",{className:"profile-section-2"},n.a.createElement("div",{className:"profile-sm-section-header"},n.a.createElement("span",null,"\u0442\u043e\u0447\u043d\u043e\u0441\u0442\u044c \u043f\u043e \u0443\u0440\u043e\u0432\u043d\u044f\u043c")),n.a.createElement("div",{className:"chart-container"},this.renderAccuracyPoints(!0)))))))}render(){const e=this.props,t=e.isLoading,a=e.profile,r=e.error;return lt&&console.log("profile:",a),n.a.createElement("div",{className:"profile-compare-page"},n.a.createElement("div",{className:"content"},r&&r.message,n.a.createElement("div",{className:"top-controls"},n.a.createElement("div",{className:"_flex-fill"}),n.a.createElement("button",{disabled:t,className:"btn btn-sm btn-dark btn-icon",onClick:this.onRefresh},n.a.createElement(k.s,null)," \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c")),t&&n.a.createElement(w,null),!t&&f.a.isEmpty(a)&&n.a.createElement("div",{className:"profile"},"Profile not found"),!t&&!f.a.isEmpty(a)&&this.renderProfile()))}}wr.defaultProps={profile:{},profile2:{},combinedData:{}};var xr=Object(o.b)((e,t)=>{const a=Pr(e,t),r=kr(e,t);return{profile:a,profile2:r,otherPlayers:hr(e,t),combinedData:Sr(a,r,e.tracklist.data),tracklist:e.tracklist.data,filter:e.profiles.filter,error:e.results.error||e.tracklist.error,isLoading:e.results.isLoading||e.results.isLoadingRanking||e.tracklist.isLoading}},jr)(Object(m.g)(wr));a(429);function Dr(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Rr(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Dr(Object(a),!0).forEach((function(t){Object(i.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Dr(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const Cr="USER/LOADING",Lr="USER/SUCCESS",_r="USER/ERROR",Ir={isLoading:!1,data:null};const Ar=()=>async e=>{e({type:Cr});try{const t=await e(I({url:"".concat(F,"/profile")}));return e({type:Lr,data:t}),t}catch(t){return e({type:_r,error:t}),null}};function Tr(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Mr(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Tr(Object(a),!0).forEach((function(t){Object(i.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Tr(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const Fr="LOGIN/LOADING",Br="LOGIN/SUCCESS",Hr="LOGIN/ERROR",Kr={isLoading:!1,data:null,error:null};const Wr=e=>async t=>{t({type:Fr});try{const a=await t(A({url:"".concat(F,"/login/google"),body:{token:e.tokenId}}));return D.a.set("session",a.session,{expires:30}),t({type:Br,data:a}),t(Ar()),a}catch(a){return t({type:Hr,error:a}),null}},Ur={login:Wr,logout:()=>async e=>{e({type:Fr}),e(C());try{const t=await e(A({url:"".concat(F,"/logout")}));return e({type:Br,data:t}),t}catch(t){return e({type:Hr,error:t}),null}}};var Gr=Object(o.b)(e=>({isLoadingLogin:e.login.isLoading,isLoadingUser:e.user.isLoading,user:e.user.data}),Ur)((function({isLoadingLogin:e,isLoadingUser:t,user:a,login:r,logout:s}){return n.a.createElement("header",{className:"top-bar"},n.a.createElement("nav",null,n.a.createElement("ul",null,n.a.createElement("li",null,n.a.createElement(l.c,{exact:!0,to:E.leaderboard.path},"leaderboards")),n.a.createElement("li",null,n.a.createElement(l.c,{exact:!0,to:E.ranking.path},"ranking")),n.a.createElement("li",null,n.a.createElement(l.c,{exact:!0,to:E.songs.path},"songs")))),n.a.createElement("div",{className:"_flex-fill"}),n.a.createElement("div",{className:"login-container"},n.a.createElement(l.c,{className:"player-info",exact:!0,to:E.profile.getPath({id:f.a.get("player.id",a)})},f.a.getOr("","player.nickname",a)),n.a.createElement("button",{className:"btn btn-dark btn-icon btn-sm",onClick:s,disabled:e||t},n.a.createElement("span",null," logout"))))})),qr=a(198),Vr=a(199),zr=a.n(Vr);a(439);const Yr={login:Wr};var Xr=Object(o.b)(e=>({isLoading:e.login.isLoading,error:e.login.error}),Yr)((function({isLoading:e,error:t,login:a}){const s=Object(r.useState)(!1),c=Object(P.a)(s,2),l=c[0],o=c[1],i=e=>{e.error?console.log("Google login response error:",e):a(e)};return n.a.createElement("div",{className:"login-screen"},n.a.createElement("div",{className:"site-name"},"pumpking"),n.a.createElement("div",{className:"login-button"},n.a.createElement(qr.GoogleLogin,{clientId:"197132042723-cmibep21qf6dald9l2l01rif7l5dtd4s.apps.googleusercontent.com",buttonText:"Login",onSuccess:i,onFailure:i,cookiePolicy:"single_host_origin",render:({onClick:t,disabled:a})=>n.a.createElement("button",{className:"btn btn-dark btn-icon btn-sm",onClick:t,disabled:a||e},n.a.createElement(k.l,null),n.a.createElement("span",null," login"))})),t&&n.a.createElement("div",{className:"error"},t.message),n.a.createElement("div",{className:"footer"},"By logging in, you agree to our"," ",l?n.a.createElement(zr.a,{text:"\ud83e\udd21",className:"clown"}):n.a.createElement("span",{onClick:()=>o(!0),className:"link-style"},"Privacy Policy")))})),Jr=a(121),Qr=a.n(Jr);a(442),a(443);const Zr={ACHIEVEMENT:"ACHIEVEMENT",RANK_UP:"RANK_UP"};function $r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function en(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?$r(Object(a),!0).forEach((function(t){Object(i.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):$r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const tn="POPUPS/ADD",an="POPUPS/REMOVE",rn="popup",nn={popups:[]};var sn=({playerName:e,achievementName:t,progress:a})=>{const s=Object(r.useState)(a[0]),c=Object(P.a)(s,2),l=c[0],o=c[1];return Object(r.useEffect)(()=>{o(a[1])},[]),n.a.createElement("div",{className:"achievement-popup popup"},n.a.createElement("div",{className:"player"},n.a.createElement(Xe.a,null),n.a.createElement("span",null,e),n.a.createElement(Xe.a,null)),n.a.createElement("div",{className:"ach-holder"},((e,t)=>{const a=Je[e].icon;return n.a.createElement("div",{className:"ach-block"},a&&n.a.createElement("div",{className:"ach-icon"},n.a.createElement(a,null)),n.a.createElement("div",{className:"ach-name"},e),n.a.createElement("div",{className:j()("progress-background",{complete:100===t,zero:0===t}),style:{height:"".concat(Math.round(t),"%")}}))})(t,l)),n.a.createElement("div",{className:"description"},Je[t].description))};var cn=({playerName:e,place:[t,a],list:[s,c]})=>{const l=Object(r.useState)(t),o=Object(P.a)(l,2),i=o[0],m=o[1],d=Object(r.useState)(s),p=Object(P.a)(d,2),u=p[0],h=p[1];Object(r.useEffect)(()=>{h(c),m(a)},[]);const g=Math.min(0,Math.max(-60*(f.a.size(u)-7),-60*(i-4)));return n.a.createElement("div",{className:"rank-up-popup popup"},n.a.createElement("div",{className:"player"},n.a.createElement(Xe.a,null),n.a.createElement("span",null,e),n.a.createElement(Xe.a,null)),n.a.createElement("div",{className:"ranking-holder"},n.a.createElement("div",{className:"moving-list",style:{top:g}},n.a.createElement(Zt.a,{duration:4500,delay:2e3,maintainContainerHeight:!0},u.map((e,t)=>n.a.createElement("div",{key:e.id,className:j()("player-block",{current:t===i-1})},((e,t)=>n.a.createElement("div",{className:"closest-player ".concat(t?"current-player":"")},n.a.createElement("div",{className:"place"},"#",e.place),n.a.createElement("div",{className:"name"},e.name),n.a.createElement("div",{className:"elo"},e.rating)))(e,t===i-1)))))))};const ln={[Zr.ACHIEVEMENT]:sn,[Zr.RANK_UP]:cn},on={overlay:{backgroundColor:"rgba(0, 0, 0, 0.1)"},content:{top:null,bottom:null,left:null,right:null,position:null,borderRadius:null,padding:null,background:null,display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",transition:"2.5s opacity ease",opacity:1}},mn={removePopup:({id:e})=>({type:an,id:e})};var dn=Object(o.b)(e=>({popups:e.popups.popups}),mn)(({popups:e,removePopup:t})=>{const a=Object(r.useState)(null),s=Object(P.a)(a,2),c=s[0],l=s[1],o=Object(r.useRef)(null);Object(r.useEffect)(()=>{if(e.length>0){const a=e[0];l(a),a.persistent||setTimeout(()=>{a&&a.fadeOut?(o.current.style.opacity=0,setTimeout(()=>{l(null),t(a)},2500)):(l(null),t(a))},a.timeout||6e3)}else l(null)},[e,t]);const i=Object(r.useCallback)(()=>{c&&c.fadeIn&&(o.current.style.opacity=1)},[c]);let m=on,d=null;if(c){const e=ln[c.type];d=e?n.a.createElement(e,c.parameters):n.a.createElement("div",null,JSON.stringify(c)),c.fadeIn&&(m=f.a.set("content.opacity",0,on))}return n.a.createElement("div",{className:"popups-holder"},n.a.createElement(h.a,{isOpen:!!c,contentRef:e=>o.current=e,onAfterOpen:i,style:m},d))});function pn(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function un(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?pn(Object(a),!0).forEach((function(t){Object(i.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):pn(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const hn="TOP_PER_SONG/LOADING",gn="TOP_PER_SONG/SUCCESS",fn="TOP_PER_SONG/ERROR",En={isLoading:!1,data:null,error:null,fetchingParams:null};const bn=({player:e,profile:t,label:a,trackedData:s,isLeft:c=!1,preferences:l,topPlayersList:o,addPopup:i})=>{const m=f.a.getOr({},"playersHiddenStatus",l),d=(e,t)=>{if(!t||t===e)return null;const a=e-t;return n.a.createElement("span",{className:"change ".concat(a>=0?"pos":"neg")},a<0?a.toFixed(1):"+".concat(a.toFixed(1)))},p=o.filter(e=>!m[e.id]),u=f.a.findIndex({id:t.id},p),h=u<0?[]:p.slice(Math.max(0,u-2),Math.min(u+3,p.length));(({data:e,resetData:t,onChange:a=f.a.noop,isDataValid:n=f.a.identity,isDebugOn:s=!1})=>{const c=Object(r.useState)(e),l=Object(P.a)(c,2),o=l[0],i=l[1],m=Object(r.useState)(e),d=Object(P.a)(m,2),p=d[0],u=d[1],h=Object(r.useRef)(t);Object(r.useEffect)(()=>{h.current!==t?(h.current=t,i(e),u(e)):n(e)&&!f.a.isEqual(e,p)&&(i(p),u(e),a(p,e))},[e,a,p,o,t,n]);const g=Object(r.useCallback)(()=>{i(e),u(e)},[e]);Object(r.useMemo)(()=>[p,o,g],[p,o,g])})({data:o,resetData:t.name,isDataValid:Object(r.useCallback)(f.a.get("[0].rating"),[]),onChange:Object(r.useCallback)((e,a)=>{const r=f.a.get("place",f.a.find({id:t.id},e)),n=f.a.get("place",f.a.find({id:t.id},a));r&&n&&r>n&&i({type:Zr.RANK_UP,fadeIn:!0,fadeOut:!0,timeout:7500,parameters:{playerName:t.name,place:[r,n],list:[e,a]}})},[i,t.id,t.name])});const g=a?a.match(/(\D+)|(\d+)/g):[],E=Object(P.a)(g,2),b=E[0],y=E[1];return n.a.createElement("div",{className:"player-container ".concat(c?"left":"right")},e&&n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"name-with-label"},n.a.createElement("div",{className:"name"},t.name||e),n.a.createElement("div",{className:"chart-label"},n.a.createElement(ha,{type:b,level:y}))),t.exp&&t.expRank&&n.a.createElement("div",{className:"exp exp-rank"},Ye(t.expRank),(()=>{if(!t.expRank||!t.exp)return null;let e=t.expRankNext?(t.exp-t.expRank.threshold)/(t.expRankNext.threshold-t.expRank.threshold):1;const a=1-e;let r=0;return s.exp[1]&&(r=1-a-(e=t.expRankNext?(s.exp[1]-t.expRank.threshold)/(t.expRankNext.threshold-t.expRank.threshold):1)),n.a.createElement("div",{className:"exp-line"},n.a.createElement("div",{className:"taken",style:{width:Math.floor(100*e)+"%"}}),n.a.createElement("div",{className:"diff",style:{width:Math.ceil(100*r)+"%"}}),n.a.createElement("div",{className:"rest",style:{width:Math.ceil(100*a)+"%"}}))})()),s.exp[0]&&n.a.createElement("div",{className:"exp-text"},n.a.createElement("span",{className:"_grey-text"},"exp:"),n.a.createElement("span",null,Math.round(s.exp[0])),d(s.exp[0],s.exp[1])),s.elo[0]&&n.a.createElement("div",{className:"rating"},n.a.createElement("span",{className:"_grey-text"},"elo:"),n.a.createElement("span",null,Math.round(s.elo[0])),d(s.elo[0],s.elo[1])),s.pp[0]&&n.a.createElement("div",{className:"rating"},n.a.createElement("span",{className:"_grey-text"},"pp:"),n.a.createElement("span",null,Math.round(s.pp[0])),d(s.pp[0],s.pp[1])),n.a.createElement("div",{className:"closest-players"},f.a.map(e=>n.a.createElement("div",{className:"closest-player ".concat(t.id===e.id?"current-player":"")},n.a.createElement("div",{className:"place"},"#",e.place),n.a.createElement("div",{className:"name"},e.name),n.a.createElement("div",{className:"elo"},e.rating)),h))))};function yn(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function vn(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?yn(Object(a),!0).forEach((function(t){Object(i.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):yn(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const On=310,Nn=Object(ya.a)(e=>e.results.profiles,f.a.flow(f.a.values,f.a.orderBy("ratingRaw","desc"),e=>e.map((e,t)=>vn({place:t+1},f.a.pick(["id","name","rating"],e))))),Pn={fetchTopPerSong:(e,t,a)=>{const r=Ge.a.stringify({song_name:e,charts:f.a.compact(f.a.uniq([t,a])).join(",")});return async e=>{e({type:hn,fetchingParams:r});try{const t=await e(I({url:"".concat(F,"/topPerSong?").concat(r)})),a=f.a.flow(ia,f.a.get("results"))(t);return e({type:gn,data:a,fetchingParams:r}),a}catch(t){return e({type:fn,error:t,fetchingParams:r}),null}}},appendNewResults:e=>async(t,a)=>{const r=a().results,n=r.originalData,s=r.sharedCharts;if(!e)return t(wt());t({type:mt});try{const a=await t(I({url:"".concat(F,"/").concat(bt,"?").concat(Ge.a.stringify({start_date:e}))}));if(a.error)throw new Error(a.error);const r=f.a.filter(e=>{const t=s[e.shared_chart];if(!t)return!0;const a=f.a.find(t=>t.id===e.id||t.playerId===e.player&&t.isRank===!!e.rank_mode,t.results);return a?!(a.id===e.id||a.score>=e.score):!(1===e.player&&t.results[0].score>e.score)},a.results);if(console.log("Received results:",a,"; Will append:",r),f.a.isEmpty(r))t({type:dt});else{const e={players:a.players,results:[...n.results,...r],shared_charts:it({},n.shared_charts,{},a.shared_charts)};t(xt(e))}}catch(c){console.log(c),t({type:ut,error:c})}},addPopup:({type:e,parameters:t,fadeIn:a,fadeOut:r,timeout:n,persistent:s})=>({type:tn,popupType:e,parameters:t,fadeIn:a,fadeOut:r,timeout:n,persistent:s}),fetchUserPreferences:e=>async t=>{return await t(I({url:"".concat(F,"/player/").concat(e,"/preferences")}))}};var kn=Object(o.b)(e=>({isLoading:e.topPerSong.isLoading,songTopData:e.topPerSong.data,error:e.topPerSong.error,profiles:e.results.profiles,topPlayersList:Nn(e),sharedCharts:e.results.sharedCharts}),Pn)((function({isLoading:e,fetchTopPerSong:t,fetchUserPreferences:a,appendNewResults:s,songTopData:c,error:l,profiles:o,topPlayersList:i,sharedCharts:m={},addPopup:d}){const p=Object(r.useState)(""),u=Object(P.a)(p,2),h=u[0],g=u[1],E=Object(r.useState)(""),b=Object(P.a)(E,2),y=b[0],v=b[1],O=Object(r.useState)(!1),N=Object(P.a)(O,2),k=N[0],S=N[1],j=Object(r.useState)(null),x=Object(P.a)(j,2),D=x[0],R=x[1],C=Object(r.useState)(null),L=Object(P.a)(C,2),_=L[0],I=L[1],A=Object(r.useState)(null),T=Object(P.a)(A,2),M=T[0],F=T[1],H=Object(r.useState)(null),K=Object(P.a)(H,2),W=K[0],U=K[1],G=Object(r.useState)(null),q=Object(P.a)(G,2),V=q[0],z=q[1],Y=Object(r.useState)(""),X=Object(P.a)(Y,2),J=X[0],Q=X[1],Z=Object(r.useState)(null),$=Object(P.a)(Z,2),ee=$[0],te=$[1],ae=Object(r.useState)(null),re=Object(P.a)(ae,2),ne=re[0],se=re[1],ce=Object(r.useRef)(null),le=Object(r.useRef)(null),oe=Object(r.useRef)(null),ie=Object(r.useRef)(null),me=Object(r.useRef)(null),de=Object(r.useMemo)(()=>!W||f.a.isEmpty(o)?{}:f.a.minBy(e=>Qr.a.get(e.nameArcade,W),f.a.values(o))||{},[W,o]),pe=Object(r.useMemo)(()=>!V||f.a.isEmpty(o)?{}:f.a.minBy(e=>Qr.a.get(e.nameArcade,V),f.a.values(o))||{},[V,o]),ue=e=>(t,a)=>{f.a.keys(t).forEach(r=>{t[r].progress!==a[r].progress&&d({type:Zr.ACHIEVEMENT,fadeIn:!0,fadeOut:!0,parameters:{playerName:e,achievementName:r,progress:[t[r].progress,a[r].progress]}})})},he={pp:ma(f.a.get("pp.pp",de),de.name),elo:ma(de.ratingRaw,de.name),exp:ma(de.exp,de.name),expRank:ma(de.expRank,de.name),achievements:ma(de.achievements,de.name,ue(de.name))},ge=da(he),fe={pp:ma(f.a.get("pp.pp",pe),pe.name),elo:ma(pe.ratingRaw,pe.name),exp:ma(pe.exp,pe.name),expRank:ma(pe.expRank,pe.name),achievements:ma(pe.achievements,pe.name,ue(pe.name))},Ee=da(fe);Object(r.useEffect)(()=>{de.id&&a(de.id).then(e=>{te(e.preferences)})},[de.id,a]),Object(r.useEffect)(()=>{pe.id&&a(pe.id).then(e=>{se(e.preferences)})},[pe.id,a]);const be=Object(r.useCallback)(()=>{R(!0),me.current&&clearTimeout(me.current),me.current=setTimeout(()=>{R(!1),U(null),z(null),I(null),F(null),Q(""),te(null),se(null)},1e3*On)},[]);Object(r.useEffect)(()=>{ie.current=new WebSocket(B),ie.current.onerror=()=>{g("Cannot connect to websocket server, please reload the page")},ie.current.onopen=e=>{S(!0)}},[]),Object(r.useEffect)(()=>{ie.current.onmessage=e=>{be();try{const a=e&&e.data&&JSON.parse(e.data);if(console.log(a),"result_screen"===a.type){console.log("Resetting tracking because received result screen"),ge(),Ee();const e=a.data.track_name,r=f.a.get("left.chart_label",a.data),n=f.a.get("right.chart_label",a.data),c=f.a.get("left.result.player_name",a.data),l=f.a.get("right.result.player_name",a.data);U(c),z(l),I(r),F(n),Q(e),s(a.data.gained),t(e,r,n)}else if("chart_selected"===a.type&&(v(a.data.error||""),(a.data.leftPlayer||a.data.rightPlayer)&&(U(a.data.leftPlayer),z(a.data.rightPlayer)),(a.data.leftLabel||a.data.rightLabel)&&(I(a.data.leftLabel),F(a.data.rightLabel),a.data.text))){const e=a.data.text;Q(e),console.log("song name",e,J),J!==e&&t(e,a.data.leftLabel,a.data.rightLabel)}}catch(a){console.log("on message error",a),g("Error: ".concat(a.message))}}},[J,t,be,s,ge,Ee]),Object(r.useEffect)(()=>{if(ce.current&&le.current)if(oe.current){const e=le.current,t=oe.current,a={w:ce.current.clientWidth,h:ce.current.clientHeight},r=a.w/(e.offsetWidth+t.offsetWidth),n=a.h/Math.max(e.offsetHeight,t.offsetHeight),s=a.w/Math.max(e.offsetWidth,t.offsetWidth),c=a.h/(e.offsetHeight+t.offsetHeight);Math.min(r,n)>Math.min(s,c)?(ce.current.style.flexDirection="row",ce.current.style.alignItems="center",ce.current.style.transform="scale(".concat(r>n?.98*n:.98*r,")")):(ce.current.style.flexDirection="column",ce.current.style.alignItems="center",ce.current.style.transform="scale(".concat(s>c?.98*c:.98*s,")"))}else{const e=le.current,t={w:ce.current.clientWidth,h:ce.current.clientHeight},a=t.w/e.offsetWidth,r=t.h/e.offsetHeight;ce.current.style.transform="scale(".concat(a<r?.98*a:.98*r,")")}});const ye=f.a.find({chartLabel:_},c),ve=f.a.find({chartLabel:M},c),Oe=f.a.uniq(f.a.compact([ye,ve]));return n.a.createElement("div",{className:"tracker-container"},n.a.createElement(dn,null),n.a.createElement("div",{className:"sidebar"},n.a.createElement(bn,{player:W,profile:de,label:_,trackedData:he,preferences:ee,topPlayersList:i,isLeft:!0,addPopup:d}),n.a.createElement(bn,{player:V,profile:pe,label:M,trackedData:fe,preferences:ne,topPlayersList:i,addPopup:d})),n.a.createElement("div",{className:"results",ref:ce},(l||h)&&n.a.createElement("div",{className:"error"},h,n.a.createElement("br",null),l&&l.message),k&&!W&&!V&&!y&&!e&&f.a.isEmpty(Oe)&&(null===D?n.a.createElement("div",{className:"msg"},"Waiting for recognizer..."):D?n.a.createElement("div",{className:"msg"},"Waiting for chart select..."):n.a.createElement("div",{className:"offline msg"},"Recognizer is offline")),k&&(_||M)&&!y&&!e&&f.a.isEmpty(Oe)&&"No results for this chart",e&&n.a.createElement(w,null),!e&&Oe.map((e,t)=>{const a=f.a.omitBy(e=>!e,f.a.getOr({},"playersHiddenStatus",ee)),r=f.a.omitBy(e=>!e,f.a.getOr({},"playersHiddenStatus",ne)),s=Object.keys(a).reduce((e,t)=>vn({},e,{[t]:a[t]&&r[t]}),{});return n.a.createElement(ba,{ref:0===t?le:oe,playersHiddenStatus:s,key:e.sharedChartId,chart:e,leftProfile:de,rightProfile:pe,isSocketView:!0})})))}));function Sn(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function jn(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Sn(Object(a),!0).forEach((function(t){Object(i.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Sn(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const wn="TRACKLIST/LOADING",xn="TRACKLIST/SUCCESS",Dn="TRACKLIST/ERROR",Rn={isLoading:!1,data:[]};function Cn(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Ln(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Cn(Object(a),!0).forEach((function(t){Object(i.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Cn(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}h.a.setAppElement("#root");const _n={setFilter:Dt,fetchResults:wt,fetchTracklist:()=>async e=>{e({type:wn});try{const t=await e(I({url:"".concat(F,"/tracklist/stats/XX")}));return e({type:xn,data:t}),t}catch(t){return e({type:Dn,error:t}),null}},fetchUser:Ar,fetchPreferences:()=>async e=>{e({type:Ma});try{const t=await e(I({url:"".concat(F,"/profile/preferences")}));return e({type:Fa,data:t.preferences}),t}catch(t){return e({type:Ba,error:t}),null}}};var In=Object(o.b)(e=>({userData:e.user.data,isLoading:e.user.isLoading}),_n)((function({fetchUser:e,fetchTracklist:t,fetchResults:a,fetchPreferences:s,setFilter:c,userData:l,isLoading:o}){return Object(r.useEffect)(()=>{Object({NODE_ENV:"production",PUBLIC_URL:"."}).REACT_APP_SOCKET||(e(),p.a.getItem("filter").then(e=>{e&&c(Ln({},f.a.omit("song",e),{chartRange:e.chartRange&&Ln({},e.chartRange,{range:f.a.every(e=>e>=v[0]&&e<=v[1],e.chartRange.range)?e.chartRange.range:v})}))}).catch(e=>console.error("Cannot get filter from local storage",e)))},[e,t,a,c]),Object(r.useEffect)(()=>{!Object({NODE_ENV:"production",PUBLIC_URL:"."}).REACT_APP_SOCKET&&l&&l.player&&Promise.all([t(),s()]).then(()=>{a()})},[l,s,a,t]),Object(r.useEffect)(()=>{Object({NODE_ENV:"production",PUBLIC_URL:"."}).REACT_APP_SOCKET&&t().then(()=>{a()})},[a,t]),o?n.a.createElement("div",{className:"container"},n.a.createElement(w,null)):Object({NODE_ENV:"production",PUBLIC_URL:"."}).REACT_APP_SOCKET?n.a.createElement(kn,null):l&&l.player?n.a.createElement("div",{className:"container"},n.a.createElement(Gr,null),n.a.createElement(m.b,{exact:!0,path:"/",render:()=>n.a.createElement(m.a,{to:E.leaderboard.path})}),n.a.createElement(m.b,{exact:!0,path:E.leaderboard.path,component:Ca}),n.a.createElement(m.b,{exact:!0,path:E.leaderboard.sharedChart.path,component:Ca}),n.a.createElement(m.b,{path:E.ranking.path,component:Va}),n.a.createElement(m.b,{path:E.profile.path},n.a.createElement(m.d,null,n.a.createElement(m.b,{path:E.profile.path,exact:!0,component:Er}),n.a.createElement(m.b,{path:E.profile.compare.path,exact:!0,component:xr}))),n.a.createElement(m.b,{path:E.songs.path,component:Ee})):n.a.createElement(Xr,null)})),An=a(42),Tn=a(122),Mn=Object(An.c)({mostPlayed:function(e=q,t){switch(t.type){case W:return K({},e,{isLoading:!0});case G:return K({},e,{isLoading:!1,error:t.error});case U:return K({},e,{isLoading:!1,data:t.data});default:return e}},mostPlayedMonth:function(e=Q,t){switch(t.type){case Y:return z({},e,{isLoading:!0});case J:return z({},e,{isLoading:!1,error:t.error});case X:return z({},e,{isLoading:!1,data:t.data});default:return e}},leastPlayed:function(e=re,t){switch(t.type){case ee:return $({},e,{isLoading:!0});case ae:return $({},e,{isLoading:!1,error:t.error});case te:return $({},e,{isLoading:!1,data:t.data});default:return e}}});const Fn=Object(An.c)({topPerSong:function(e=En,t){switch(t.type){case hn:return un({},e,{isLoading:!0,fetchingParams:t.fetchingParams,data:null,error:null});case fn:return t.fetchingParams===e.fetchingParams?un({},e,{isLoading:!1,error:t.error,data:null,fetchingParams:null}):e;case gn:return t.fetchingParams===e.fetchingParams?un({},e,{isLoading:!1,data:t.data,fetchingParams:null}):e;default:return e}},login:function(e=Kr,t){switch(t.type){case Fr:return Mr({},e,{isLoading:!0,data:null,error:null});case Hr:return Mr({},e,{isLoading:!1,error:t.error,data:null});case Br:return Mr({},e,{isLoading:!1,data:t.data});default:return e}},popups:function(e=nn,t){switch(t.type){case tn:const a=f.a.uniqueId(rn);return en({},e,{popups:[...e.popups,en({id:a,type:t.popupType},f.a.pick(["parameters","fadeIn","fadeOut","timeout","persistent"],t))]});case an:return en({},e,{popups:f.a.remove({id:t.id},e.popups)});default:return e}},preferences:function(e=Wa,t){switch(t.type){case Ma:return Ta({},e,{isLoading:!0,error:null});case Ba:return Ta({},e,{isLoading:!1,error:t.error,data:Ka});case Fa:return Ta({},e,{isLoading:!1,data:f.a.merge(Ka,t.data)});case Ha:return{data:t.data};default:return e}},presets:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Bt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Tt:var a=f.a.find({name:f.a.get("name",e.currentPreset)},t.presets);return It({},e,{currentPreset:Ht(a)||null,presets:f.a.map(Ht,t.presets)});case At:return It({},e,{currentPreset:Ht(t.currentPreset)});case Mt:return It({},e,{isLoading:!0});case Ft:return It({},e,{isLoading:!1});default:return e}},profiles:function(e=ar,t){switch(t.type){case $a:return Za({},e,{filter:t.filter});case er:return Za({},e,{filter:tr});default:return e}},results:function(e=vt,t){switch(t.type){case mt:return it({},e,{isLoading:!0});case dt:return it({},e,{isLoading:!1});case ut:return it({},e,{isLoading:!1,error:t.error,data:vt.data,players:vt.players,profiles:vt.profiles,results:vt.results,sharedCharts:vt.sharedCharts,scoreInfo:{}});case pt:return it({},e,{isLoading:!1,isLoadingRanking:!0,data:t.data,players:t.players,profiles:t.profiles,results:t.results,sharedCharts:t.sharedCharts,originalData:t.originalData,scoreInfo:{}});case Et:return it({},e,{isLoadingRanking:!1,profiles:t.profiles,resultInfo:t.resultInfo,sharedCharts:t.sharedCharts,data:f.a.values(t.sharedCharts)});case ht:return it({},e,{filter:t.filter});case gt:return it({},e,{filter:yt});case ft:const a=!f.a.isEmpty(t.listPrev);return it({},e,{profiles:f.a.mapValues(e=>{const r=it({},e,{prevRating:f.a.get(e.id,t.rankingsPointsMap)});return a?f.a.includes(r.id,t.listPrev)?f.a.includes(r.id,t.listNow)?it({},r,{change:f.a.indexOf(r.id,t.listPrev)-f.a.indexOf(r.id,t.listNow)}):it({},r,{change:"?"}):it({},r,{change:"NEW"}):r},e.profiles)});default:return e}},trackStats:Mn,tracklist:function(e=Rn,t){switch(t.type){case wn:return jn({},e,{isLoading:!0});case Dn:return jn({},e,{isLoading:!1,error:t.error});case xn:return jn({},e,{isLoading:!1,data:t.data});default:return e}},user:function(e=Ir,t){switch(t.type){case Cr:return Rr({},e,{isLoading:!0,data:null});case _r:return Rr({},e,{isLoading:!1,error:t.error,data:null});case Lr:return Rr({},e,{isLoading:!1,data:t.data});case R:return Ir;default:return e}}}),Bn=Object(An.e)(Fn,(window.__REDUX_DEVTOOLS_EXTENSION__,Object(An.a)(Tn.a)));c.a.render(n.a.createElement(o.a,{store:Bn},n.a.createElement(l.a,null,n.a.createElement(In,null))),document.getElementById("root"))}},[[226,1,2]]]);
//# sourceMappingURL=main.28aa6c85.chunk.js.map